hello hello everyone my name is georges i work with paradigm um and i'm here to talk with phil diane who will enter himself really shortly about mind net acceptable value a topic which i believe we will hear more and more about in ethereum so phil would you want to introduce yourself and we can get into it yeah i'm phil i'm a phd student at cornell university i work on smart contract security and distributed system security in general particularly i'm interested in systems currently that have sort of economic forms of security as well as traditional sort of computational based notions of security or even that blend the two and uh part of this interest has been in the past in ethereum and indexes on ethereum and many many other projects on ethereum that i've you know studied or helped with in various capacities and uh i guess today we're talking about mev which uh i first encountered in my work on dexes in um you know 2017 kind of time period and uh kind of coined the term as a way to describe this implicit fee that we saw as potentially changing the game theoretic uh kind of uh consensus economic game between miners on ethereum uh so yeah that's my backstory in a nutshell i guess yeah and somebody that reads about the flash voice 2.0 paper might say that you and your co-authors on that paper are kind of like the fathers of mv so it's very exciting so would you be able to give us a succinct definition of mev and give us some intuition on why it can be dangerous for ethereum or destabilizing to some extent yeah absolutely so uh in a nutshell mev is basically the profit or the value it stands for minor extractable value so it's the value that a miner is able the able is very important it doesn't matter whether it actually happens or not to extract from the ethereum network when they create a block so mev kind of as a whole comes from several different places uh in the in the lucis form one of them is the block reward and the other one is transaction fees uh those are both kind of extensively studied in the past as sources of fees for cryptocurrency uh but there's two other sources that i think are very interesting and that apply specifically to smart contract platforms like ethereum one of them is transaction reordering so changing the order in which things happen on the network either to prefer kind of certain users transactions over others or assign certain profits to certain trading bots over others or whatever the case might be or even for miners to insert their own transactions that actively interfere with or take advantage of or use depending on what the nature of the transactions is these systems so it's kind of looks at the value with all the degrees of freedom a minor has in the protocol that a miner can use to increase their eath balance in one ethereum block or across a range of ethereum blocks why is this destabilizing well the simplest intuition is imagine if there's almost no mev from reordering in the system and then one block comes along where suddenly it's really profitable to control the order of that block let's say ample fourth has just rebased and created a massive arbitrage opportunity on decentralized exchanges or something like that um so in this one block it may be hundreds or thousands of times more valuable in terms of mev than the block that came before it so now the next miner that comes along has a choice of which block to mine on do they kind of ignore this block that just extracted all this mev and try to take that mev for themselves or do they extend it like they're supposed to in the honest blockchain protocol and just kind of go for fees and block reward so typically you call this time bandwidth attack in your papers if i'm not mistaken yes uh so time banded attacks specifically are also you can do this over multiple blocks so you can do an even longer 51 attack and so so yeah that's a great point um i will i will tie that in um but yeah basically this this makes consensus extremely can you still hear me uh sorry yeah um yeah it makes consensus potentially unstable uh one important thing to note about time-banded attacks is because it's hard to figure out the mev in a block you know it becomes more profitable the more transactions you have access to the more reorderings you can do um and so it's actually like super linear in time basically the number of profits you can make from a time-banded attack which i think is a super interesting point so a time-banded attack can happen only in a chain that has reorganizations kind of in a nakamoto like consensus where you can choose to build on the latest block or you can start a new fork from the past so is it the case that mev is less of an issue in a chain such as something that's built on cosmos or tendermint where they use a byzantine fault tolerant consensus with no forking yeah i think this is an interesting conversation um especially with you georgios and i'd love to hear your thoughts here because you're a pos and a l2 kind of guy yeah so so in some ways yeah let me let me let me let me challenge you a little bit and then i'll throw it to you um so yeah i i would say that the the the high level answer and the one that's in the flash boys paper if you read like the last last section is that maybe long-term reorgs are going to be harder so you won't see huge like 51 style attacks uh because of finality because it's kind of hard to reorg past this finality checkpoint and the real fundamental reason for that is just almost a social contract of the community like if you reorg past finality the community won't consider that valid uh even if the software says it's valid i think people will reject that and there's other incentives to sort of prevent that from happening on the other hand i think those incentives also kind of are subtly there in proof of work chains too like if someone came along with a hundred block time-banded attack on bitcoin it's not clear whether people would accept what the client says and say yes this is the most proof of work or will they say like no obviously this was mined retroactively and it's a malicious thing uh so i think a big part of it is the social contract of the community like pos kind of formalizes that a little bit more and maybe gives you this distinct boundary uh past which time-banded attacks are hard i still think they're an issue for like kind of the interim process of how you actually decide on that finalized checkpoint and that order there's all sorts of issues there that can be discussed but uh yeah my my i would pause it to you and i'd love to hear your take on this that really they're kind of equivalent in that in both you could possibly have this long-term economic incentive but in both proof-of-work and proof-of-stake there's like some re-org point past which the community will just be like no and in proof-of-stake it's a little bit more explicit because there's this like finality discrete notion right so i think i can push back on this so firstly i think that we have a disconnect in the sense that there's the bft proof of stake flavor which is what tendermint does and there is the whatever we call it proof of stake that ethereum does so the ethereum two will do so the proof state that the theorem will do it will it takes about 12 to 18 minutes to reach finality for a transaction and that's because you need to get two epochs to finalize to justify which means that in that period indeed you can have some short rewards and indeed the time bandit attack can still happen but in tendermint once a block has been signed on by all the validators it's no longer possible to create a valid block in the past it will get rejected by the by the clients that are that are synced to the chain so i think that you do not have time-banded attacks in terms flavored versions however there still can be anything until you reach consensus on the next blog so for example while we're still gossiping our pre-commits and our commits for the next bfp round maybe a miner say a validator comes in and says exclude this transaction because it will give you more like because i will bribe you for whatever amount and then it allows you to destabilize that so potentially what i think that it could cause is that instead of repeating consensus you know in five seconds maybe it takes you eight or nine seconds to to do that so it's more like a performance deterioration rather than an actual destabilizer to the extent of the created security so um moving forward from this like how big do you think that the mvv market is how much mvv exists and is it bigger than the transaction free market um will it be yeah um so you know i wish i had a better answer to that question i mean we lower bounded it in flash boys 2.0 but that was a very conservative lower bound where we only looked at one type of transaction on one type of decks there's a few different ways to answer this question you know you can go for just looking at what people are extracting and i think a decent proxy for that is the transaction fee market like i think the mev market is you know somewhat linearly correlated to the transaction fee market maybe a little bit more than the transaction fee market uh in terms of what bots are actually exploiting uh but the actual mev that's available to be exploited by bots is much harder to study because you have to basically ask yourself like what is the optimal order of transactions a minor can do in this next block to profit and that's a really hard computer science problem uh pretty much intractable so like it would include all hacks and like all arbs and things like that um so you know i would expect the mev market in reality like the real deal if you measured it that way what you would see is like approximately the size of the d5 security market uh which is probably like one order of magnitude and this is just me bsing my intuition here uh kind of smaller than the d5 we love your intuition feel we yeah if we hear your intuition that's great so do you think that there would be formal methods for example to find all the available mvv inside the blog or even kind of calculate the optimal permutation of transactions uh so that we can pull from the mempool to maximize the mev uh 100 i do and i would say stay tuned on that front i'm definitely planning on publishing some work in related to this and i'm sure i'm not the only person in computer science who's gonna do that so uh yeah i think we'll definitely see some all sorts of formal techniques i hope there will be a nice space of competition here um i think formal verification historically has been very murky uh the incentives to actually do it because it's expensive and hard and the value is not immediately visible up front a lot of the times so i hope this will actually be like a nice playground for those techniques to become profitable and maybe even be able to fund their own development eventually fantastic so we will all be looking forward to that so i mean so far how does the mev market in your opinion differ in ethereum rather than in bitcoin um is it that due to the composability available in ethereum that it its mav market will always be larger than bitcoin yeah um it's hard to know i mean bitcoin has some forms of mev uh because the market is larger like it's obviously profitable if you're a let's say large market maker on coinbase and you know the addresses of your competition and you can bribe miners say to even like delay them by like a block with like some probability uh that might be a worthwhile thing for you to do because in terms of market shocks and market events you know you might be able to move a little bit faster and have longer term like a more profitable equilibrium than they do uh so i think it exists in bitcoin it's much more second order and therefore harder to quantify uh and it depends on like the real economics of bitcoin in a way that like i think by design will never be able to know or measure um unless maybe we see some attacks come out down the line does layer 2 increase mv for example lightning creates a lot more opportunities to censor a transaction or reorder it transaction that's a great point yeah i think layer 2 hugely increases meb and i think that's one of the things the lightning skeptics early on in bitcoin pointed out that like look you're moving all your security to another layer but the miners incentives kind of change when you do that um and i think that was a poorly articulated case back then but yeah i think we can probably formally calculate like you know how much and uh my guess is if if lightning is the scaling future of bitcoin that will probably be substantial so that is a great point yeah how does smart contract composability relate to mev and i imagine that a lot of our a lot of our audience will be protocol or smart contract developers so how would you recommend to them um to design their software to minimize mv what are some best practices yeah that's a great those are both great questions um so i'll take the best practices one first because i think it's a little bit easier and more poorly defined um so i think the best practices for mev right now is just to like write an economic spec of what you're building and kind of try to reason through the mev and put it out there with your protocol like in those early stages of having the white paper make it part of the design and part of the awareness of this whole process so that you are thinking about it and that you're showing people that you're thinking about it and that you get feedback from people when they're mev vectors that maybe you haven't thought of i think soon we're going to see some more formal toolkits that will help people and like i hope things will become easier but i think that's one really good way in the future the other question is how mev relates to security and composability i think they're all kind of the same thing so like in some ways the miner is the most powerful permissionless enemy of your protocol if you're designing a protocol they can simulate any other cartel any other set of people on the network um they can reorder transactions they can censor they can insert so they're like strictly more powerful than anyone else on the network with your protocol so the mev to me is kind of like a lower bound for your security um and kind of speaks to you in which sets and which cases miners kind of can or can't extract value uh from strategies in your protocol so i think while you're doing your security analysis mev will naturally kind of fall out and the last thing composability so uh i'm i'm hoping that uh we're gonna release a paper on this soon out of cornell but to give you a sneak peek and you can probably look at my twitter for some other sneak peeks i think composability is also in some ways a function of meb so composability is in some ways saying uh when i deploy my contract the mev of the world is not going to increase that's basically saying that your contract will compose with everything that's out there because it won't substantially increase the degrees of freedom in either attacking other protocols or in taking money out of your protocol so i think that's one way to reason about security and i hope that we have a lot more information on that uh soon and a lot more kind of formal modeling i know we will have a lot more of that soon um so yeah really looking forward to that you you found us all very excited about this so while we call it mvv um it is actually not been used as mev so far it has been more like front runner extractable value um because all the liquidator boats are just building up and doing all these priority gas auctions uh in the time scale of one block so are there have there been any real examples of miners reordering transactions to pocket nav or inserting their transactions at the very top of the mempool of the of the block or has it just been um or are miners still not awake to this yeah so you know i i've been talking to a lot of pools and reading about a lot of pools recently so i've got my pools a little bit jumbled i forgot if it was f2pool or spark pool and i don't want to say the wrong guys i think it was f2pool but i just want to make make sure that i'm not saying the wrong thing but i think they were the earliest instance of when when i saw this a while back there's a fc paper on this uh about it's a it's a front-running sok so if you google like front running space sok space fc you'll find this paper i think it's by jeremy clark is on there along with a few other people and they talk about how f2pool basically front ran an ico and in some ways that was one of the early forms of mev in 2017 was like if i can get into this ico pump and then dump it on the people a little bit later in the pump you know that's a form of mev in some way and they did do that i think more recently people have been dming me a bunch of examples of uh pools that are doing uh arbitrage transactions that aren't ordered by gas and that are causing that are let's say preferring certain bots um and doing things like that so i think those trust-based networks are are currently being built and i think we're going to see more and more of that and chain if you if you want to if you if anyone cares to see it yeah and shout out so on what you said last week an anonymous twitter account called frank researcher who always puts out amazing research out of nowhere on twitter uh put out actually a case study of this where he found out he or she found out um that actually some miners were inserting low gas transactions on top of the block and it was interesting because it is kind of like you can tell that there is something fishy happening here um phil what is the difference between front running and backgrounding and i think most of our audience possibly knows what front running is but it would be helpful to get a full definition of both what are the differences and uh what are how are they impacting things in a different way yeah um so that's that's a good question um uh front-running classically is a really old term it deals with when people were trading on paper and people would kind of write orders and walk them across the room and like when you saw your competition kind of the fat guy was walking an order pad like at two miles per hour you could go run in front of him and like you knew this guy was probably buying based on the news you just saw so you just like basically sandwich someone and you like take the best orders in the order book before they can or execute the best trade before they can then they come in after you kind of get whatever is left in the market and then you go and sell back at like now the higher rate of like the market conditions they've created by buying so you basically make a guaranteed profit just almost guaranteed by like wrapping this person's order um in ethereum this profit kind of is guaranteed because you can do these atomic smart contract transactions where you do the sandwiching and you kind of just throw the whole transaction so in some ways it's a little bit easier to analyze than even traditional front running sorry and when you say sandwiching you mean you insert the transaction before somebody does something what they do happens and then you do another transaction typically that's what front running would look like uh and sandwich sandwiching is the particular term front running just refers to wanting to be there before them sandwiching is kind of a case of that where immediately after you also kind of uh liquidate your position or you get out you know yeah exactly you're trying to piggyback on them or whatever you're trying to do it's also very common in high frequency trading like when people place large orders on robin hood or something they're routed through companies that have more direct lines to the exchange so they kind of like triangulate you out and like place a little order right before yours because they know your order's gonna come in now and they know they can sell to you basically um so yeah this is classically it could either refer to being in front or very often sandwiching uh back running is kind of a crypto more crypto specific phenomenon although i would argue it's also kind of a subset of this same kind of behavior um and it refers to kind of getting in right after someone so let's say after an oracle update how do you do that uh usually by spamming at a slightly lower gas price than they would put so if they're gonna do 25 you try to spam a lot of like 25 minus one way transactions and if miners sort by gas price you hope and what is the effect of these actions so these are kind of actions that do not have a net benefit to the ethereum ecosystem yet they have some kind of effect on gas prices so could you expand on that yeah so it's hard to measure their effect i mean for sure they're paying a lot of gas and for sure they're putting a lot of transactions in that are raising the gas price and leading to this congestion uh we've also seen bots like that engage in bidding wars when there's just not enough throughput on the whole chain to handle everyone's uh kind of events that need to happen so in general they definitely drive these spikes that we've seen but they also cause a lot of like negative externalities on the p2p network so like if you're just running a full node you many of these pga transactions that we talk about in flash boys and even some of these back runnings and other kinds of spams the front running that we see a lot of this stuff never even makes it to the blockchain so like you have nodes that process maybe 100 or 200 transactions for the one transaction that ends up getting mined and miners don't care about that because they get the revenue and they kind of pay the cost once but if you're just running a node you're not making that revenue you're doing this just out of your pocket for whatever business reason you have uh and in some ways this is a tragedy of the commons that's like these people's bandwidth are what's being used to to play these games on the network right now right so phil um currently it is still how how do you think that the liquid data or the software or the keypad software operators will evolve over time will it be like uh how is it how mining got commoditized then it's now only big players in the game or will so will there only be big player liquidators or will there be some more um um like an 850 kind of situation or will there be more hobbyists around in the future yeah i think that's a great question um so yeah i i i don't know i think either future is in the cone of possibilities right now um i think i mean i would hope that it's not a few big players but i think the economics are set up to promote that in the same way that a lot of market economics promote a lot of big players just because expertise will kind of naturally concentrate in a few places and this is going to be a very kind of tight margin um very competitive kind of ecosystem so i think you know there is definitely a realm of possibility here that you get a few actors who gain outsized influence on ethereum through this um and i think as a community uh you know how to prevent this is like a conversation that we need to have moving forward on the social side of the ecosystem and also the r d side um so i don't know you know i hope it'll be a lot of small players but i think the economics are set up in the other direction i personally think what kinds of mev exists is there a benign mvv is there a good mev or is there only bad mvp or both or neutral can you give us some flavors yeah i mean i would imagine there's good mev um you know for example this is the same question i think about general trading activity on wall street and in general there's a lot of parallels here you know a lot of lessons to be learned like when is hft and are these things parasitic and rent seeking versus when are they beneficial it's a very hot debate some people would say they're always beneficial because in some ways they are part of the security model of the network and they should just be maximally exploited and you know users want to do this so we should enable this uh in as little a damaging way as possible but still like it is what it is um other people would say there's some mev that's more obviously benign like for example providing liquidity providers the ability to respond to news and like move their tokens around inside uniswap contracts could be one example of this or another example could be you know matching orders on ether delta uh making that market more efficient and are being some centralized exchange bringing that liquidity into the blockchain that could be fine you know if the if it's done at a reasonable liquidity provider premium that the user is aware of and okay with no problem uh you could on the other end have like these hacks like the bzx attack or something like that where like a bunch of people just lose their shirts and uh you know that's also mev so and everything in between i think also exists how do you feel about unified approaches towards mv extraction such as the one taken by keeper dal i just using saying that if you try to outbid me i will bid as high as possible so that it's not profitable for anyone so this creates a kind of a new equilibrium where everybody where maybe it is better for everybody to collaborate instead of collude do you think that that approach has a future yeah i mean i think approaches like that are kind of going to have to i think it's interesting that kind of equilibrium is one we talked about a lot in flash boys and i think it originally developed out of an interest of these trading bots that are exploiting the mev to basically cheat miners and keep prices as low as possible amongst themselves and then they were enforcing that cooperation and if you break that then they kind of make it unprofitable and that could be a way to like kind of socialize profits a little bit more efficiently and keep them off of the miners table um i think we're going to see that mechanism in a lot of different places or something like it uh it's kind of a natural thing to evolve maybe one place could be in preventing time-banded attacks so like intentionally leaving money on the table for other miners or having some sort of you know intentional uh transparent cartel that's like a good cartel i don't know if that's such a thing exists yeah a counterintuitive question as we're kind of slowly running on time is is it possible for mvv can be good for chain security and this is more like a thought experiment so let me lay it out so in the absence of the block reward you are relying only on transaction fees to align in minor incentives but what mav is is more revenue going to miners from non-block reward sources um is it possible that you could fund miners with mev to have a chain without insurance work yeah i think that's an interesting open question when i originally talked to vitalik about mev was when the original infamous uniswap x times y equals k post went on eath research and like i emailed a bunch of people and i was like horrified i was like what is this um you know this is terrible for users because all these arbs exist and the system's not very efficient so they're gonna get armed with another bug yeah exactly and the response i got from at the time at least was you know like maybe this will be the future block subsidy instead of transaction rewards when they decay to zero you know and like yes that is an argument i think there is some possibility that we will see that equilibrium i think it depends on what the mev actually looks like so if you have this like very burst-like mev i think it's much more unlikely because like systems in general don't like shocks they don't like these crazy things that like break the norm and suddenly change all the incentives um so you know my worry is that mev looks more like that um on the other hand if mev kind of becomes this predictable thing we know how to deal with maybe we can reach that kind of a future and it could be a benign thing and instead of leading to instability it could actually be a mechanism for stability so i think the jury is still harnessing the power of chaos exactly yeah fantastic so i have a final question for you phil and this comes from our audience do you think that mev and the eip 1559 an upcoming proposal for changing the blocks the block space market for ethereum um have any relationship so i think we both kind of agree here that they don't have a direct relationship at all um like the eip1559 still allows you to give a tip aka a bribe aka extra gas that still lets you which depends on transaction ordering exactly yes exactly and so from approach mvv comes from transaction ordering the eip does not affect transaction ordering so they should be unrelated yes i agree there might be some edge case interactions like the fact that spam now has to burn more gas because of the way it's charged with the minimum or like weird things like that like at the edges but in the core i don't really see a fundamental difference fantastic phil i think we are at time can somebody confirm that we are the time i think so too yes time indeed fantastic thank you so much hold on hold on because i am going to bring kartik up because there are a couple of extra questions from the audience you guys have just it's been um firing with all of the questions so hang tight i'm gonna say goodbye kartik step in and i'll see you all soon hopefully thank you so much simona and uh george isn't phil thanks so much for uh for a great talk um i do have a good camera set up for for this event so thanks for uh thanks for noticing um so we have a lot of questions coming from the chat and then for for those of you who are joining us now you can just go to live.ethonline.org and just see all the questions from the audience on the chat and what i'll do is i'll ask a couple of questions uh now to uh to you both and if you have time georges and phil um you can just go to live.edu online and just kind of answer the the questions directly in chat for any follow-ups um a lot of them are kind of small clarification so i'm just going to ask a small one which is um in one of your comments george's you said something in uh one of our attendees with like a verification and that is can you clarify the difference between each two finality and bft finality and kind of how do you differentiate yeah so typically tendermint like systems they require so you know let's say that you have 10 validators they require that or let's say that you have 100 you require that in order to produce the next block 67 of the validators they must sign on the on the blocks hash let's say and once they've done that um you can move on to the next block and the previous block is considered final the one that they just signed on while in ethereum two um finality only comes after you know so ethereum two has one block per six seconds and one epoch per 12 minutes but six minutes and it only finalizes a block due to how the full choice rule works after two epochs so there's a fundamental difference basically that in the eth2 kind of model it takes you two epochs for your block to be for the block to be finalized um while but it has a kind of looser liveness requirement compared to the kind of code of vote permission or title liveness requirements on bfd so it's um how do i say there's a trade-off between having a tighter consensus algorithm which gives you the the finality versus having something that's more loose while having while not being able to have the finality so it's a bit hard to explain this like more in detail um in this time span but i can i can expand offline if you want to email me please do i think it'll be if you're able to kind of comment on more on the chat that'll be awesome and then one final question for phil which is uh do proof of stake system solve mvv in any way and uh the question also says my impression is that the system in which some entity has null 