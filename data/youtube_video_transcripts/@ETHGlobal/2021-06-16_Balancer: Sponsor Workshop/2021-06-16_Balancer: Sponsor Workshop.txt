as many as you can okay jeff over to you okay thank you uh so yeah welcome everyone um i have some some fond memories of being on the other side of this last year and many local events going back to the 2017. uh these kind of hackathons are really the lifeblood of the industry and so much innovation comes out of them and i think even more so with these long-form ones where there's time to go beyond the concept and really make something magical this is especially exciting time with balancer uh we just released our long-awaited version too and uh at this point all the four pieces of the architecture in place and we're kind of in the fun exploratory like uh let's realize the potential for this thing phase and i'm showing these numbers so the plan today is uh spent a good bit of time introducing balance with youtube explaining the core features how it's different from v1 and other amms and then i'll use some graphics to show the architectural interfaces just skimming over it gives them time constraints but enough to give you a good feel and then i'll talk about the current state of development and give you some suggestions for interesting hacks and wrap up with a list of resources to help you get started building a balance for v2 so talk a bit about what balance or v2 is uh it's as we know each global attracts a whole range of participants some people might be very familiar with v1 and other people have never heard of an amn so um essentially it's an amm automated market maker with the clubs so you can do two things you can you can trade tokens right with low slippage on the decks and you can invest in liquidity to earn trading fees and mining zones so balancer v1 that launched last year in 2020 is a product so it's a very successful one does it drop well either particularly in tbl but the architecture is somewhat limited so uh you can never have more than eight tokens in the pool um smart pools are have to be implemented as wrappers around the core pools because we couldn't change the core rules and that means things happen at different levels and don't know about each other and our tokens are stored in pools and that means trades require token transfers and then we add in smart pools and proxies and you've got a lot of transferring going on and that adds up in contrast to the v1 product balancer v2 is a platform it's flexible user-friendly it's got many features uh designed to promote useful partners and innovators things like smart ones so in the main thing in v2 you're not limited to existing cool designs uh v1 addressed this by being customizable with smartphones you could choose the level of control and trust the v2 goes beyond that is fully extensive you can inherit mix in contrast levels meet your needs without duplication and gas efficiency was also a really important focus of development that's what we learned from from v1 the ux design gas stations uh v2 both of those are completely overlooked uh we can do swaps under 80k of gas in some really favorable circumstances uh and we made everything simpler so it might seem that goal is like that goal as opposed to the other goals but it isn't really uh you know to paraphrase einstein we made it as simple as it could be but no simple it's still complex in some ways the interface itself is very clean and sparse the arguments can get a little hairy that's the price you pay for and having something generic in the sense so for instance the vault wraps and wraps so the ui doesn't have to uh you can join and exit rules with any combination of tokens so if you want to join a five token pool you only have three of them uh in v1 you would have had to pick one or go swap for all the other ones and calculate the amounts and you'd have dust left over v2 you've got three tokens you join the three tokens from the gun and the interface is much clearer there's no clutter or unnecessary information so it's it's really an amm launch a rapid application development plan for amx and it's designed to allow people to innovate in the space without worrying about the details this balancer has done all the heavy lifting right you have the token storage accounting security and the vault and core contracts can't change and then what can change is everything else uh you don't need to fork the protocol right as long as you conform to the minimal vault interface you can get your own pool writing an asset manager [Music] so we expect a cambrian explosion of new designs this guy's a little hidden this is my favorite little virgin feel buddy i use to uh illustrate this so exciting time so here's current status um we deployed the contracts in late april as the vault court rules documentation give people who had you know time to prepare and get their card ready then their proposed came out uh then public ui launched in may this month we have stable pools and hopefully maybe the first smart pools and asset managers dvd um and generally we're continuously developing and there'll be a continuous incremental roll out of new features over time and uh from australian motors and uh proven test net is uh fully uh well everything's before the chlorine problem that's the contract c pulls really clearly ui subject everything so it can really be used to uh um so what does it look like here so at the center uh is the vault is this blocked by the you can see the full graphic the top right is blocked by your face all right okay it's not that important i guess that just says pool contracts um so uh so at the center of the ball is one big contract holds up [Music] and this this makes the extremely gas efficient so you can do swaps between 20 pools and you only transfer token pelicans at the end and and the sun mechanism is not even there and all calls are made right on the boat so uh no proxy you just approve your tokens once and you can do anything for trading investing uh and banking as i call it you essentially have a personal wallet inside the ball and you can use that to avoid token transfers in the leader costs and uh this shady looking character here can do uh flashlights and flashlights so the pools are still the cisco venues so the pools are still deployed contracts but the difference is they only hold the logic right now the tokens they're represented in the vault is data structures and their balances we see here are represented in a way that natively allows your capital emissions so you have a cash balance which is the actual balance of tokens that are present in the vault and then the managed balance which are tokens that can be removed from the home by the asset manager for various things yield farming voting you know whatever the right the asset manager to do but the vault axes though they're still there so you still have all the benefits of low slippage and high liquidity with the capital efficiency so and here's kind of the textbook advantage of what i what i described expanding on it just a little bit uh we have pool specializations and then we make that that's another kind of space optimization so like if you know the pool only has two tokens you can store them and store all the balances in one slot so you only do one read and write for all the tokens that's what it means and uh has a lot of features for high grade smart wallets including relayers or special permission contracts that can make certain calls uh according to governance and users and use allowances commanded the vault and so on and you could do a billion dollar flash loans long i'm always a payback look at that so i'm going to get a little hand waving now um in the interest of times uh this is the just kind of going over the the interfaces that are available in features and uh how you would use these if you want to do something your vital product uses the vault or you know that uses the pools or you know makes a new so swaps is one of the main functionalities you can do a batch swap which is like a multi-hop each individual swap is with one pool where one token balance increases and one decreases but you could string all those together and do multi-half as much as you want and again because everything's in the vault everything stays in the ball it's all very gas efficient there's also a optimized single swap if you know for sure that there's only one pool you can just directly swap against that pool and that's that's even more gas efficient and we also have this feature called the query venture so that is like a stimulator or a dry run runs the exact same code as the swap so there's no duplication literally runs the same code but it reverts right at the end of the included data so you can see exactly what will happen exactly what the token balances will be and this is a great help for your users on the money at the pool level uh you may be cool you you register it so this is uh basically you're you're creating that data structure inside the vault and creating it generating a encoded pool id that you get used on all the ap accounts uh and then you also say each poll has to say which tokens can be in that group and then you can interrogate information about the pool what's the id what are the tokens um what's going on in the tokens what are their balances they have asset managers which asset manager all that and then you can do of course the adding and removing liquidity operations these are very generic um they have for instance you could join a pool by pulling the the pool token you could join the pool and you want to join with three tokens even though it's a five token pool and you want to pull three of the two you want to pull the tokens from the user balance of the sender and you want to send the bpt to the external receiver account right you can do that and in the asset manager there's only one call but again it's one of these structures where it's you pass a bunch of operations and you can deposit you can draw and you can transfer and then there's other similar vault functions with the user balances you can interrogate what somebody's user balance uh and then the manager is very similar to the asset manager you can manage your internal balances you can deposit withdraw and transfer this could be used by aggregators if you had a custodial solution or some sort of smart wallet that had permission you you could you know say transfer things between users um you can do there's the flashlight interface uh there's which is very simple you just you're passing at a contract to receive the flash loan um and then protocol fees there is the protocol fees are separated to a separate contract outside the vault uh you can hear ask what that contract is and ask about the keys and then there's a permission function of course there are commission functions to set them up and then there's an emergency stoppage so that is a permission through governance that is a safety feature on the vault in all new uh pool types where for the first three months if we were to have a political security incident uh we could just halt everything except it would freeze the vault and you couldn't do anything except withdraw and that period lasts until i think mid next month after which it becomes really permissions and yeah so as i alluded to v2 introduces uh some swap fees our sub protocol fees uh there are two kinds they're currently zero uh but they could be uh they could be activated by governance uh there's a swap fee and a flashlight a swappy is a percentage of the pool food so if this full swap fee were one percent and the protocol swap b were also one percent the total would be 1.01 um and they you know they could be they could be very low and these are also there are hardcoded limits on these you know as as part of the threat model as a safety feature you know if governance were to be compromised somehow uh you know it's not possible to set the piece 100 or something and just to expand a bit on how extensibility and how how would you go about um you know making the new pool or using this so as an example of how we've implemented this the um the weighted pools are is the main thing that we have so that's a pool without you know two to eight tokens with fixed weights it's very similar to v1 it has weighted math which is similar uh to the v1 price mode so um there's this base weighted rule class which abstracts all the actual functions so the price curve calculations and uh it just all those functions need to interrogate you know what are the weights so at that level it's virtual and just has the logic and those are implemented in the waiting pool very simply because they're fixed it just reads them right from the fixed storage or from the fixed and whereas if you wanted to make the pool for essentially the bootstrapping pool that has immutable weight storage then you would just override those get weight functions and you know calculate the weights or even from storage or an article or do whatever you want to do so if you wanted to make a new pool type which had mutable weights you could simply derive from uh basically the pool and you would have all the stuff above it you know reuse all that for free and you have a very small um implementation uh the base layers do all the hard stuff for you all the invariant price curve you don't want to have to duplicate that it's already pre-done pre-audited things like tokens decimal scaling you know if you didn't use this art this whole mechanism you would have to do all that yourself um the because you have that's the problem you know on v1 to some degree when you have different decimal tokens um you know there can there could be issues with minimum balances and decimals v2 kind of avoids all that uh all the you all the uh i o is with native token decimals but the pool is converted to a full 18 decimal precision for all the calculations and then it scales it back uh you know we you know uploads the values so it handles all that so that that's it's just a concrete example of that mixed in kind of override architecture i described it so here's where we are in development or what's currently going on in development right i'm working on the liquid bootstrapping pool uh v2 version um which is completely different in this case it's a specific pool in v1 it's a kind of a instantiation or a particular use case of the general uh configurable right school in in v2 it's its own thing uh but i also there also i think will be a crp-like thing on v2 i'm working on too we've got people working on asset managers office probably the first one so you know this is where you can you know join a pool um a certain way and have have the ava tokens or the die you know doing head farming the background earning to go to the pool in addition to the to the fees and the mining uh you have great capital efficiency and maybe others are in the pipeline as well all kinds of third-party uh tools are being made there's one that does the yield curve so a totally different iceberg um there's all kinds of dynamic weight ones of various types and i'm sure there's some we don't even know about so quickly go into the prizes i'm sure you're all interested in that kept it simple just two eight thousand first four thousand seconds there are no categories uh like v2 itself it is unconstrained limited by your imagination uh however we do have some ideas of what you know uh might be promising areas of research for instance um asset managers so you could yeah layer two is a is a big push uh with everyone including us we are deploying on polygon very soon um and i believe also arbitron and also xy and uh it's going to be a big a big focus this year for everyone so uh a unique thing about balancer is we've leveraged this with this asset management mechanism so you could have an asset manager um that instead of doing something on level one like putting it on out like the avatar works entirely on number one you could have something use a bridge or put some of those tokens on level two um also there's many arbitrage spot opportunities here uh you can do what are called flash swaps where you have knowing you know using internal balances for uh very cheap gas um and you can have no tokens in you you see a arbitrage opportunity and you just take tokens out i think that has the potential to make uh the markets in v2 very efficient area is the migration so uh as part of the ui release there's a migration terminal uh so we when we first launched the oracle tools we made about 30 seed pools oracle seat pools that are these are supposed to be these are the highest liquidity pairs i think there's over 250 million or so in there now [Music] and those are kind of those are the targets so we're encouraging people to kind of concentrate liquidity on those pools so the migration tool supports just the substance so it's only two token pools and it's only two token pools that are similar to one of those steam targets all right so but what about all the other ones right there's a ton of other v1 pools most of which could be migrated in some form there are some camp most of them can so you could extend this what if you have a two token pool that doesn't have an equivalent what if you have a five two controller eight total pool you know maybe and also what if you have uh liquidity on other a m pipelines that you might get a better api on ifui on if you could uh migrate the balancer so it could calculate all these things and suggest uh different migration paths so it might say take take this eight token pool and and take this you know you know swap one and put this one here and divide this eight token pool into these four two token pools on v2 and it could just have a proxy or some sort of thing and do it all for you with one or two clicks that would be amazing um the other thing is around asset management portfolio management you could make a relayer one of these privileged or permissioned contracts that actively manages portfolios so for instance they could move between pools say you're invested in four or five different pools um it could you know using the internal balances you could withdraw from one into your internal balance and then join another one from your internal balance so you're not transferring any tokens but you're moving um things in between your your investments within the vault um to get a capture a better ap loan uh and more ambitiously you could even uh create a new set of holes that actually change the weights algorithmically um and it could do that as well as a custodian but of course the sky is the limit we're happy to be surprised surprises and uh i'm doing pretty long time it's about exactly 20 minutes so finally here are the resources um the main point of contact would be discord and the best thing would be to go on to the eve global discord when it's hackathon related rather than going on the general support i mean because it's going to be pretty spread thin otherwise so encourage everyone to go to the sponsor i believe that's the right sponsor balancer uh channel on the over the support and then here are some you know here's a medium article that kind of describes two here's the code uh everything is in one big model rebuild it is under active development uh master is the current release branch there are also tags uh because it's diverged quite a bit from what we deployed originally um you can always recover that uh with either the v1 tag or the release1 tag and then here are some guides from the about the docs that balancer dot phi is the uh the you know documentation and here's some handy uh links to some parts of that and then also into the describing the apis we have a pool creation package in python uh it's in the docs how to do it but it's kind of uh high level because everyone has a different you know dev environment and it's pretty hard to make a working script so the python thing is intended to be a just running out of box create a pool with a configuration and it's a work in progress um it's out there now um it'll be we'll continue to develop it through the hackathon it should support all the prototypes fairly soon it doesn't now but give that a try uh because otherwise it's a little ownership so that's all i had for the formal presentation it's 4 20. that was it was exactly on time so i guess i can go to the chat see what we have here should i stop stop sharing no i still see your slides and there you're never stopped okay let's look at this non-tradable tokens um okay well well the first one you have an easy one there plans to deploy in medical next value yes and yes um in fact it may even so we the difficulty is you know um you're deploying on on polygon it's yeah it's more than just you can deploy the contracts but um that's not a problem but it's not very useful if all you do is deploy the contracts i mean i deployed v1 uh v1 i deployed v1 on on mavic on mumbai actually um but you know it's not very useful if you don't have the ui and you don't have the sub graph you don't have all the other pieces right um also we have the whole governance piece right so we we need to have a multisig for the authorizer for all so that was a bit of a delay on polygon was to get the we needed to get the you know the signers on the multisig hopefully people that and we're still kind of recruiting and we'd like people that were that that are related to the polygon to be signers on the multisig i think that's all resolved we have at least a preliminary enough to actually do it and and i believe we're deploying [Music] extremely soon um within days i i would imagine i'm polygon um and yeah and and you would also need to and we also need to not only deploy the vault and architecture but also actually put pools there actually put liquidity on there um otherwise you can't do much with it right so yeah that's but i i do think polygon will be first they are important [Music] um looking up else here um i'm not sure i understand this full of non-tradable tokens i mean i can say generally you can you know a pool is an arbitrary contract you actually as long you actually don't even need to use anything you could write a completely you know a contract from scratch if you wanted to um you don't have to reuse really anything as long as you you know talk to the vault properly a pool is an arbitrary contract there are just you know there's a whole infrastructure there that you can reuse for convenience so things like pool tokenization you know we have a balancer um cool token that is the bpt um that that the core pulls all all inherent so that is that contrary the vault doesn't know anything about bbts so you don't need to use that you know you could have a pool that doesn't even do tokenization or does tokenization completely differently and doesn't use bpts at all um it doesn't even need to have tokens yeah i suppose um so uh yeah there's just there's really no limit to what you can do as long as you meet the minimal uh voltages okay simple example um i think there is uh i have to check the yeah i i some of the docs have been uh changing lately um we will be adding i mean there are some examples we will be adding more i think even the python package has some examples um and uh also you can i mean the repo has things that are in development so you can you know look at those uh there's a lot of documentation in the code that that you know tells you hey implement this to do this and remember that to do that but uh we also could if if it's useful to expand upon that if there's anything else people would like to see i'd be happy to write that um we're always extending the docs i do a lot of dog writing um so happy to extend the docs as needed there are um lots of people working on custom views you know for concentrated completely that'd be another another kind of example um i mean the two token pool is sort of like that i mean we have a way of math and stable math so [Music] yeah all those all those uh you know all the pools currently use those mats but it's not constraining you you could make you could you could make another uh math library with different math and then use that instead right uh so the question here is if there were a token usdc pool is there a way to tap into the usbc like use it as part of one off alone well yes that's that's the ava asset manager which is not released yet but that is exactly the sort of thing that the um of the asset manager of asset manager would do um so it would you would join the pool with usdc and specify that you want to use the ava asset manager and then with a new 80 um allocation and then it would take that take those those tokens and farm them out before you went on uh there's a whole elaborate kind of staking it's related to completely mining and staking this is all getting rolled out it's it's tbd but a lot of this is is uh i there's so much going on i didn't miss everything but there's a lot of stuff going on with ava and staking and mining earnings distributions that is uh that we'll have details on that when that gets closer to release all right i'm so sorry to interrupt but we are kind of back to back on workshops today uh thank you so much jeff for this really amazing workshop and thank you to balancer for sponsoring hack money this year um and yeah if you guys have any extra questions or like to talk to jeff or people from balancer make sure you guys check out that discord channel 