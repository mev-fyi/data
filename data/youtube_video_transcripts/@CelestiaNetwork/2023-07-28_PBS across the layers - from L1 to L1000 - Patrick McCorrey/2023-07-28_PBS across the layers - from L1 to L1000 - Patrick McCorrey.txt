hi guys my name is Patrick McCory I work at the arbitrim foundation and today yeah there's my really dinky slides so I didn't have a cool intro before and I'm just going to talk about PBS across the layers for layer one and Layer Two and so let's just jump right in you know let's have an overview of layer one and let's have a consider about you know how Mev sort of evolved there so on a basic level for a blockchain system you have Alice and I'll responds to transact and she needs to get her transaction and communicate it to the block proposers but the question is how does she get her transactions across and historically speaking you would send this to a gossip protocol or a peer-to-peer Network so all is send it to the gospel protocol every peer will get the transaction validated and then pass it on to the next peer and the block proposers live on the Gaza protocol so they'll get they'll hear the transaction and then include it in their block as well now the question is who else lives on this peer-to-peer Network Searchers do and I'm sure most people here are aware the search will hear the transaction they'll inspect it they'll say oh I can extract value from this so they'll copy it paste it and get it to the block proposer first and they'll pay a higher transaction fee so it gets into the block proposers first or sorry their transaction will get in first but now not just one Searcher is there many Searchers are there and they're all typically competing for exactly the CM opportunity and we call this a priority gas auction so maybe let's raise our hands does anyone remember these gas auctions okay awesome and did anyone ever steal your your transaction that have you ever been victim to uh the P the you know PGA game okay maybe maybe one or two Hans there anyway so what is a pretty gas auction why is it important so what happens is that I stole this graph from someone from this really nice article about it but basically within that 12 second window one searchable place a bid another search rule plays a higher bid and very rapidly throughout those 12 seconds you could have a hundred different bids that are all competing for exactly the same Mev opportunity the block proposer will simply take the you know the bid with the highest fee because that's going to pay them the most money and so there's two problems that happened here with you know these priority gas auctions and this is sort of like 2019-2020 one was wasteful and failed transactions because the successful transaction would get in alongside all the field bids so this is a waste of block space and two it's sort of unrestricted Mev as well you're sort of taking the user throwing them to the wolves and you know their transaction may or may not be executed at the very end and so when flashbots emerged they sort of resolved this problem so has anyone ever used a direct transaction before with flashbots a few people here awesome cool cool so the way they solve the problem was very simple they set up a direct communication Channel between the user and the block proposers okay and so you just basically bypass the peer-to-peer Network you bypass the the Dark Forest so they cannot eavesdrop on your on your transaction but what can we extract from this scenario so first we have to consider the transaction ordering policy so when a layer won't blockchain we typically use the highest fee first you ever pass the Moose money is going to get ordered first the second is the communication protocol can a Searcher eavesdrop and learn about the user's transaction and then extract value from that um finally we have to consider is the user experience you know what guarantees did the user get and how long does it take until they figure out oh my transaction is being confirmed or someone's extracted value from me and so what do you do about this in the layer one world you know what do do you defend against the Mev or do you try to embrace it and you know just take it sort of you know it's going to happen anyway that's embrace it and use it to protect the protocol so let in the layer of one world we've sort of gone down the path of embrace and Mev I'm PBS games and why is that and that's because to this day I am not aware of a protocol that can defend against Mev when we take into account 500 000 validators you know at the protocol level we just don't have a protocol that can defend against Mev in any meaningful manner at the layer won't be as layer because after all one of the overarching goals of a system like ethereum is to maximize who can be a validator you know maximize that set and make the operators of the system as decentralized as possible and one of the other problems is that well one of the reasons why you would Embrace Mev is because one of the assumptions at a layer 1 blockchain is that all validators roughly get the same reward you know if I get the same reward as the other validator then we'll both arm rewards at the same amount I know will be equal Partners or you know well equal competition if one validator can take the Mev for themselves and it's not shared amongst the validators then they'll grow bigger than everyone else because they'll earn more rewards than everyone else as well and that's a terrible outcome you know if you're not we're not careful of how Mev is embraced will break the property of fair reward for the validators and one validator will grow I'm you know you know basically defeat everyone else and so that's why fast parts and PBS sort of solves that problem when you think about what flashbots have done is that they've taken this onto an auction protocol and took it off chain and what they enabled was to allow block proposers to Outsource the work of Mev and then a Marketplace of Searchers can all compete the extract the Mev and of course you know share some of the rewards of the proposers and then they get some of the reward as well um this is also acknowledging that someone in their bedroom can probably do Mev better than someone who's running like a you know a validator farm for ethereum you know alsocial to the best people who can do the work and share the rewards between both parties and that's why it's really cool you can share the reward and you also reduce this on chain spam now what about a roll up you know like just just a highlight you know that's why we have PBS for the layer one to protect the decentralization of the validators but what about a rollout is the environment any different and it's exceedingly different a rule up already assumes that we have ethereum we already assume that we have this decentralized platform with hundreds of thousands of validators we don't need to replicate this at the layer two we don't need 500 000 validators we just need a handful maybe one two three four five sequencers and that's it and as we'll see you know the sequencer is there to offer the user experience and the fast path they don't actually impact the cfd of the system but that's cool if you only have a small sequencer set that's a much more tangible problem to deal with in terms of Mev and you know the scenarios of our history of forward Alice has a direct communication Channel with the sequencer so all this can give her a transaction over then the sequencer can give an instant response the sequencer has ample time to do whatever they want with the pending transactions they have a listing of the basically like a basket of pending transactions they can apply any ordering policy that they want and they could do this within a few minutes or up to a few hours they have ample time to extract as much Mev as they want if they wanted to do that and of course eventually the sequencer will take the list of order transactions and pass it on you know maybe to the executors the provers ETC so all they're doing is ordering transactions and that's it so let's again compare the core components so Layer Two is very different and Layer Two the sequencer can apply any ordering policy that they want the communication channel is very different it's a direct communication channel to the sequencer there's not necessarily an opportunity for a Searcher the eavesdrop on this communication and finally the user experience you know the user sends a transaction the SQL string give instant response it's a bit like plan of the Legacy we have two world where you get this instant response when you sort of interact with a website but as we're going to see as you try to improve the user experience you're going to impact Mev its ability to be extracted and there's this sort of weird trade-off between extracting Mev and how users experience using a roll up or a layer 2. so as I mentioned lots of ordering policies you can consider no has extraction first has fee first first come first serve it could even be Cal swap that's an ordering policy any order and policy that you want there but most rule UPS today Implement first come first serve what is first come first serve you know very straightforward I give the sequence for my transaction they time stump it they respond to me then they order the transactions by time stump you know it's extremely extremely straightforward and you would think with first come first serve there's still no Mev here so raise your hand if you think there's Mev let's see there we go awesome now of course there's Mev why so what arbitrum tried to do at least is that the sequencer has a data feed so you know we get user transactions we do first come first serve and then we reveal that in a data feed every 250 milliseconds and the reason for this is that we want to provide you know coinbase etherscan and fura we've opted data so user can send their transaction look at Arby's gone and say oh my transaction is confirmed well if you have a sequencer feed where you're given out this pending data to these infrastructure providers Searchers pop up of course they do and what do they do well they listen for the transactions if they find a backgrounding opportunity bomb you know they send that out immediately oops look at that there's a Searcher right now sorry oh he's listening aren't they um but this is it that you have this rise of this latency game because an arbitrim you didn't just get one Searcher you got 150k websocket connections to this data feed and so one is a latency game because they're all competing with each other and two it's a bit like an analysis attack on the sequencer because you have to maintain 200 150k websocket connections this is not an ideal scenario so the all of chain Labs guys came up with a really elegant solution in my opinion but there were some outcry already laughing about it aren't you um you know they basically wanted to implement House cost because it's basically you create 20 priority Lanes you do some proof of work you have the Lewis proof of work you gain access to the priority Lane for 24 hours to reintroduce improve for work in order to solve this problem but as you can imagine there was a lot of outcry people don't want to use proof of work to solve this problem was of course for me is an elegant short-term solution but it doesn't really solve the problem long term but this is really frustrating right we have this trusted sequencer this ideal scenario where we can fully trust them not the extract Mev and the Mev Mev Bots are still there I mean look at this guy this doesn't go away does it that's full of Diane by the way from flashbots don't know if you know who he is but your little evil eyebrows on him but he's always there doesn't leave us alone well what a guy the Dark Forest is always lurking so then the question is you know what's more fair are these latency games fair you know clearly not you know as a Denalis service attack on the sequencer and you know there's just fighting amongst each other so then it brings you back to the question well what about auctions you know that's how it was so often the layer one we create this auction and let them bid for the opportunity and those are the idea behind the time boost proposal by Ed Felton from off chin labs and I'll give you a high level overview of basically I mean it's very straightforward as you're going to see maybe they have an academic paper that's slightly more complicated but the idea is simple you know all this gives a transaction to the sequencer the sequencer still has this data feed where they reveal the transactions but now the sequencers compete in these little bundle auctions very rapid auctions and then of course the winning bundle gets sent to the sequencer then the sequencer then decides okay here's the transaction botch but the point here is that this bundle auction is configurable it could be really rapid it could last 500 milliseconds it could last three seconds and what you're really doing is purchasing the right they go back in time so within this auction window you're saying I want to go back 250 milliseconds in the past another way to think about it is that you're buying for a specific position in the ordering maybe you want to be the 20th transaction the 30th transaction but that's you're bound for that you know the opportunity and you can be selective so in the time boost proposal their goal is only to allow back running because back running is not seen as bad Mev you know there's other moral questions around that but it can be configurable you could allow front running you could allow sandwiching and because the bundles are so small and the auction just will wrap it you could probably inspect it look at the transaction say okay I will accept that type of Mev but it will not accept this type of Mev and so my last slide is basically some interesting questions around that should the sequence should be allowed to inspect an Mev bundle and then decide not to include it you know this could impact the credible neutrality of a rule app because now they're sort of being subjective over the transactions they include but if it's better for the user then maybe they should do that the auction time window is set to only enable back running but you know should we allow front running in some region as well and maybe the last one because these are rapid auctions we want so the whole point here is to enable the marketplace of Searchers you can all compete to find these opportunities but if it only losses 500 milliseconds and there's only five transactions they know there's probably only one Mev opportunity so maybe you want to set the time window so there's 50 transactions or 100 transactions and so then you can get more interest in you know Mev marketplaces out of that because they're all competing for different opportunities but for me the time boost paper sort of inspired this talk I thought it was really interesting and I've been just thinking a lot about it so it's not really my work at all it's just whatever I've gathered from reading so I hope you enjoy the talk anyway GG GM GM well thank you Patrick [Applause] 