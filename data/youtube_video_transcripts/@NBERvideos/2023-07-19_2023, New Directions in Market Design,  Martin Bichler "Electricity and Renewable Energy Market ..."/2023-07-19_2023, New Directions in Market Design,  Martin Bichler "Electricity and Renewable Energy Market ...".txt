so good morning everyone thank you so much for the kind invitation to come over thanks for uh Tamar for this wonderful introduction I'm going to talk about electricity spot Market design and this is Joint work with two of my students mediah and uh Johannes uh I thought to set the stage I tell you a little bit about the European day ahead market and I think this has a remarkable history but particularly in the past 10 years there's been a lot of regional exchanges and they've been coupled so today as we speak 98.6 of the EU consumption is coupled and this amounts to 200 million euro average daily value of match trades so if you do the math this is like 73 billion so this is a huge huge computational Market I'm saying computational because essentially the underlying Clearinghouse so you know once a day the exchanges that send their asks and bits to the centralized Clearing House they run a series of mixed integer programming problems not convex problems they are hard to solve but they managed to do this in time and it's a series of allocation and pricing problems and I'm going to talk a little bit more about this later as we speak as we heard from Mar in Europe we have zono prices so for example we have one day ahead uh market price all over Germany so this is different to the noble prices we have here in the States but they did actually um a nodal Market simulation they means the N3 this is the organization of transmission service operators in Europe in the EU and to give you a bit of an idea of the size of the problems that need to be solved so they had to cover 16 000 generators and batteries some Source this 25 000 25 000 nodes and 22 000 lines so this is a huge uh mixed integer linear program um as a matter of fact for the purpose of this study they only solved the linear programming relaxation because it turned out too hard and maybe you want to keep that in mind for the last slide so as you know uh obviously these are important markets but also not all states countries are using markets right so in many jurisdictions there are electronic Power Systems and they are often operated by vertically integrated utilities and they own the generation their own transmission and distribution assets and they do all of it right there are ISO markets in the states and there is recommendations by Ferg to actually move to ISO markets um and I think one of the main arguments for using markets is you know increases competition and so on and so forth but on a theoretic level it's the wealth ethereums right um it's also obvious that if you look at the original aerody Brewer models they tend to be quite different to the types of electricity markets that we see today and I want to pull out two aspects that are different the first of uh it is is our cupboard markets in a way so I was telling you about this 25 000 nodes so this is what you see on the right hand side here uh and a bit of an illustration so each node is a market and they're interconnected with these transmission lines um and if you have excess Supply on one node you know you can compensate some Demand on another node and so on right and the second is and that's also no news to anyone here in the room there are non-complex cities in this matter obviously right so and there's a long history of thought on non-convex kids then what I'm going to do for the remaining time is I want to talk about these two aspects I want to show you quickly that the coupledness is without loss but when we talk about these non-front vaccities that needs a bit of more thought so from a bird's eye view what's uh such a market maker an ISO Market has to do is he wants to maximize the you know a utilitarian value welfare function um subject to a demand Supply constraint right so the x i here are essentially positive and negative quantities and all good so we're essentially maximizing gains from trade so what the buyers are willing to bid minus what the sellers are asking for right and if we have a centralized market and we have concave value functions context costs we get everything you want by essentially just drawing on a lagrangian tool right so essentially what you see down here um you know the lagrangian multiplier p is really it tells you about the marginal value of an additional megawatt RC and what we did in a motivation for a paper is we essentially looked at a couple markets and uh it's actually fairly straightforward to show that you can extend the or get a version of the welfare theorems for covered markets with quasi-linear and complex preferences and it would say as you would expect if you have P star being the prices and Z Star but the allocation being a corporation equilibrium then this allocation maximizes welfare and second welfare theorem if c-star is a wealthy maximum maximizing allocation then it can be supported by a set of prices what I want to highlight though is the following first we do not assume any type of differentiability so you can have discrete convex functions the proof does not rely on on any type of fixed Point theorem so we essentially drawn fantastic young inequalities from convex optimization and what is maybe more so if you have this type of convexity in in this coupled markets then it's not only an existence theorem it's constructive right so you can draw on say some subgrade in the algorithms and solve these problems to optimize it and what you get um and this should set the base for for the coming slides is the usual design Etc router that we are after right so we want to have efficiency and demand Supply balance and this just follows from Primal optimality of the welfare maximization problem um and we want to have NB freeness and budget balance and they essentially follow from strong reality and complementaries likeness conditions right so all good what is a little more challenging are the non-complexities as you would have expected and there are two sources of non-convex cities and electricity markets that I want to highlight the first not simply due to the physics right so the types of high voltage networks that we operate in Europe in in the states are AC Network so you have reactive power so essentially what the market maker would have to solve is the so-called AC optimal power flow problem so on the right hand side this is a well-known picture um and the you know the colored manifold that you see over there this is essentially the feasible region you would need to find an Optimum on this feasible region and that's computationally very hard it's a qcqp right and we can solve large problem sizes of those so what ISO markets do is they solve this mixed integer programming problems they linearize the line losses they treat the problem as if it was a DC Network and these are these DC OPF mixed integer programming programs that I was referring to before right so there's been a lot of progress on that front uh and uh big I think was one of the driving forces behind this rpe grid optimization uh competition to find better kind of uh tighter convex relaxations for this underlying AC uh feasible region or acopf right and there's you know amazing results on that what we did in a recent study um is we looked at the prices that come out of it and just you know one of the results that I found interesting is um when we looked at the dcopf prices they often led to very large but unnecessary price spikes right unnecessarily in the sense that we looked at the acopf feasible solution and this is the one that the second order cone program found as well this did not have this allocation a slightly different allocation there was no congestion right yet the dcopf LED to very high prices right and this is important because on this electricity Market you have this you know congestion costs and people want to hedge against them they use Financial transmission rights as forwards and and then you want to get the underlying right so this is getting to tighter relaxations really is important also for the prices the second source of non-convex cities is due to preferences and we've heard about that from Mar already and there are plenty of reasons technical reasons so there are non-convex used to due to the startup cost that you mentioned and shutdown costs of gas turbines they're not going to uh to go away anytime soon there are non-convexities due to containment of certain Renewables transmission and distribution costs and Central and support so this is the simplest example that I could come up with um so we have one seller who is submitting a a package bit so it's a block bit this is the decisive characteristic of the European bid language it's really a combinatorial exchange what we're looking at and he wants to sell two megawatt hours for thirty dollars and we have two buyers they are all both interested in one megawatt hour willing to pay up to 10 or 28 dollars right so quite obviously you get gains from trade namely eight um there is amount Supply equivalence um so two megawatt hours you could have budget balance however if you want to have linear and Anonymous prices and relation prices are linear Anonymous you run into these issues right so if you charge less than 10 dollars such that buy one would break even well then obviously the seller would make the loss and vice versa if the price is higher well then buy one would make a loss so there is no easy way out right so you need this is fundamental and uh obviously so we are not only violating any friends we are violating individual rationality the guy makes a loss so several ways on how to go about it obviously you need to relax some of these axioms from the wealthy theorems so um and what the us Americans do here is essentially uh the relevant Market is the real-time Market you really want to get it right in the real time uh and you maximize welfare you insist on that but you rely exposure levels right and you pay makeup in Europe the opposite is being done so essentially the the key Market is the day ahead market and you stick with a sub-optimal outcome um but you don't have to pay any medical payments right and I want to briefly talk about both approaches um and they have their pros and cons so this is well known so those are the the four axioms that we are after and obviously in the US market we want to enforce efficiency full efficiency and the question really is what is the order of magnitude of the deviations that we get so how much budget violations do we get and what you need to know for those of you who have not looked into an electricity markets so there are there's a long history on how do pricing in electricity markets but there are two key papers I would say that really made a big impact in the industry the first one uh from 2003 is by Bill Hogan and ring on convex Health pricing so this in general is you know intractable but there are for certain types of the dcopf uh there is the elmp and this is essentially uh from the DC okay if you take the linear programming relaxation take the duals and those will be your prices essentially very roughly um the second is by actually in his co-authors are very random paper in each or and it's the IP pricing you solve the mixed integer programming problem you fix the integer variables to Optimal values and then you take those tools so in in both of these there will be situations like the one that I was showing you before some might actually make a loss right so what you can do now is you could either pay this Global lost opportunity cost so you know if one generator is would do better at those prices with a different dispatch well you just compensate the guy right this is actually not but it's been done in most isops what most Isis do is they pay these medical payments just to make in break even right and then this is a very transparent Market if he would still deviate from the efficient allocation you stipulate a penalty right and that's obviously what you think this has led to a number of concerns uh one actually brought up very prominently by the U.S firm saying that the these site payments are sometimes for some of the uh of the generators very very high so this is a quote from Ferg order saying that the use of site payments can undermine the Market's ability to send actionable price signals so you want to worry about this um and the second is so if you were to most isos are actually using IP pricing but if you were to move to move to Elm piece or convex Health pricing it's kind of very well known and this is a quote from Shiro very nice survey paper that convex Health pricing might produce positive congestion prices for transmission lines that are not congested and again here we want to get these congestion prices right because they are the underlying for financial transmission rights so this is important that's by the way a bit of an advantage of Ip pricing that at least assuming that the transmission service operators are convex well then you would not incur this these deviations we measure that by local loss opportunity costs I'm not going into the details of that but that's one way to measure how far off we are with respect to this connection congestion prices so one of the things that we did recently is we uh said well why why don't we model this differently so in one way you could think about is why don't you model the pricing problem as a multi-objective optimization problem right so why don't we go after both the minimal makeup payments uh to make the uh the generators and participants break and these local lost opportunity costs that are a measure for these congestion prices and how how accurate they are and we kind of introduced a new type of multi-objective optimization approach we called it the join it's it's parameter free doesn't need any weighting like scalarization and we tested it on on a large data set from the European Union so this is the data set that they used for the bits on review for this this nodal processing simulation that they did so what you can see on the right hand side is that indeed if you optimize these two uh Design This router then you know the the macro payments that you get array lower than what you get with IP pricing and on the other hand the make hole payments that you get are way lower than if you were to minimize only the medical payment say right and so you can do a lot the paper is a number of you know propositions as well that you can prove on certain characteristics of this pricing rule it's guaranteed to have lower makeup payments than IP pricing and the prices of participant-wise Pareto optimal I think the only thing I want to leave with you is well you can do better than than maybe some of the the pricing was that have been out there if you focus on on multiple goals let me get to the second approach this is let me call it the European approach let's give up on full efficiency right and Welfare maximization and what the European Union does is they in this hearing house they run the PCR euphemia algorithm so this is as I said this series of mixed integral programming problems that they solve so they start with the welfare maximization problem then they try to find linear and Anonymous prices and if that doesn't work they need they add additional Cuts until they find it but each of these rounds takes another mixed integer programming program to solve and they are already running into computational issues here right so they're going to smaller Market time units so ultimately they need to do something about it and there are no balance kind of so a couple of years ago for a very different Market of fishery access rights we looked at a very similar problem and we proposed an optimization formulation that does everything in one optimization so essentially you're trying to find the welfare maximization maximizing allocations subject to linear Anonymous prices right and you can then prove some bounds that are getting better as the market increases should also not be a surprise here and so on and so forth um what I found a very fascinating contribution was by Paul Paul Milgram and and Mitch watch just last year it's a paper that I encourage you to look at um and what they did is they suggest a market with two price vectors so why not uh and the idea is simply if you have these non-convex cities there might be some excess Supply right so you charge the buyers a little bit more to cover that excess Supply right and you can still get linear enormous prices but we have these two price vectors and what they show is that the mechanism is nearly efficient nearly individually rational incentive compatible and what is maybe more it relies on convex optimization only and that is kind of exciting because I was telling you about these huge problem sizes that we have they also have a bound from welfare first uh first welfare theorem that is actually independent of the number of the size of the market the number of participants and still gives you balance which is nice so what we did quite recently is we you know implemented that Based on data from the RPA grid optimization challenge uh which was interesting we just wanted to see well how big are these trade-offs really right um and one of the challenges I have to say is you you need to find route arounding techniques so if you stick to economics optimization in this case it would be linear programming well then you still have to round to a feasible integer solution and that's that's a bit of a challenge really here but you know we kind of Master that came up with some solutions and the interesting observation was that the efficiency loss is say one percent sometimes maybe up to two percent which is fairly low as compared to the fishery Market that we looked at where we had five six seven percent efficiency loss and if you consider that we are talking maybe about say the the day ahead Market well then maybe the remaining inefficiencies can be fixed with an intraday market and by the way weather conditions are changing anyway right so maybe you can live with some sort of uh of an efficiency loss on on such a market and should just give you some some ideas here so let me get to an end here um so what I wanted to convey here is really electricity spot markets are very large computational markets right um and you need to solve them and pricing is a concern what is being done in U.S ISO markets is the relaxed budget balance it's one of the designers of the router that can lead to very high make hold payments which is a concern even to The Regulators it might depending on which rule you choose also lead to wrong congestion signals and I was trying to convince you that there are ways to maybe improve on both you never get it you know perfect but you can do better and the second is uh you know you might decide to give up on full efficiency maybe you know really you relax this a little bit and uh then uh in the European market they use this PCR euphemia algorithm this is computationally very expensive as I said they are moving from one hour to a 15-minute Market time units so this blows up the problem even further so it's getting harder and harder to solve uh this is actually at the focus of the stock market Design Group as we speak right so people are really concerned about this we don't have really bounce on the welfare loss it's really a bit of a heuristic approach and even there are some ideas I think on the horizon where we could maybe improve uh the allocation and pricing of these very large markets with that I want to come to an end and hand over topic 