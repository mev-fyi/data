all right everybody uh welcome to uh the first uh financial data science seminar of the semester it's also the first one uh that is in person as well on zoom as well on youtube if you're on youtube smash the subscribe button and get some more of these uh wonderful talks uh so uh i'm really extremely happy to have siamak milani be our speaker um the this talk is going to be very exciting it's sort of at the intersection of three of the favorite uh quant topic quant finance topics uh out there first there's derivatives pricing sort of the bread and butter of quant finance then there's market microstructure which has been around for a while but it's still very exciting and uh and finally cryptocurrencies which are a bit newer and uh you know if if you if you love any of these three topics i'm sure you learned something uh about the other two and uh so without further ado uh cmx uh the floor is yours thanks for coming thank you sasha um thank you for having me thank you for the kind introduction just before i get started uh just to acknowledge my co-authors this is joint work with jason milnonis who's a phd student in the cs department at columbia tim ruth martin is a faculty member and the cs department also had a research at acc crypto which is one of the largest crypto vcs and uh as sasha said this is a little bit challenging of a talk to give because it sort of relies on you know three sort of very different areas so i'm going to rely on you guys a little bit to be gentle but also feel free to ask questions uh especially related to clarifications and so on um because again um you know probably not so many people here know all through these areas so with that i'm going to get started so what we're going to talk about today is market making trading right we want facilities for people to be able to trade right and what do i mean by trading i mean the exchange of assets we want to exchange one thing for another so here because um what we're going to talk about automated market making mainly oh you know what i got to turn this on i'm sorry it wasn't on is that better okay mainly we're going to the the actual automated markets um or wholly as far as i'm aware automated market makers are in the crypto world so we're going to be using a running crypto example so the example i'm going to be thinking about is i want to trade one asset for the other the asset i want to trade is heath the ethereum cryptocurrency and what i'm going to trade it for is us dollars or some u.s dollar coin or or something like that um so you know it could be anything else it doesn't matter that it's a cryptocurrency but that's just the example that i'm going to use um just to make things a little bit more confusing for those who aren't so familiar with cryptocurrencies there is ethereum the cryptocurrency which i will call eth but there is also ethereum the blockchain system which is closely associated i will call that ethereum so i'll try to sort of make the distinction and when you say eth you should just think of a random risky asset right so anyway we want to trade this asset for um we want to trade this asset for uh for dollars and vice versa this is largely a solved problem um uh in the in in the traditional finance world and um the solution that the market has converged to you know really maybe 15 years ago is basically the electronic limit order folks right so if you look at you know liquid assets things like stocks futures um uh you know so on and so forth to a large extent maybe you know 90 percent 99 don't quote me but to to a large extent they trade on limit order books right and i'm assuming most of you know how a limit order um book works but basically the idea is you put in these limit orders whether you want to buy or sell right how much in terms of the quantity and what price you are willing to pay for the so-called limit price and these orders get matched up right and so you know you might have orders resting in the book like this some orders to sell at higher prices some orders to buy at a lower prices um incoming orders will come in and we'll either join these rested orders or or or be matched against them and trade um orders will leave and you know so on so so so so that works wonderfully why hasn't the the the cryptocurrency world um adopted um this structure wholesale well it's got a it's got a couple of problems first of all the specific type of trading we're going to talk about doing is we're going to talk about trading on the blockchain right we're going to talk about trading for example via smart contracts on the ethereum of blockchain right and as we'll see the blockchain is a very computational and storage uh challenged environment right so even something like matching orders in a limit order book something that comes down to basically sorting and comparison and so forth this is actually too much work right it's too much work because it scales with the number of orders right it's too much work because there are very high update rates if you see you know a modern limit order book like let's say the nasdaq limit order book right in an active stock you may pick a second of the day right modern blockchains can't handle that at least not down so that's the sort of the first challenge right this doesn't work well in an environment where you don't have a lot of computation and storage the second challenge though is that it also requires the participation of active marketing right so the way that market making is done in these markets is those companies whose names you've heard of that um that intermediate these markets companies like citadel securities like virtue like two sigma and so on and so forth and the spirit here is if i'm in a world order book and sasha is trading in the living room also and i want to buy and he wants to sell if he arrives before i arrive someone has to intermediate to matches so the way it works is there'll be a high frequency trader who stops it will sell to they will temporarily hold this inventory and when i show up a minute later but interesting okay um so the the challenge here in in market making is it's a little bit of a chicken and egg game right the market makers will want to make markets if there's a lot of volume because they can make money right but there won't be volume unless there's no marketplace right so it's a challenge to sort of figure out how to bootstrap that market in the cryptocurrency world especially because there's a sort of a long tail of assets right you can sort of you know go out there and in five minutes create your own a new token and maybe you want people to trade it well guess what no market maker is going to touch that right so while the limit order book um works really well and again has been broadly uh successful there are some challenges um and this is an environment where it doesn't work well and so people came up with this idea of automated market makers right so i'm gonna um i'll walk you through this a couple of times through this talk um but this will be the first um sort of high level overview the idea is as follows again we want to trade east versus u.s dollars we're going to have these people we're going to call them liquidity providers they'll be like market makers right and they're going to put in a pool of eth versus dollars right and um there will be some uh um rule by which that pool quotes price and if you want to come into that pool and buy eth you can take east from that pool but you'll add to the dollar pile if you want to sell if you can add east to that pool um uh and then you will um uh subtract from the dollar pile and uh um uh so on so that pool is what will provide the uh the the liquidity that pool is what will be uh um traded against and there is a mechanism that i'm going to describe in a little bit which sets the price as a function of what's in the pool right and this was inspired by early work in the prediction markets in the 2000s so for for those who don't know there's this area called prediction markets the idea was that we want to get good probabilities of events like for example a really good probability for whether it's going to rain tomorrow right so and maybe on the park business i'm going to lose a lot of money so let me set up the market people can bet on these contracts you pay a dollar in the range you lose a dollar if it doesn't you know whatever right and within that market i can use that market prices so people sort of you know propose this the question is who's going to make markets again and these automated rules were proposed but they never kind of took off well what kind of happened is that they've been kind of taken off yeah let me switch to this then in the cryptocurrency world testing they have taken off right and um uh um why do people do this well you earn fees right so you put some uh you put money in there the lps they put in usdc whenever someone comes to trade as a percentage of the quantity that's traded they pay a fee so that's why people bother to do this they're out to uh to to make money it's going to solve the two problems we had before mainly what we're going to see after i describe how this works is it's very computationally efficient you don't have to sort numbers you don't have to like compare lots of things and so on it ends up being just algebra and critically it's sort of constant time it doesn't scale with the uh the number of uh orders in the uh in the system so that's one benefit um the benefit that uh it's more computationally amenable to a blockchain environment the second benefit is it doesn't need market makers the whole thing is geared towards passive liquidity providers in other words you put your money in this pool this automated quoting mechanism um sets the rules for how the prices are generated you earn your fees but aside from that you don't you don't touch it right you're not like a market maker like uh like citadel where you're constantly modifying your prices and seeing what other people are doing and and so on and so forth this is very passive anybody can do it right so um uh we'd like to understand this that's the basic question maybe the first question we'd like to look at is from the perspective of the liquidity providers from those who are lp'ing providing liquidity does it make economic sense right namely is the benefit of doing this bigger than the cost right well i've already articulated what the benefit is you earn fees right what's um a more deeper and underlying question is what is the cost right there's got to be a cost to doing this right there's no free money in this world right so if i tell you you're going to earn fees right a natural question should be like well what am i paying right and um of course we know the answer to that question right if you know um uh something about market making whenever you make markets you always pay attention right so there's going to be some kind of adverse election cost what do i mean by address selection well when you make markets there's typically two types of traders there's traders who have information and when those traders come and trade against you they have information that you don't they typically make trades that you regret right because they know you know something that you don't and you lose money to those people on the other hand there are people who are typically called noise traders who don't have information and you're collecting the fees there right so market making in general whether it's on a limit order book whether it's in an amm whatever it's a little bit of story about collecting fees maybe collecting half spreads or whatever in a limit order book and paying adverse selection and the question is when does the the fees that you collect exceed the the the adverse selection so this is what i'm going to answer today i'm going to give you a concrete adverse selection model um with formulas and everything for these automated market makers but before i dive into that i want to give you a preview of of our results to just show you that um they're really very um you know intuitive and applicable so in order to give you that preview let me show you this screenshot this is a screenshot from a system called uni swap which is the largest uh collection of these uh these liquidity pools this is uniswamp v2 it's the um the slightly older version of the protocol and this is a pool that's trading ethereum versus us dollars right usdc is a coin that for our purposes is going to be effectively uh us dollars right and so you can see first of all on the bottom left as i said people have posted um uh um coins to these the reserves of this pool so people have posted about 63 million dollars in um usdc and about you know 33 000 in ethereum that's the the uh um uh the assets that are sitting in the pool that people will come to uh to trade against that's the first thing so in in total value um that's you know these two are worth about equal the total value is about 124 million dollars and at the same time you can see the fees that have been generated right so the user interface is showing you the fees sixty-five thousand dollars in fees have been generated over the past uh 24 hours right is that a good deal well oftentimes people will do this calculation they'll say okay you got 66 000 in fees there's 125 million dollars in capital if we annualize that that's about a 20 rate that's pretty good right but obviously you got to ask yourself where's the cost what's the uh what's what's the trick what's going on and and that's what i'm going to show you we're going to give an adverse selection cost here and um the key input we're going to need is we're going to need volatility right volatility is going to be a critical piece of information and so for this pair volatility which i'm going to call sigma is about 5 um daily so this is very volatile right so typically a stock like a us equity might be one to two percent daily but of course this is a cryptocurrency this thing can go up by you know a factor of 50 in a day quite easily so the volatility is quite higher but that's that's going to be our input our input is the volatility and what we'll develop in this session today is a formula where i say look if the volatility is sigma the adverse selection cost is sigma squared right and so what is sigma squared over eight it's about three basis points and so if i take three basis points on a hundred and uh um twenty five million dollars um uh three one hundredths of a percent that gives me a cost of about 39k right so put aside where this came from for a second and so on now my revised calculation is look i'm going to make 66k i'm going to spend 39k on this adverse election cost um from these these and you know um uh on people with better information and so on so maybe now i expect to make eight percent annually right now a couple of caveats here first of all there's a lot of market risk here right because you're you know if you invest in this pool you're long ethereum and ethereum is very volatile so i'm assuming you hedge the market risk i'm going to come back to that second i'm making a couple of assumptions here i'm assuming we saw over the last 24 hours 66 000 i'm assuming that's going to continue that we'll see that over the next 24 hours i'm assuming that if the volatility was five percent that will continue but you know with those assumptions in mind again it's a model it doesn't have the answers to everything if you're confident about what the volume is going to be so you get the fees and you're confident about the volatility i will i'm going to argue today that this is the right accounting to figure out how much money you're going to make so um um that's the plan today and specifically what i still owe you what i have to explain to you is what do i mean by this adverse selection cost and so on why is it sigma squared over eight you know what is this eighth what is going on there and so on we're going to get to uh to all of that but before we do that the highlight of the contribution is essentially what you saw that sigma squared over eight that's a black scholes formula for ams right and it's very useful in in two ways qualitatively when we're the way we just use it it's pointing out to you what the drivers are to um the your return as an am lp principally we see that the volatility is very important especially in sigma squared so variance that's one driver we saw the trading volume is another driver because the fees are proportional to the trading volume we're going to get to this marginal liquidity idea but number one we're going to highlight the qualitative aspects of what's driving the returns the second thing we're going to do is quantitatively we're going to see that we have um these very simple formulas that when they are applied to data look look look quite good and and quite quite reasonable right so that's the plan today just in a little bit more detail the sort of back of the envelope calculation i showed you is on what i'm going to call an lp return decomposition in other words i'm going to explain the return of being an lp or a liquidity provider right first thing is i'm going to look at hedge return right so i'm going to hedge away the market risk right now you all are in a financial engineering program so you know all about that but we're going to get to uh exactly what i mean by that but once you do that basically you have the trading fees that's the income and the cost what i call adverse selection before um that's what we call lever right lever stands for loss versus rebalancing and we're going to see why we give it that name in in in in a little bit but but that's the main decomposition i'm arguing for the interpretation what is this lever cost well i've already given away that secret it's an adverse selection cost it's an information cost right and so the way that's arising actually though is subtle and interesting and a little bit different than other microstructure models that have appeared uh historically um principally the way that this information cost is uh arising is that we're going to assume that the amm is not the main market we're going to assume that the main market is a limit order book on a centralized exchange or anything else right so we're going to call that a uh the centralized exchange or the the the external market and that's going to be the most liquid place to trade the source of price discovery if you will now the where does our cost arrive from our cost arises from prices are being set on this um centralized exchange however our automated market maker it is a smart contract that lives on the blockchain it does not have access to those prices so when people come to trade against it it is trading at inaccurate prices it suffers slippage right and um who are the people that take advantage of that arbitrage right so there are arbitragers who can trade on both of these venues they can trade on the chain in the automated mechanism they can also trade on the limit order book they're gonna make money right because that's the job of an arbitrager where does that money come from it comes from the pool because this type of short-term trading is a zero-sum right and so this is a little bit different than the story i gave you before about informed trading in the classical microstructure models like dating back all the way to seminal models like you know gloucester and milgram and the other the kyle model and um so on informed trading means someone who's coming in and has information about the future right so maybe there's an asset and you know you know something about it or you've done research or you know so on and so forth and that's the source of the information you have the informed traders here are a different kind of informed traders they're arbitragious the knowledge they have is just of current prices but elsewhere now that may seem like a subtle difference what does it matter whether it's knowledge of the future or knowledge of an exchange price but it's actually not because quantifying informed trading in the first sense and the knowledge of future prices is very hard right if i see um you know sasha and i want to ask is is he an informed trader what i have to do is i have to look at trading record his trading record and basically i have to ask on average does he make money right that's sort of the definition of an informed trader right so i need lots of trades and i need to be able to identify them back to him right so it's very difficult to measure informed trading it's very easy to measure how different prices are and that's the way volatility comes about right so yes it's a classic model of adverse selection but a little bit different than um what um we've seen in the literature um before there's also going to be an option pricing um interpretation of this cost we will uh we will get to that and um what's nice is again um we're going to work in continuous time we're going to work in a black shoals kind of setup and we're going to get a very nice um closed forum formulas and we're going to be able to predict uh um uh you know have trading strategies we're going to um work with real world data and find our our formulas are accurate in terms of prediction and uh and so on so that's where we're gonna start okay so just in the interest of time i'm gonna skip over the literature review aside from uh i'm pointing out that you know options pricing microstructure are relevant um uh prediction markets uh in terms of this earlier work i described and also there's a whole bunch of other work on amms this is a very uh um popular topic right now because these things uh um uh you know have taken off in the uh the crypto world um so i you know it's fair for me to point out there's uh there's other work as well okay so i'm going to try to give a five-minute background on blockchain because i'm sort of my mental model is that you guys probably know more about the derivatives pricing and volatility and so on and less about the blockchain so i'm going to try to explain what's necessary to know for uh for for this topic so um first thing is when you think about a blockchain um i don't know i'm sort of what your a mental model is but the right mental model is that it's basically a computer it's a generic mechanism for basically getting to consensus about some kind of distributed state machine aka a computer right you know the sort of the origins come from distributed consensus in general maybe in environments where you trust each other from from cryptography there's a lot of thought in terms of economics and incentives and so on and all this is extremely interesting and i encourage you to sort of read about it because it's kind of amazing that any of this stuff works but i'm not going to talk about it today from my impression from my perspective it's just a a computer so for example probably you have heard of bitcoin right now what is bitcoin it's it's not quite a computer but it's almost a computer if i think of what the bitcoin system itself does it is a distributed ledger what does that mean it keeps track of it right so if i own some bitcoin it's you know i would have an entry there if sasha owns some bitcoin he would also have an entry and what what are the kinds of transitions you can make on that state well you can pay people right you can move um a money from one entry to it to another if you sort of splint your eyes and like uh um you know um you know pretend you're looking at it from uh from a long distance this is basically a computer but a computer that can only sort of do these very simple state transitions only payments right and so so so that was sort of bitcoin which is really you know sort of the first sort of successful um blockchain system but um hot on its heels um was ethereum so ethereum came um around uh um six years uh um later and almost every other blockchain that has come since is also um um you know um like this and the idea is let's just not do payments let's let's be turing complete let's have a programming language right so um uh you know when people talk about smart contracts they're basically talking about a computer program that instead of running like uh on your laptop is gonna run on this weird you know decentralized uh um a computer system called ethereum right and the consensus part is through incentives and um payments and mining and validators and so on we will all be able to agree on what is in the memory of this computer even if none of us trust each other or even know who each other are right so again the details of this are quite um i think intellectually fascinating but um again it's just not my topic today so from our perspective we're just going to think about the blockchain as a computer right however there is one detail that's important it is a very slow and expensive computer right so this is a little bit of uh um an extreme comparison but on one hand i have ethereum right which again is a very famous and and well-known and uh expensive system it costs about 20 million dollars a day to run the uh um the ethereum network in terms of money paid to miners on the other hand on the left you have this toy computer which is something called a raspberry pi something you might buy like a high school student to sort of you know you can install linux on that and you can have fun and you know so on and so forth that costs um you know 45 dollars but is about 5 000 times more powerful than uh than the thing on the right right so you know again the right mental model is a computer but a really really slow computer maybe slower than any computer you have in your possession right and so you know but that's still okay right it's a very slow and expensive computer but there are some scenarios in a modern life where it's you know worth a lot to sort of be able to do you know small kinds of transactions right or simple computational um types of things and it turns out that one of those areas is finance right and so that's ends up being a lot of what these smart contracts and these blockchain systems do so what i'm going to i'm showing you here is a chart which shows you what is going on in the ethereum system on the y-axis is the percent of gas consumption of the top 20 ethereum smart contracts the top 20 computer programs now gas the details of what that is doesn't matter but basically the idea is you're charged whenever you do some kind of operation on this computer the units of that charge are gas right so you know you can think of gas as a payment for resources so the y-axis there is reflecting what our resource is being spent on on this computer the x-axis is time and in there you see the names of different projects and protocols i have a little legend for you you don't have to go through all of it but basically what i'll tell you is almost all of them are finance related right finance related in the sense of being stable coins collateralized lending or trading right the one thing that is maybe not is you have nfts over here nfts if you know what they are great if you don't it doesn't matter it's maybe borderline finance i don't know there's money involved but it's not clearly financed but these things are definitely finance right so the biggest category is finance and if you look at within finance what is the biggest subcategory it is trading and if you look at within trading what is the biggest single protocol or smart contract it is uniswa right so uniswap was launched in about 2020 and it's basically it's basically the number one application on ethereum right in a little bit of a broader contest thinking about it in terms of crypto um you know again even um even though we're talking about trading on the blockchain most trading in crypto does occur on exchanges right exchanges like binance or um uh coinbase or or ftx and um so on and uh so for example binance is by far the biggest exchange in crypto in terms of where where trading happens now what about um uh um these decentralized exchanges or dexes or what about uniswap well uniswap is about comparable to coinbase right so similar similar types of um a volume so you know um uh the um uh you know and an aggregate maybe one trillion dollar uh traded so the point that i'm going to make and this is important for my modeling assumptions is number one it's important we should pay attention to it but you know this is a lot of money a lot of trading is happening but number two it is not the place the price discovery is happening right at least on average in this particular sense more trading happens on exchanges in aggregate than in amms on the blockchain okay so that's basically the intro that's all you need to know so from now on ethereum is just a computer whether it's a blockchain or you know whatever it doesn't matter right so what's our model so you know executive summary um just to keep it simple it's a continuous time black shell set up with stochastic volatility right let me walk through the details in a little bit slower so without loss of generality i'm going to assume we're trading two assets so one is going to be a risky asset i'll typically denote that with an x variable and a running example will be eth the currency right and then we will also have a riskless asset also called cash also called the numeraire i will denote that with y and again you can imagine us dollars right so we're imagining a setup where we're trading these two assets this is without loss of generality if you look in the paper it's very easy to have more than two assets it's very easy to have one of none of the assets be the numerator and so on so this is completely without loss of generality we're also going to assume the risk-free rate is zero right again without loss of generality just to avoid me having to put an r in every equation um so uh so so so so that's fine um i'm going to need um a market price and so i'm going to define p of t to be the um the price of the risky asset in terms of the numerator so how many dollars you'd have to give up to get uh one unit of uh of ethereum and again what i'm calling the market price i'm assuming the primary source of price discovery is the centralized exchange or or sex right cx um and and pft is going to be the the the market price on the centralized exchange i have to describe to you how it evolves and so one important ingredient of that is um we're going to have stochastic volatility so there will be sigma of t which is an associated volatility process and what i mean by that is that the returns are going to be a random walk in the following sense if i look at the return over a small period of time delta t its variance scales with uh a sigma t squared right and if you sort of uh this is sort of the intuitive thing you're thinking about um uh you know returns being sort of a random walk what is the easiest random walk let's make everything gaussian right and if you sort of take the limit as you take delta t going to zero of course we get a stochastic differential equation right so you know and here we write dp over p the instantaneous return is the volatility of returns again that stochastic process times um a brownian increment right and that is the thing that is going to give me um a gaussian thing so again this is a a very very standard model in finance right um by the way i'm not going to be too technical about this like you need conditions for example you need this thing to be bounded in l2 and so on for these things to make sense but i think this is more of a conceptual talk so i'm not going to you know dot all the eyes and cross all the theorems but again this is this is sort of very standard stuff some questions so far okay so now um so so this is all pretty standard for options pricing now we're going to get into the microstructure piece now i'm going to tell you how these amms work right and so these amms are often also called constant function market makers i'm going to use those terms um synonyms and the basic idea of a constant function market maker is there's a function that you want to keep constant right so there's going to be a function f this is going to be a function of how much the pool holds in reserves in the risky asset and the uh the cash asset y and that's called the bonding function and so for example um the most common choice of bonding function is uh the constant product so for example i may require that the product of the two reserves be constant so x y equals l and that's in fact what i've graphed here right so what do i do with this function the starting point is that the um the liquidity providers they contribute reserves as i was describing at the beginning so they may distribu contribute a quantity x 0 of the risky asset and y 0 of the cash asset and you sit here and these these reserves they sit locked inside a smart contract on the uh on on the blockchain so that's the the lp side and what's going to happen is traders come in and they're allowed to trade against this but the rule is if you start at let's say the blue point or whatever point you start at you can only move to another point on the curve right that's why we call it constant function you got to be on a level set of this function you got to keep this function constant so for example you could move to the from the blue point to the green point those are both points on the curve when you do that if you're a trader what's going to happen is to get to the green point well the the pool needs more reserves of the risky asset so you have to contribute the quantity x1 minus x0 on the other hand it needs less reserves of the of the not risky asset so you can take out the quantity y0 minus y1 that's a trade you just traded this quantity of one asset for that quantity of the other asset what is the other price you got well the average price you got is simply the slope of uh um the the diagonal line in that uh um uh that that thing right so this is a mechanism that's how it works right and so you know um this gives you the average price if you want to think about like a spot price or an instantaneous price all we need to do is shrink the trade amount to zero and we get the slope that gives us an instantaneous price so the slope here if i'm sitting at this red point tells us if i want to trade a very small amount of x for y how much of x i have to give up for y and and vice versa that would be for a very very small trade an infinitesimal trade if you have a bigger trade you just do this and from that picture you can read off what the price would be as a function of the size and you can see that this um uh sort of uh um uh you know um you use flattens out um in other words you know the more of the the risky asset let's say you you sell the lower the price is going to get yes questions um well when you the way the automated market maker um works is um uh it knows what inventory it has and then you say i want to deposit this amount of x and take out this amount of y it checks if it satisfies the invariant and says yes or no yeah so at the very start you said the point of the automated market makers is that they're just more efficient resource-wise just it makes sense to do within the blockchain but if most of the transactions of this type are still done on normal exchanges like finance why not just do all of them there what's the point of having automated like market makers good so let me let me repeat the question so the question is if there's an exchange why is there an a and it has better pricing and so on why is there an amm um so so this is a a little bit of a deeper reason it turns out there's a lot of utility to being on the blockchain right so the idea of being on the blockchain is you might have different services you might have like uh you know a collateralized lending service you might have a portfolio optimization service and so on you can think of this as a subroutine for trading you're in your smart contract you need to trade ethereum for us dollars you call out for a function it happens on the blockchain if you want to trade on finance you can't do that right you have to wait you have to send a message across a computer network and so on right so if you want to be on the blockchain if you want to have trading be a subroutine of a computer program right you have to do something like this but that's that's a good question okay so um how about the fees well again i mentioned the fees are proportional to quantity so if you trade um these quantities here you know maybe the a common kind of thing to do is to take the quantity that you're inserting and make you um like so here we're um we're sticking in um the the x asset maybe you put in a little more to sort of cover a fee they're typically um proportional fees right so for example unit swap v2 our running example they charge 30 basis points right so however much you want to trade 30 basis points of it will go to a fee and what happens is um so what i've described so far is the liquidity provider staying constant but over time more liquidity providers may come or some liquidity providers may decide they don't want to do it anymore they want to withdraw their coins and so what happens there is the level set changes right so if sasha decides all of a sudden he wants to be a liquidity provider there will be some you know reserves in there already he will contribute proportional to what's in there already and the whole curve will shift up and then he will get a proportional share of the fees and that's called minting or burning when these liquidity providers join the pool or decide they want to take their coins out of okay so our market model we're going to have two types of traders we're going to have these arbitragers their job is to sort of snipe the difference between the um the centralized exchange and um the uh the the external market so what they're going to do is they're going to constantly monitor them those two things and if there's ever a difference they do a trade and they make money and we're going to make an assumption which is not true we're going to assume that they don't pay fees right and and that's for tractability right and and they absolutely do pay fees and that's important but when i show you the empirical results later we'll see that the model is still pretty good right so that's the first type of trader the second type of trader they're the noise trader this is someone who's getting a lot of utility from being on chain right maybe they can't trade on binance for example if you're a u.s citizen you can't trade on binance right there's you know um also kyc mnl so on or maybe they just want to do it in a smart contract for whatever reason they can only trade on the cf mm um they want to trade partially for uh idiosyncratic reasons for example because it's convenient and they do pay fees right so the idea is we're going to lose money to the first group of people we're going to make money from the second group of people and we want to ask the question of uh um you know which which group is uh um uh bigger and uh um uh we're gonna make some simplifying assumptions so um in the model that i'm about to show you i i as i pointed out you when you're providing liquidity you can join or leave at any time i'm gonna imagine we're looking at a horizon where people don't join and leave where the liquidity providers are constant right so maybe you know you're looking over an hour or a day or something you're thinking i'm going to put it in for the next day and then you know should i put my money in or not right i'm i'm gonna assume that the fees are booked as uh cash payments right in in reality sometimes the fees are reinvested in the pool and that makes things more complicated so we're gonna that's that's not that important and finally we're gonna ignore things like the fact that actually the blockchain is discrete time continuous time is not the right model right and you know so on we're just gonna ignore that that kind of stuff okay so let's uh let's hop into our analysis so first thing we need is we need um something called the pool value function that is that object v of p there right what the pool value function tells us is as a function of price where should i go on this curve to minimize the value in the pool so the pool is worth as little as possible right and so for example if the price is um uh p um the solution to that might be x star of p and y star of p and what should be the case is the slope over here should be minus p if that's the optimal solution right why because p is the rate at which you can trade x for y and if it's the uh there's the slowest part and this the smallest possible value this should be sort of the uh the the the tangent point if this was not the slope you'd exchange one for the other and you would you'd make a little bit more um more money right so the way to kind of look at this is a little bit of a convex analysis trick right i have these primal variables the pool reserves it turns out this problem is much better described if we move to dual variables which are prices hyper planes supporting hyper planes and the reason is the object that we sort of fundamentally care about that we're describing is a price process right and so this lets us do that phrase differently if i have released this pool into the wild and the market price of this asset is p where do i expect the reserves to be well this is an adversarial environment if the value of the asset is p the people trading against it are the people are going to try to take out the most money they are going to try and minimize the value of the poor right so if you're in an adversarial environment and it's zero sum between you know the the arbitrage yours and the uh um the pool what the arbitragers will do is to make the most money for themselves they're going to make the pool worth as little as possible right and so for example if the price is p and this slope is a minus p you would expect the pool to be here because that's where it would be if the arbitragers try to make as much money as possible right so this is going to be a very critical object this pool value function questions okay we're going to make an assumption this is a technical assumption we're just going to assume that these things exist and that um this function is smooth that's twice continuously differentiable okay and so just to give you an example um this is what it looks like in the constant product case in the constant product case again my bonding function is the product of the two things remain constant so if you sort of stick that in up there and you write down the lagrangian and sort of the undergraduate calculus exercise you'll see that as a function of the price the optimal amount in the x-axis is l over root p the optimal amount in the y-axis is l times root p and the total value of the pool is p times the first thing and then just the second thing because it has a price of one it's just cash right so again just want to make this kind of concrete this is all simple algebra even though it's just in a fancier math and i want to make sort of two kinds of uh two sort of more subtle points first point is if you think about what this x-star means observe that this is decreasing in price the price of the risky asset goes higher you hold the pool holds lower amounts of the risky price this is a demand curve right when you sign up for this thing implicit in x y equals l you are promising that as the price goes up i'm going to sell this as at rate one over root p right that's um what's uh what's going on behind the scenes here the second thing is um what is special about x y equals l why is this sort of the most common choice it's not because x times y is a simple function it's because of this thing if you observe that if this is um if i have quantity l over root p here and l times root p here in in dollars i actually have the same value in these two right and indeed the value of the whole pool is simply two times l root p right so what this is actually doing this constant product rule is behind the scenes it's balancing to hold constant dollars in the two assets actually it's not doing anything the arbitragers are balancing it to do that and they're incentivized to do that by the structure of the bonding function okay so i want to give a couple of quick properties of this bonding function these are pretty elementary properties of optimization um so uh you're just gonna have to sort of take my word for it but they're they're sort of not deep um uh but basically the idea is if i take a derivative of the other the value function the first derivative is um the the demand curve in other words how much of the risky asset do i hold that's a consequence of something called the envelope theorem which i'm probably um some of you have seen and if you take a derivative again the second part of the theorem is that the second derivative is negative and that's because something like this when i'm minimizing linear functions that is always concave right point-wise minimum of affine functions is always concave and so since this thing must be concave and since i assumed it has a second derivative its second derivative better not be positive right so again these are just elementary properties nothing nothing deep going on here but we're going to have to uh um come back and and okay so again my assumption these arbitrages are constantly monitoring the market they're trying to make the most money for themselves as possible to make the most money they leave the least value in the pool so in other words the value of the reserves in the pool at time t better be re-evaluated at p of t because that's what the arbitrage are incented to do because that's where they make the most money again minimum value in the pool means most money for arbitrage right and so again in our simple example we knew what v was v was something like 2l root p so we just plug in the the the current price there one more ingredient we need oh by the way i should also mention there are fees again we're counting the fees separately so v is just the reserves that are remaining in the uh the pool fees are going to be a separate line item in our balance sheet and we'll come back to those later so just be aware of that okay last ingredient we need is we need something called the rebalancing strategy here's the idea we're worried about the pool having these risky assets the risky assets move around in price and the pool buys and sells them and buys and sells them to arbitrage yours right we think we're losing money doing that so in order to quantify that here's a mental experiment let's buy and sell the risky asset the same way that the pool does it accept and trade instead of trading with arbitrage what we're going to do is we're going to trade on the centralized exchange that's what i'm going to call the rebalancing strategy the rebalancing strategy is going to do the exact same thing on the risky asset as the pool does as the arbitragers do to the pool but it's just going to do so at fair market prices at external prices and so concretely what do i mean by that i mean you have a self-financing trading strategy it starts out with initial holdings that that match the pool so in terms of the risky asset it holds x0 the same thing as the pool and same thing as the y asset and over time as time evolves so for t greater than zero what it does is it just maintains the same position as the pool again the arbitrages are always setting the pool to have the solution of the optimization problem and we're just going to copy that right this is this is sort of something that you could you can do we'll do this and then we'll compare it to how the the amm does when it trades at the uh at the prices which are not on the centralized exchange right that's going to be our comparison so in order to do this we need to understand the profit and loss of the strategy so i'm going to write down a quick expression for that so rft is going to be the value of this on the portfolio of this rebalancing strategy it starts out with the same initial value as the uh um uh the pool right by construction and we said that it's self-financing so since it's self-financing the only when we're not putting in money we're not taking out money the only way that the value can be changing is because the risky asset changes in price so here you know i just did a discrete approximation if i start the eighth period and i hold this much of the risky asset right and the risky asset changes in price well this is how much i made in period i and i can sum it over all periods this is discrete of course you know we're going to work in continuous time so just informally here i can take the limit as a delta t goes to zero and the sum will converge to an ito integral and so this will be the expression for the um the value of my portfolio at time t it's going to be the initial value plus the integral of um the risky holdings integrated against price changes and very this is sort of standard standard stuff okay here's the main result so we're going to define a quantity called lever loss versus rebalancing it's going to be the difference between the value of the rebalancing portfolio and the value of the reserves in the pool right so this is just used to define lever the theorem now characterizes it it says the following it says lever takes this form it's the integral of some function um little l which is uh going to be the instantaneous level integrated over time and we'll parse what this is but the second part is the important part the second part is that the process is non-negative non-decreasing um and predictable right so i'll come back to what i mean by predictable non-negative why is it non-negative well i have this thing here this is positive because remember this function is concave the second derivative is negative so if this is positive and i'm integrating something positive well i'm going to get something positive or at least non-negative and moreover it's going to increase over time right so the starting point here is to observe that the um the pool reserve values systematically lose money versus doing the same thing but on the exchange right now that should be obvious because the arbs are making money right but uh but but the particular thing is is is this functional form so just to dive into it in a little bit more detail let me rewrite the top equation and plug in this integral so the top equation i have that the value is the rebalancing strategy minus lever over here in the red term here i plugged in the p l of the rebalancing strategy that's where i had a couple of slides ago i plugged in the expression for lever i write this in differential form i get that the instantaneous change in value of my portfolio has two components the first component the red component that's a market risk component what do i mean by market risk it has a dp in there so instantaneously it is exposed to the market the other one does not have a dp right so instantaneously it is not exposed to the market right um you know longer term it's exposed to the market because it still has ps in there and sigma's right but instantaneously there's um uh it's locally riskless and predictable over here we have the risk right so first thing is there's a a risk term and and something else this has the same risk as the rebalancing strategy because that was the p l of the rebalancing strategy however this can be hedged right so in particular if i took um if i'm an lp investor and i simply take the opposite of position of the uh the rebalancing strategy on the exchange and i look at my aggregate portfolio that term will disappear so first of all this term can potentially be hedged right second of all um uh you know as assuming that uh um the the the prices are fair on the exchange i'm i have risky positions here i may earn a risk premium i may make money i may lose money right but that's because the coin could go up or could go down i'm not going to lose money systematically right could make money could lose money this second term is a systematic running cost right and so that's what uh um uh what uh what what lever is let me parse the formula for you a little bit so we said that this this this cost is the integral of this instantaneous lever this little l this little l you can write it out in terms of two components the first component is i'm focusing on the sigma um of p squared this is kind of like an instantaneous variance right so you have this this loss this information causes adverse selection number one it scales with variance the second thing it scales with is v double prime right but recall that v double prime the second derivative of the pool value that's the same as the first derivative of the uh of the demand function now what is the first derivative of this demand function telling you it's telling you as i go from price from p to let's say p plus delta p this is how much of that asset the pool will trade in other words this is the marginal liquidity that is locally available instantaneously at that price right if you know again instance for an instantaneous price change this is how much liquidity is is available there right so it's the product of the variance of the risky asset and the amount of liquidity that is available at the then current um price level um there's a more direct adverse selection interpretation again from the way i've set it up it should be obvious that this cost is adverse selection in the sense that i have one trading strategy which um trades against arbitragers i have another trading strategy which does the same thing but on an exchange if one makes more money than the other obviously the money has gone to the arbitragers but you can do the calculation um a little bit more directly uh as well you can say look if the the price was um uh um let's say p and then the price moved to uh to be um uh p minus uh delta p then you know the pool would move from here to here the average price the arbitragers would get is that the price on the exchange is p minus delta p which is that so kind of this is the area of this triangle between a b star and b is the loss to the arbitragers and which you sort of do the math and it's you know it's the thing that we talked about you directly get the um the instantaneous variance times the the local liquidity so the details of this aren't important but there's just a more direct calculation to show the uh the same thing um so let me do it for the constant product market maker right so for the constant product on market maker again x y equals l we um solved before for the pool value function now all i do is i take two derivatives and i plug it into the lever formula i get this and one thing that you'll observe is if i compare the instantaneous lever with the pool value you'll observe that this is a multiple of that and what is the coefficient sigma squared over eight that's where the sigma squared over eight came from in other words in the dt instant of time the amount you you lose is a fraction sigma squared over eight um dt times the uh the pool value and so for example if as i had in the beginning if the um the volatility is five percent a day the sigma squared over eight is going to be about three basis points for a day that's how much you're going to lose in terms of address selection costs okay so a couple of questions uh go ahead first yes yes that's right second question due to the nature of how the value is lost here it would seem that the pool would over time become less valuable and it would be something that could be easily observed if you calculate the current value of reports well it's not that the pool becomes less valuable it's that it's less valuable than an alternative right so the pool will never go to zero the pool always have money in it but the point is if you're doing rebalancing you would have more money pool mechanically can't go to zero right so um uh put aside the fees for a second i have to be on this curve how's it going to go to zero i'll always be somewhere on this curve right so the pool will always have some value it's just you would have more money if you traded on the uh uh the centralized if the pool investors had done the same trades but on the centralized exchanges but it was making four trades because basically that's what's happening is trading at non-market prices basically by making poor trades it's somehow losing money so why is it not reflected in some way but it's um losing money versus what right the rebalancing strategy may be systematically making money over time right and indeed you should expect it will because what the rebalancing strategy does is when prices go up it sells when prices go down it buys so there's kind of a volatility harvesting going on here that the pool does not get [Music] do all the assumptions i skipped over that a little bit um so one one sort of uh um you know frequently asked question if you will is is it reasonable to say that i have this external market right like that that's sort of a guiding assumption here so answer number one is for the most liquid pools like if you're really trading ethereum if you're trading bitcoin if you're trading like a top ten coin the answer is absolutely yes i showed you uh charts right far more trading on binance or ftx or whatever right but for the long tail no right i mean there's probably thousands of things that trade on uni-swap that don't trade on any exchange right so for the long tail um this is not a good assumption right but the argument i would make to you is it's you know it's the same way people use black shoals so here's an example people use black shoals to price um uh employee stock options at private companies right black trolls is based on dynamic hedging and no arbitrage and so on you cannot trade the stock of a private company right nevertheless you know it's useful it's a model it gives you a data point right it gives you consistent pricing at least right so it's something to do is it less relevant if there's no external market absolutely it's not as well microfounded right but i think it's still a model and it will still give you sort of consistent pricing again the same way people use um black scholes models in for example in real options theory in you know um uh environments where that where it's not and you can't really dynamically trade did promise that this is the black trolls model of ams after all any other questions okay um there's also uh an options pricing interpretation i'm just gonna uh skip that in just in in the interest of time um because i really want to show you the uh the empirical results so so so here's the main way we're going to use this as a predictive model let's you know get away from just looking at the reserves and look at the overall profit and loss of the uh the lp there's the first component which is the lp collected fees that we haven't looked at so far the second component is the change in pool value that we have looked at and if we write out the second expression with the lever theorem we get we get this quantity and again what i'll observe is this rebalancing p l this is market risk that could be hedged you could just take the negative of the rebalancing strategy and trade that on finance so if you're an lp and you hedge this red component you do those trades on finance you're hedged p l all you're left with is the fees and the other lever right then if you look at that what are the fees the fees are a proportion of volume right so gamma might be the proportion let's say 30 basis points so you get 30 basis points on whatever the total volume is up to time t what do you pay you pay this lever integral and what is in that there's a sigma square t in that this is a variance to volume swap there's two legs to the swap it's like it's like like an interest rate swap you know fixed to floating except here the first leg the leg that you're receiving you're receiving proportional to volume right what is the leg that you're paying you're paying the floating leg of a generalized variance swap this is a continuously sampled generalized variance swap generalized in the sense that i'm looking at the average realized variance over this period but i'm i'm sort of weighting it and it's sort of something it's proportional to some kind of weighted average right and of course these things these are things that we uh we know how to price and uh so on variance swaps are are commonly traded so let me just quickly show you the empirical results the thing we want to test is this expression we want to test does fees minus the lever cost the thing i promised you on slide two is that a good estimate of p l and the way i'm going to do that is i'm going to compute the hedged p and l two different ways first i'm gonna do it using my formula and the second way i'm gonna do it is i'm gonna use it using the actual data namely i'm gonna go to the ethereum blockchain i'm going to take one of these uniswap pools right i can see what all the trades are so i can see how much money that pool made i can also separately look you know on a daily basis at the end of the day how much of each of the risky asset did that pool and i'll do daily um um rebalancing as a hedge but i'll do that at binance prices you know centralized exchange prices so you know html i can compute it two different ways i can compute it using the formula but here if i compute it um the way i just described there's no model here this is just a p l calculation this is a trading strategy you could do you could put money in an lp and you could trade on binance to hedge this is absolutely implementable of course i'm ignoring costs and so on right but but the left side doesn't have a model so these two are close it means that the model over here is correct and so i did it for um a pool this is um the pool i did it for this is uh eth usdc so first thing i'm showing you is i'm just showing you the daily volatility and the first thing you observe this volatility is crazy right so you know the lowest volatility is two or three percent which would be very high volatility for a stock but you can see some days the daily volatility goes to uh like 15 right so not only is ethereum very volatile but the volatility is even volatile right and so you know again it's very important that we have a stochastic volatility model to uh um to price this if you look at how the investors in this pool did this is how they did over this um approximately a year period so this pool had like let's say on on the order of 200 million dollars in it in these coins and you can see the p l fluctuations at one point the pool was up 80 million dollars at another point it was down um uh 40 million dollars at the end you know it lost a bit and so on again wild fluctuations it turns out this is all market risk right this is just because this pool owns a lot of ethereum and you know ethereum price goes up and down a lot every day if you hedge that market risk what you get is those two curves red curve is um uh the um where i computed it daily without a model the green curve is where i use the sigma squared over eight lever formula and you can see that they're both really close and in fact if i throw away the blue curve because it's messing up my scale and just focus on the the two other curves you can see that cumulatively they stay very close and the cumulative difference i plotted as the black curve you can see it's basically oscillating around zero it appears stationary so my model seems pretty correct in terms of um i'm being able to use that closed form formula to predict how much money an lp would make if they hedge their markets right um and just to sort of highlight you know that this is useful if i just look at the blue curve you know it looks bad you know if you compute the returns it lost 12 percent negative sharp ratio right if i look at um hedging right what we see is that if i even if i just hedge daily all of a sudden i have a positive return and and not a bad sharp ratio ratio of almost four if i use the lever formula which is amounts to hedging continuously which obviously you can't do in the real world nevertheless it's a mental exercise the return is about the same but the the sharp ratio is very very high because again now we're hedging more often it's less risky sharp ratio goes up question how about the cost of shorting the cryptocurrency is that something yeah so that probably is much bigger than this because everything in the crypto world is uh is expensive so do i is this necessarily a money-making strategy no maybe because of trading costs and financing costs however the way i would view this is if you um can hedge very cheaply for example if you're long ethereum anyway because you like ethereum and you want to be long what this suggests is if you hedge versus yourself by instead of just holding ethereum maybe sticking it in one of these pools you can access a very high sharp ratio but you know um you know maybe low return stream of piano but anyway i don't really want to make the argument of whether this is a good investment or not i don't know all i'm saying is my tool is the right tool to answer that question all right um i'm a couple minutes over um just want to mention a couple of things there's a bunch of directions where this can be used to actually improve the amms and um the idea here is for example lever is bad right so again lever is a cost being paid to intermediaries we don't we would like to trade without these intermediaries right so if you can think of ways of reducing this cost that um is is a great idea and then there's a number of things one thing might be let's not use this uh this constant product formula or whatever let's maybe use something called an oracle an oracle is like a data source which would take prices from an exchange like binance inject them onto the blockchain right so now your smart contract maybe can leverage those prices and incorporate those external prices so it's not trading at off market prices and getting ripped off another strategy which i think is is quite clever and this was uh um actually i should give credit to um the people jump crypto they uh they suggested uh um uh this is basically why not sell the arbitrage rights and you can do it like this you can have a white list where you have certain authorized participants and they're allowed to trade against the pool but they pay no fees right so my model i assume the arbs don't pay fees but in the real world the arps pay fees but you could simply give some arbs permission to trade without fees and that would give them priority because they could sort of take advantage of smaller price discrepancies and still make money why would you give them this because you would ask them to give some of their profit back to the lps right so again i don't want to advocate for any of these in particular but the thing i want to highlight is the source of inefficiency here is bad prices we've quantified it and you know immediately it leads to suggestions for how we can mitigate how bad those prices are in order to lose less money to the arbs so that um both our lps and the uh the the noise traders two types of people we want to help are are better off so i went a little bit over time i will stop here happy to answer any questions can you take uh your a kind of just put it into those exchanges kind of like teach your amm to automatically trade on finance to kind of be its own garbage well i mean so the question is can can we have the amm ex directly trade on binance so i mean it depends how you define that if you take the narrow view the amm is a computer program that executes on the ethereum virtual machine and you know that's not where binance is so it can't however these amms are typically run by teams right so what the team could do is the team could implement the software so that the amm runs but the team separately runs its own bot to do the arbitrage and that's that's actually sort of basically this idea which is basically run your own bot or have someone else run a bot if you're too lazy and just have them give you some of the money yeah one of the questions i get is uh i mean i don't know uh i i study market mechanisms uh um you know that's the thing i'm interested in um i do think there is promise in these mechanisms but i don't know like crypto overall is the price going up going down i don't know if i knew that i wouldn't be here i would be on my private island and finally why is it better to make a rebalance strategy in the spots market um i'm not sure i understand the question either okay i mean the thing i'm calling the rebalancing strategy just negative of the hedge and that you imagine happening and do you know anything about shorting oh oh so there's a question can you short yeah so absolutely you can short so um in fact you can short multiple ways um on on so the better place to do all this stuff is on the offshore exchanges like binance or ftx but um they have margin trading so you can short and borrow on margin but actually more liquid than that are perpetual futures so there's futures instruments which are i think actually the main source of price discovery in crypto at least for the big points um the most liquidity and you can clearly short futures so so the uh can you can you implement this on a major coin absolutely yes but as you pointed out sasha um there's funding costs for a short and if this strategy is making seven percent i don't know what the funding costs are but i could easily imagine them being 20 i don't know right things are doing any anything with leverage or borrowing or whatever is usually extremely expensive in crypto because you know there's no credit question in the back i kind of miss what you were saying again but it seemed like you were saying something that uh your long volume but short volatility yeah so why doesn't the strategy blow up because it turns out volume and volatility are highly correlated okay right so you kind of don't see this this is actually another point that i think is interesting but i just didn't mention here the fact that this thing is going up means that there's very volatile days but also as you can imagine on a volatile day there's more trading right so these two are somehow magically lining up so that you know this thing makes money right so i think that's another interesting fact um uh um that i didn't sort of quite explore here but you know they end up being very very highly coordinated in the crypto space so um uh i'm sort of so i don't know so one one problem with rfq type um protocols is uh if you can't do it atomically right so if you have an rfq um you're gonna um declare like i wanna buy x and then you have to wait for people to uh sort of respond right so that breaks you can't do that inside a smart contract right so so so that's a sort of a one issue now um uh um i'm not aware of uh um uh i mean there probably are i'm not aware of direct ones but one sort of indirect thing a lot of people talk about is something called just in time liquidity which is kind of like an rfq the idea of just in time liquidity is um one one detail that i haven't mentioned is when you put an order into one of these pools before the order gets into the blockchain it sits somewhere called a mempool right which is basically trent like you know little computer programs that people want to run on the blockchain but that haven't run yet so and and these are publicly observable so one phenomenon that people say as it came to rfq is if i see someone put in a big order to buy something and it's sitting in this mempool i can try to front run and add liquidity and jump in front of them to trade with them right because i think i want to i want to trade with them this looks like a juicy order right so this idea of front running and providing just-in-time liquidity that style of front running some people say is like a little bit of a janky rfq mechanism in the sense that people see your order and they can sort of directly insert themselves to trade with it but um rfq um protocols broadly i mean i don't know what happens otc but um my understanding is probably otc they might be popular i don't know yeah questions to do or i mean i think i mean yeah i mean i i think uh um i think it opens up an avenue like i don't know if it's the case for this pool per se but i think if you want to think about making markets the way i would think about making markets is you want to hedge your market risk and i think that's the way traditional market makers operate right if you look at uh you know citadel securities are they going long stocks absolutely not they hold things for very short periods and then they dump it right here the passive model is you're just sort of fundamentally wrong oh sorry long right and so so my view is if you're sort of viewing that more as market making and you don't want to be naturally long you should hedge it and then i think there are open questions about you know how to hedge it you had your daily issues you had you're just on big price movements you know so on but yeah i think lp should hedge yeah i would say more of a speculative question but uh so the way to present as a model you can assume that if we had more stable points so something that has much less volatility the whole liquidity pulse would work much better and to generate better returns so what that means that if for example we had liquidity pools for stable point something like usd and similar for euro for example okay more efficient so so good so there are um there are these pools for stable coins also um so you're right in the sense that this cost is less the volatility is less so if it goes from five percent to point one percent this will be a lot less but what happens is this will be less two so like a risky asset like let's say unit swap b2 charges 30 basis points right like the i think the biggest pool for stable coins is something called curve i don't know what they charge but i think it's single-digit basis points right so that sort of i mean people realize that and so that gets equilibrated here you just charge less because your costs are less all right i think that's one more okay last one just uh curious why is this mechanism so closely can we apply that too so in in in some sense it's closely tied to the crypto world because of the two reasons um i talked about at the beginning um so one is in the crypto world you have very slow computers namely the blockchain the second in the crypto world you have all these crazy coins that you know anybody could come up with a coin right in in in regulated markets that ends up being less important like we have lots of fast computers right and um uh you know you can't list the random security right there's a whole process of going public and you know so on right so you don't really have as much of the long tail so that said i do think um this has some advantages versus limit order books and the primary thing is in in limit order books are very complicated to use right if you're a market maker you basically have to be a high frequency trader you have to hire an army of phds right even if you're just a trader like i know a lot about market microstructure it's my job right the five times a year i personally trade a stock you know what i do i put a market order on close i trade at an auction i don't trade in a limit order book because the limit order book is all these high frequency traders trading against each other like a human can't compete there right and so what institutional investors do is when they want to trade on the limit order book they use algorithms too right so you have market makers with their algorithms you have the institutional traders with with their algorithms through banks and brokers and so in some sense that's a level trading field in another sense the nice thing about amms is they're simple enough that you don't need to do that right and you don't need these high frequency traders and stuff so you know do i think an amm is superior to uh um a limit order book for um you know trading on a centralized exchange probably not right but i do think there's room for better structures where you you know um it benefits participants who aren't as significant uh sorry sophisticated right so someone could provide liquidity without you know hiring an army of phds or could buy a block of stock without um uh you know using an algorithm and so on and i think amms are a little bit of a step in that direction okay i think that's a great one thank you so much 