okay so it looks like the the recording has started so we're officially starting now um so uh welcome uh to everybody we're doing our second webinar a fully online version of the cornell city financial data science webinar and so this is the second time we're fully online and you know as as we all know at this point there's some pros and some cons to be fully online the cons are we don't have any snacks to offer and no dinners for rama and francesco although we definitely owe him one we all we owe both of them one so we're we're excited about the the this version of the seminar because it it allows us to you know go international and have access to some really uh great researchers who otherwise uh may not be you may not be exposed to so um so i'm really excited to have uh ramacant and francesco capone um they've uh so i've known rama for quite a while now more than a decade we were colleagues at colombia and uh sort of uh at the time we came across some interesting data sets on limit order books that sort of intrigued us and we took a hack at it we wrote a few papers we did some order book simulations we looked at statistics and you know the relation between market depth price impact order flow and we sort of started uh you know on these topics that um that we're both still passionate about and but now we've we've each gone on our sides of the world um rama is now in in oxford and uh his student francesco capone uh was uh is now in london so he um he works at blackrock and um essentially i'm very excited to have uh both of both of them present today so without further ado their topic is cross-impact in equity markets yeah thank you very much sasha thank you for inviting us to present in the seminar so i would have loved to be there in person but maybe next time so uh yes as sasha explained this uh work goes back to something we did together with sasha and with arsenic kukanov who is somewhere in the audience hi arseni and so the topic of this work is the concept known as cross-impact and we investigate uh uh this concept by looking by doing a detailed analysis of um order flow and price data from equity markets so let me go into the topic without delay so um so i guess most of you are familiar with the concept of market impact so market impact is the idea that the execution of trades may move the price uh of an asset in the market and thus contribute to the cost of execution if you send a large buy order you probably notice that this may move the price up and so you end up paying more than if you had not move off the price so this phenomenon known as market impact has focused a lot of attention because it contributes to execution cost and uh if you look up any reference on transaction cost analysis there is a lot of effort devoted to quantifying and managing market impact and the huge literature on optimal trade execution whose focus is the optimization of trade-off between volatility and impact so empirical studies on market impact show that not not surprisingly i mean this is in line with economics 101 uh price movements are driven by aggregate imbalance between supply and demand if they're more buyers and sellers the price is driven up if they're more sellers than buyers the price has driven down so you you can formalize this by defining the notion of order flow imbalance so you look at uh the the by volume minus the cell volume or if you are in a centralized order book situation on exchange you can look at the net order flow at the top of the order book and this concept of order flow imbalance is very useful for building impact models because you can show empirically that uh the returns of uh of an asset in a in a in a centralized order book market are uh well described by a linear impact of the order flow imbalance this is something we explored in detail with uh with sasha and arsene kukanov oh sorry i put 2020 that's actually 2014. so uh but there are there are lots of other studies we look at it we looked at it in equity markets there are other studies in other asset classes so this is basically confirming that what we know from economics 101 that aggregate imbalance between supply and demand is what drives the price okay now so uh from a quantitative perspective it means that well there is this uh approximately linear relation to a very good approximation between the return and order flow imbalance and so you can think of it as a regression model and if you do this regression well the coefficient in the regression which i call here the beta is uh is what people called impact coefficient so a high impact coefficient means a small imbalance can create a large moment price a low impact coefficient means the opposite so it's the it's uh the opposite notion of liquidity and uh you know what one of the interesting things we showed in our studies that if you do this regression then again to a very good accuracy the coefficient you find here is the inverse of the order book depth so probably can i interrupt you one second um are you on the second slide or third slide because we we only see the uh the first slide oh you're on the title side still yes we are in the title slide oh oh that's not good um oh sorry something to share so i don't know what's going on here stop share let me share again okay do you see it now oh yeah now we see that you so you're on the second slide yeah yeah okay sorry so anyway i was just saying what imbalances and what market impact is so you you can translate these ideas into a linear model of of market impact which is what we did with russia and arsenii so this you can think of it as a regression model you try to explain the returns in terms of the imbalances of each stock and uh the you can interpret the regression coefficient here beta as a measure of market impact so high beta means a less liquid asset for which the same imbalance leads to a higher price movement and if you look at it quantitatively which we did you find that this coefficient is uh highly uh correlated with the order book depth or depth at the top of the book so you can interpret this coefficient as inverse of the or the book okay so these are well known and a lot of other studies confirming the same things in other markets and uh if you look at this equation well it's a linear equation so you you can also extract the impact coefficient which we call here the beta as in terms of the covariance of the return with the order flow imbalance that's another way to do the same thing when you do a regression it's just a covariance calculation basically so uh it means that if you have impact you will see positive of a correlation between the return and the um and the direction and the size of the order flow imbalance and that's what we see in all the examples of markets where this kind of empirical study has been done okay now um so this this study i mentioned was for single stocks so we looked at uh all single stocks in the test stack when we did this progression but most market participants are interested in portfolio transition portfolio trades or they simultaneously execute trades across many securities and so they have access to order flow imbalance and returns across multiple assets and they have looked at whether you know there's correlations across these variables across across different assets and it turns out that yes there is a positive correlation of order flow on one security with the returns of another security so if you take for example the order flow imbalance on apple and you look at the correlation with the returns of microsoft well typically you do find a positive correlation so that's uh so examples are shown here these are examples from nasdaq order book data so you look at for example the the return of apple over one minute intervals you look at the correlation with the order flow imbalance of of intel well you get a correlation of 40 percent it's uh opposite you look at the return of intel correlated with apple 35 34.6 percent so so you can see first of all it's it's it's positive uh they're not small and it's not symmetric uh correlation of return of google with order flow balance of amazon 31 uh the opposite uh the other way around it's 19 so what we see if you do these calculations for randomly chosen pairs you'll typically see positive correlations of the return of one asset with the order flow imbalance of another asset and they're not symmetric uh in general okay so this uh this is interesting is this can you extract information from from this well this observation that price movements in one asset may have non-zero correlation and actually you have nonzero correlation with order flow in other assets has given rise to a concept that people call impact okay so cost impact simply refers to the observation that uh you know uh when the trades in one asset correlate with price moves in another asset okay now from this observation has grown a an idea which is uh slightly different is that well oh yeah we we see these correlations they must have some origin and and the origin is probably the fact that uh the price of a given asset is not influenced just by its own order flow but also by the order flow of other assets and so if uh if if we are in the context where we trade more than what security at a given time this may influence the price of other assets that we hold okay so this is the notion really that people referred to as cross impact and there have been a lot of uh theoretical and empirical studies on on this so empirical studies i'm not going to review all of them but you see a list there empirical studies have have documented this this correlation effect that i just mentioned here i showed you four examples but people have looked at this in equity markets in bond markets and so on and they generally see the same effect there's a positive correlation between uh the order flow of one asset and price moves another asset at least in the homogeneous asset class and then there are theoretical studies while people have tried to derive the consequences of such thing we say well if actually the order flow of one asset influences the price of another asset then we should account for that in optimal trade execution portfolio execution so on so there have been a stream of studies trying to extend what has been done for single asset optimal trade execution to multiple assets where the model includes such cross-impact effects okay so um what is the idea in these models well the idea in these models is that there is uh but there is um we observe this uh non-zero covariance terms which i uh which i showed you examples so the uh price movements in asset i are correlated with the order flow acid j so to model this uh they introduce um a market impact model in which order flow in any asset can influence the price of another asset through some coefficient which called the cross impact coefficient so as as you can imagine if you have like 500 stocks well this leads to uh well 500 square divided by two uh so a fairly large number of uh cross impact coefficients uh so tens of thousands of of crossing by coefficients that you need to estimate so from uh one coefficient uh in a single impact signal stock impact model you move to n coefficients per stock when n is the number of all other stocks that you trade plus eventually etfs and so on so uh this leads to uh non-parsimonious models and uh you know you have to estimate them and uh and see if the coefficient is stable or not so that's a non-trivial problem and uh so that's in the vertical studies and in the theoretical studies well the authors assume that this they need this full matrix but without necessarily analyzing why these the effects might arise uh what leads to the specifics so the uh these these studies assume there is such a thing as a cross impact and then they try to optimize the execution strategies taking into account such coefficients okay now so the questions we're going to ask here is that first of all you know the notion of cross impact the first time i heard of it it really sounded fishy to me so for those of you who have studied the physics you know this sounds like action at the distance you know in the old days when the newton introduced his theory of gram of gravitation well it was really not accepted in the beginning because people said well what are you trying to tell us i mean you're trying to tell us that if you have a planet here and another planet there they're very far from each other somehow the the uh the first planet exerts an action at a distance on the other planet without any physical contact is that serious so so that's this notion of action at a distance uh was was criticized because uh you know people had have this idea that they there needs to be a mechanism uh which brings uh things into contact in some way there needs to be underlying mechanism which links a to b in order for a to affect b so to have a causal impact you need to have some link between the two objects so here well it's not hard to understand the single asset impact model that i showed you in the beginning because that's really the supply and demand for a good drives the price of that good more buyers will increase the price a little more more sellers will decrease the price that's really economics 101 but why would the uh the uh excess the demand for one asset impact the price of another asset well you also see this in economics you have what's called substitution effects for example if people decide to consume less less bread because they've they switch to you know something that is different like they switch to rice then of course the price of rice will go up and the price of bread will go down because they substitute one for another so it might be something like that um but we're going to look at data which is at the intraday level like seconds so it is not uh you know that's not the kind of thing that we're going to look at where you have substitution of assets that are on a large scale so pay pension funds shift from one asset to another so so the first question we're going to ask is is this real so what does it mean is this real well for quants the real means do we need it to explain some observable facts okay because we're not going to ask a philosophical question so the question we're going to ask quantitatively is that we have these effects these these these uh we have observed these these uh that there is a covariance um of the returns of some assets with the order of other assets would they have some magnitude do we need to introduce all these cross-impact coefficients and there are many of them to explain the correlations that we see and if yes do we really need a particular n by n matrix of price impact coefficients with non-zero off-diagonal elements which makes it a huge amount of coefficient handle to model market impact and observations of relations between order flow and prices in a market within assets or is there a more parsimonious approach for this okay so these are some of the questions we're going to ask and it's really these are these are questions that you would like to ask in when you design a multi-asset impact model because if you don't need those n squared coefficients you really don't want to have them okay so here is a summary of what i'm going to try to show you and and so in summary we're going to try to convince you that this notion of cross-impact is really not necessary to explain anything and uh the the observed co-variations of which i gave a few examples between price moves in one asset and and um and order flowing balance in other assets can simply be explained by simpler and more intuitive observation that is that overflowing balance across assets are correlated and why are they correlated well guess what because very few market participants just trade in one asset they typically trade their portfolio strategies which involve multiple assets this can be index strategies etfs strategies statistical arbitrary strategies such as pairs trading other cross-asset strategies which involve multiple assets so they typically generate correlated all the throws across assets and these correlations lead to correlations and the order flow imbalances and that's what's ex we will show that this quantitatively explains very accurately all the uh cross correlation effects we see between or order flow imbalance in some assets and the returns in other assets so that's a summary and now i'm going to go into more detail about so here is in one diagram what we what we we call a causal model for execution costs in a multi-asset framework so um so the basic i idea is that you need nothing more than the single asset impact model that i showed you on slide two so what drives the price of a stock or any other asset in fact is the order flow imbalance is the as a buy minus selling balance in that asset that's it that's it there's nothing else so the now what are the components of the order flow imbalance in this asset well you can think of two types of components there are there are entities algos or humans there's still some humans who trade stocks uh who will trade only stock i there are other algos which will only trade only stock j and these will contribute to what we would call the idiots idiosync democratic order flow for stock ir stock j these have nothing to do with what's going on in other stocks they look at some technical indicators for that stock or some value strategy for that stock and they don't really look at the other stocks but there are other market participants engaged in multi-asset trading strategies involving multiple assets indices other stocks and so on so these tribe strategies also generate orders for stockholm stock chain all the others and so they feed into the order floating balance and what we see what drives the price of the stock is just the aggregate order floating balance is the algebraic sum of all these bind cell orders and because there's this common component of order flow which is triggered by entities simultaneously trading in inj well this leads to correlations across the order flow and in in particular the overflow imbalance of stocks inj therefore you will see correlations in the returns of stock in stock j if the the relation between and if the relation between the the return and the order flow impedance is linear as we assumed in the in the beginning then the correlations between the returns should should closely reflect the correlations between the order flow imbalances and you you should need nothing more to explain all this thing on the other hand the the cross impact model is different because the cross impact model involves drawing uh inserting in this in this in this diagram an arrow which would potentially uh go from this uh this pink box here the order flow of stock j directly to uh the the return of stock i or for the in from the the imbalance of stock j directly to the return stock i and so you would have in in the cross impact model you will have a you have oblique arrows in this diagram whereas in this in the diagram they're showing you right now they're only vertical arrows only the order flow of each stock influences the return of that stock so this is a very traditional view of things there's nothing really revolutionary a supply and demand drive price for each asset and they're people who trade the assets simultaneously so they create correlation in the order flowing balance whereas the cross impact model requires you to accept this action at the distance thing where i trade stock eye and suddenly this moves structures through some mechanism that is unspecified so so we can so the thing is that we can test which one of these two assumptions is true because we have data on order flow we have data on on the return so we can actually check which one of these assumptions is more plausible by conditioning on the variables in this diagram and performing conditional regressions and that's what francesco will show you in a few minutes but before that let me comment on uh the construction the very construction of these uh impact the models for multiple assets and the inherent identification problem that arises from them so how how are these how are these impact promotes specified for multiple assets so it's really a a multi-dimensional version of the equation i showed you in the beginning so you had that for one stock the return is a a linear function of uh nf function of the order flow imbalance and you say well okay i have n stocks now everything is a vector i pile up the returns in a perspective size n and order flow imbalance also i have n of them and now i allow any variable in the order flow imbalance vector to influence any other variable in the returns that means i will have a matrix of coefficients where theta i i on the diagonal is the impact of stocks order flow on its own return and the off diagonal terms beta ij will be the impact of the order flow of j on the return of i and and there is nothing to suggest that this matrix has to be symmetric in fact we saw that you know there's seem to be asymmetric effects so why why not allow it to be completely arbitrary fine so that's the sorry to interrupt you but there's a question i was going to leave them all for the end but there's one that's relevant is uh jinping she is asking how is ofi calculated yes i will come back to this in a few minutes but so ofi is the net order flow for stock i uh which can be defined in many ways so so the way we're gonna define it here we're going to look at the or order book we're going to look at the best bid and the best ask you okay so the uh and we're going to it's a flow variable so we're going to look at every time interval so say one second or one minute we're going to look at a time interval and we're going to look at all the buy orders that come in new by orders minus all the cancellations of buy orders and minus the execution so that's the inflow to the bid queue and then the same thing for the ask you we're going to look at all the sell orders that come in uh minus all the sellers that get cancelled executed and then i'm gonna do bid inflow so buy increase in buy orders minus increase in sell orders so that's gonna define the order flow imbalance you can think of it as net by minus cell volume okay but um but we're going to define it more precisely in a few slides sorry so uh okay so here is uh is the model for end stocks and now well we have a a linear a linear model uh with uh with with two two variables here on one side the returns and on the other side the the ofi the order flow in balance so so we can look at a few uh look at the the covariance matrices of these things so we have the covariance matrix of the returns we call it c we have the matrix of the order flow imbalances we call it k and then the quantities which i showed you in the beginning these are the covariances of the returns with the order flow imbalances and you can calculate this in the linear model because if if the return is beta times order flow imbalance then the covariance of the returns with the order flow imbalance suggests the beta matrix times the covariance matrix of the of the order flow immense variable okay and this matrix is what you observe when you do the covariance calculation between the uh order flow one guy and the return of the other guy you observe the elements of this titrates m which is just painted times k now and now when you read a lot of discussions on cross impact they observe the matrix m and they use the fact that m has off diagonal elements to imply that somehow you need to have off-diagonal elements in beta well that is not exactly correct because you can see that here we have a matrix a product and if you know what a matrix product is and we we all know uh then you can see that there is no need to have off-diagonal elements in beta in order to get off-diagonal elements in it now i'm going to show you an example where you can see why this is the case so look let's look at a case with two assets so we have two assets each one has order flow imbalance and this is the and i allow for cross impact so here the cross impact models are later one two and beta two one so each order from balance is as allowed to influence the other variable the return of the other stock now in this model you can calculate everything easily so i assume the residuals here are independent so any cross-correlation can only come from the either the fact that the order flows are correlated or from the fact that you have a uh you have off diagonal elements in the beta matrix so if you allow for the general case where order flows can be correlated and you can have off-diagonal elements in the impact matrix then you get that the covariance of the returns with the order flows has this horrible expression it's horrible but it's very simple and so you can see that if you look at the off diagonal elements here in m well this is the covariance for example this see when the hand is on the can you see the cursor okay so here as you can see this is the covariance of the order flow of stock one with the um with the return of stock two and you can see that it's the com it's a combination of two terms one of them involves the cross impact matrix beta one two but the other one involves the correlation of order flows between one and two so this term can be nonzero and positive for two different reasons one reason is that there is correlation there's a positive correlation in the order flows of the two stocks but there is no cross impact or that there is no correlation and the order flows of the two stocks first term is zero but there is cross-impact or it can be both so you can see that just by looking at these correlations of the return of i with the order flow of j i cannot identify which is which because i have one observable and then i've two different uh parameters here at least and this is only for two stocks so these crosston back coefficients cannot be i identified just from the covariances of the returns with the order flows i need to know something about the correlation of order flows or i need to assume something about the correlation of order flow so it's very clear from this example let me show you an example with numbers in case you don't like the letters well here's an example where i have two stocks this is the and i look at two cases uh this is the first case i have no no correlation in the order flows okay but there is cross impact so every time i trade uh a one i affect the price of two and there's some crowdfast impact coefficient that is 0.3 smaller than the pr own impact coefficient so if you combine these two in the model it leads you to a uh a a covariance matrix for the um between the returns and other flows that is this one so it shows in particular that the return of stock 1 is correlated with the order flow of stock 2 at 30 percent quite high and uh case 2 same stocks but now we assume that the correlation in the order flows is 50 but there is no cross impact coefficient zero well it leads to exactly the same covariance matrix for uh the the the covariances of order flow with with the returns so exactly the same so if i only observe the covariance of if i only do a regression of the order flow on the returns across all stocks i observe this this matrix m this does not distinguish these two situations but they're very different one of them says you know you have to model the correlation and order flow across stocks that's the real thing the other one says you know you have to uh understand this cross-impact impacting and model that okay so this example clearly shows that simply observing a non-zero correlation between order flow of one asset and the return of another asset does not imply that you need a non-zero cross impact coefficient in the model and this is for two and if it's 500 then it means that it does not imply that you need those 25 000 coefficients so very easy to understand in in this example so in this example i i choose either the correlation in order for it to be zero or the cross impact to a zero extreme case but it doesn't have to be this extreme you can have both of them non-zero so here's another example low correlation and order flow high cross impact or low cross impact high correlation order flow lead to exactly the same outcome in terms of co-variances of order flow with the return so again you have this problem uh same correlation between order flow and the returns for any pair of stocks you want but the amplitudes of the cross impacts are different in the two cases so again you cannot infer the cross impact either the fact that it's non-zero it's small or big just from these covariances so you do need to be less less but lazy and look at the um uh information and the order flow uh then themselves and that's what we're gonna do so now i turn to francesco who is gonna tell you the real stuff so what actually the data tells us okay thank you ramen thank you sasha for inviting me um so now we look at some data we look at a limit order book for from nasdaq 100 stocks we have data for about two and a half years uh rama you need to show okay um so we have data for two and a half years and we filter out some stocks that don't that were not covered during the the period so we end up with a total of 67 stocks so if you can move to the next slide so um some definitions um so the returns is a standard mid price change then we have the order flowing balance which rama discussed before it's um just the net order flow so uh at the bid which is the limit buys minus the cancellation minus the market order market sell orders and the net order flow at the ask which is uh kind of the symmetric so the limit at the um at the ask minus the cancellation minus the market order um by market orders so the order flow imbalances uh is the um uh the volume of the bit minus the volume at the as defined below and it's it's a measure of um net demand basically um so in order to make things a bit more interpretable we follow and we redefined we scale the we normalize the returns by the volatility of the stock by the one-minute volatility we compute the daily volatility using realized volatility from anderson and we scale it to have one minute volatility and the ofi we scale it by the average volume which is the average volume of um during the one-minute bucket um corresponding to the same return um if you can move to the next slide please so this is um a very clear um graph that shows the distribution of the correlation coefficients of uh the ofis of two stocks or if i of stock i and stock j which is in blue in in blue and and the correlation of the return of i with the ofi of another stock j which is what rama discussed before which is the red one so uh we can clearly see from from here that the distributions are almost indistinguishable they are very very close to each other um and yeah i mean the the mean is about 0 25. um if you can move to the next slide um then this one actually shows in a better way because for the same for the same pair of stock i and j we plot the correlation of the order flow imbalances on the x-axis and the correlation of the return with the ofi of a different stock on the y-axis and we can see that for the vast majority of stock pairs the points are very very close to the 45 degree line which indicates uh equality and these uh is a strong suggestion that the correlation between the returns and of i which is which once again is uh the definition of cross-impact could simply be due to the correlation between um or different balances which is our main hypothesis sorry if there's a question in the chat which says what's a typical time interval used just for clarity these are all one minute data one minute or five one minute returns yes correct um can you move to the next slide so to test a bit more formally whether or not we need a multivariate market impact model we use two approaches i mean initially we just run a regression where the return of a stock is uh regressed against all the order flowing balance of um its own and all the other stocks all the remaining 66 stocks um [Music] and this uh hitmap below just show the coefficient the beta coefficients so that's the beta matrix that brahma was explaining and he asked the question do we actually need all these of diagonal elements in this huge matrix um here the off-diagonal elements are those in yellow which are very clearly close to zero and much much smaller than the diagonal elements which show the impact of a stock's own order flow imbalance on its own return if you move to the next slide then to be a bit more clear in terms of units i guess this one shows a bit better what the distribution is so the relative frequency distribution of the market impact coefficients from these regressions um the blue is the self-impact coefficient so-called so it's the impact of a stock's own order flowing balance on its own return and the red is the cross-impact coefficient which is the uh coefficient of another stocks um all other stocks basically uh ofi on stocks a stock stocks return so we can see that the mean of the self-impact coefficients mean the scale is uh completely different the marketing the self-impact coefficient has a mean of uh 2.64 whilst all the crossing by coefficients are again as i said before very very close to zero uh there are 0.03 mean um and particularly there are also some coefficients which are negative which kind of contradicts um most of the assumption on cross impact which assume a positive correlation between order flow and returns so this means that even if they are even if they were identifiable then actually very very tiny uh only about one percent of total total impact um if you can move to the next slide so i mean this is not just the first the first approach so a direct regression but as we explained before and as rama explained in the causal graph uh this approach um doesn't take into consideration the fact that uh stocks are traded in uh portfolios in baskets for many different reasons and that taking not taking the commonality of all the flows into account click clearly creates a identification problem so we propose a different way to identify how significant these cross-impact coefficients are and what are the main drivers of execution costs so um what we do is a pca on the correlation matrices of returns and no fi um we uh propose a factor model for the order flowing balance and we use this first principle component of i to then test what are what is the remaining significance of any crossing but coefficient um if you can move to the next slide please so this this table shows the um pca of returns and order flowing balance again uh one minute um the sho it shows the eigenvalue the uh of the first three eigenvalues just for simplicity uh the the valence explained by each eigenvalue and the cumulative variance of the of of the eigenvalues so for the returns we can see that the first eigenvalue is 21 which explains 32 percent of the variation of returns of one minutes returns uh the second uh this is actually a bit larger than previous studies so there was a one of the major studies in the qspca for returns and refi was by haasbrook and sepp in 2001 and they showed they found a first principal component explaining about 20 21 in returns the second principle component is much much smaller and explains 2.5 percent approximately and the third component is just over two percent um so the three first principle component uh roughly explain 37 percent of the variation in returns uh if we move to the order flowing balance um then the first principal component is a bit smaller is 19 but it's uh so it explains 29 which is actually quite similar to returns a bit lower but on the same uh ballpark let's say the second principal component is just under two percent and the third is again one point eight percent so the total the three principal components of of i explain a bit less than than for returns but we are on the same scale so we we suggest um using a one factor model for order flow imbalance where the order flow is um regressed against uh the first principal component of wifi and basically the eta which is the um the residual of this regression we interpret this as the idiosyncratic component of order flow which is what was on the top of if you remember the causal diagram so in order to disentangle the basically the contribution of uh the idiosyncratic contribution of of a stock's own order flow from the common component due to cross trading we use this approach where we take out the first principal component and we interpret the eta the residual from this regression as the idiosyncratic order flow due only to to action in that stock um if you can move to the next slide please so this shows actually the um correlation matrices of uh returns and ofi um and the first principle component so the first principle component are normally related to the overall market movement so in this uh so these two matrices show so on top is the correlation matrix of return returns and the on the bottom is the correlation matrix of order flowing balances so the rqq is the returns standardize of qqq which is an etf that tracks the nasdaq 100 so it should be the one that is closer to what we use in our data set our spy is uh the returns on the spy index which tracks the s p 500 and f 1 r is the principal component of return factor 1 of returns and similarly for rfi we have the order flow balance of the etf qqq of the etf spy and we wanted to see how uh closely related the first principal components are to the overall market movements so as you can see from the uh figures in in blue from the numbers in blue then the first principal component of returns has a correlation of 91 with the overall return on the etf that tracks the nasdaq 100 which is incredibly high and it's a bit lower for the spice 88 percent if we move to the correlation matrix on the bottom then no no sorry um so we can see that the first principal component of ofi has a correlation of 82 percent with the order flowing balance on the etf qqq which tracks the again the nasdaq 100 so we can see that the first principle components of both the returns and the ofi are really closely related to the overall market movements and moreover if you move to the next slide uh the two first principle components are actually very closely related to each other so overall movements in the returns the first principal component of returns is on the y-axis and the first principle component of order flowing balances is is on the x-axis um they have a correlation of 87 percent um we checked those the second component is is still quite high 56 but we focus on the on the on the first one so we can clearly see how the returns and orifi are driven by common components due to commonality in in in trading in this in this example um if you can move to the next slide so this kind of justifies um uh approach which is um once again a two-step approach uh where we want to kind of take out whatever is is due to commonality in order flow and enhance in returns so in the first step what we do is we regress a stock order flow imbalance as i explained before on the first principle component of ofi and the the residuals uh which are eta here uh just explain the ideological using creative parts of uh the order for imbalance of stock i which is not due to any other thing so it's not due to the common movement to common market movement in the second step what we do is we regress uh each stocks return on the first principal component of ofi to account for the commonality and all the idiosyncratic stocks idiosyncratic stocks order flowing balances so just to be clear we do regression number 10 for each stock i we have 67 so we have 67 etas which are the basically the contribution of each stocks or the flow imbalance without uh considering the commonality that exists between them so in this way we believe that the matrix phi in in equation 11 should better capture whatever is defined as cross impact compared to the the the um matrix beta that we had before because the beta that we had before didn't have the common factor of order flowing balance taken out so we could not distinguish between correlation in order to flow as rama explained and [Music] cross impact so if you move to the next slide so this is actually looks very very similar to the one that we have before but just because when it's zero it's zero so um it once again shows that the in this case the correct this is phi instead of beta it once again shows that the diagonal elements of of impact are much much larger than the off-diagonal elements and if you can move to the next slide um then um this one shows once again um so on the top we have the self impact coefficients which are in blue uh so these are the five ii and the cross impact coefficients and the phi ij and then we have the pc1 which are the on the bottom in green which are the gamma um so this is quite similar to what we had before um so it shows the one on the top it shows that the self-impact coefficient so a stock's own order flow imbalance is a major determinant of a stocks return uh but it also shows that the the green in the graph on the bottom histogram on the bottom shows that equally important is the commonality in order flow among stocks and once you take this into account these two are of the same order of magnitude and you can see that the red which is the cross impact is actually almost in is very very tiny and i'm not sure you can see from this but actually once you take the pc1 into account almost all of this cross impact coefficient change sign so most of them become negative which poses another question which is i mean first of all are these cross-impact coefficients even if they are identifiable let's say that you know once you remove the pc1 what's left is cross impact okay so this is the red one even if if even if you can estimate them uh are they first of all significantly both statistically and economically in terms of magnitude and the other question is are they stable over time i mean as rama explained there's been a lot of paper uh and built a model of optimal execution where they assume cross-impact huge models with a lot of um cross-impact coefficients but they rely on these coefficients being stable over time and if they're not then the interpretation is quite difficult and as well as they use um if you can move to the next slide please so in order to assess um whether these components are again statistically significant and economically significant i mean we've already seen that they're very very small so it could be ended there but anyway we more formally test um how much do cross input terms contribute to uh explain the the execution cost of returns in this case uh once you take the stocks on order flow already into account and the and the principal component into account so in regression uh so these are two nested models uh equation 12 is basically what we are saying is while the return uh no rumors so yeah so um so in question 12 what we're saying is that a stocks return as the original uh you know the first equation that rama showed you is determined primarily by a stocks idiosyncratic order flow and the principal component of or the commonality order flow across stocks in equation 13 is what uh equation 13 is what i showed you before with the heat map and with the um and with the other histogram it says that you not only need a stocks on order flow but also the remaining 66 order flow imbalances so these are nested models if you go to the next slide please so statistically we test and with the nav test actually we we cannot reject that they are not that they are zero so uh statistically they are significant all these costs in back term um economically in terms of magnitude you can see on the top the the r square the adjusted r square from the first regression where we just use the stock's order flowing balance and the pc one on the order flowing balance and on in the bottom there's the adjusted r square where we use all the other order flowing balances as well this is uh as you can see it's hardly distinguishable and the small graph in this in in the bottom shows the difference in r square between the two and on average by adding all these regression all these other order flow imbalances um to the regression just increases your r square by um 0 0.0 sorry 0.005 so percent on average um so even so the conclusion i guess is even even though the statistic is significant um by creating these huge models of and including uh blowing up your matrix of impact coefficient to an n by n matrix you almost don't gain anything uh in terms of explanatory power so we are in favor of more parsimonious way of modeling impact where uh if you go back to the slide before that we had before please so where we basically use regression 12 where you only need a stock's own order flowing balance and the what you need to model is the correlation of order flow imbalances that's that's all you need and you don't need all these other um cross impact coefficients if you can move to uh the one after this one yeah so as i mentioned before there was another final uh element which is uh believe very important and it is not only the economic significance of this crossing back term which we just saw it's i mean it's it's very small don't contribute almost anything to explanatory power but all but also their um stability over time so as i said uh so these multivariate impact models rely on the calibration of this matrix of crossing that coefficient and the stability over time and so this is very important and so if this sign change change sign so if this sorry if this cross-impact term turns change sign over time uh this can be very very problematic and as we see from as we saw from the regression we saw that once we took the order flow the pc one of the order for imbalances into account uh 80 of cross impact terms became negative so this adjusted they might be unstable so this kind of triggered us to look at the uh change over time so what we did is a as an analysis of uh subsample so we divided our two and a half years of of data into 30 monthly subsamples and for each of these subsamples we run the same two-step procedure that we did before so the pca analysis that we did before where we regressed the ofi on the principal component [Music] and then we regressed it against the pc one and all the other order flowing balances so if you go to the next slide so this is an example of what you get uh for both stocks looks very similar so this is apple on the top and on the bottom is costco um on the top you have the self impact coefficient so that's the coefficient of one stock order from balance on its own return and you can see it's positive and uh you know quite quite large magnitude as we already seen and it doesn't i mean it fluctuates over time but not that much so the shaded region are 99 confidence intervals on the bottom you see the crossing but coefficient which is the phi ij and you can see i mean we've already seen that they are very small but what you could see from this analysis is that they fluctuate um the one on the bottom it's if they fluctuate over time and they become positive and the negative and positive so you can see the confidence interval um all over so the sign could be anything and that's really something you don't want when you want to you know calibrate an n by n matrix and you know you calibrate it on coefficients that are changed continuously over time um so if you go to the next slide so uh unless you want to do do you want to do a conclusion remember yeah i mean we have our time is up so we have to conclude okay i guess uh so what uh what we tried to show you is that you know the phenomena which uh which people refer to when they um to justify these cross-impact models with uh with an impact matrix having off-diagonal elements is that there's positive covariation between the returns and the order flowing balance of different stocks but this phenomenon can be explained without actually introducing uh such high dimensional models with many coefficients and without even using the concept of impact simply by noting that all the flow imbalances across stocks are correlated and in fact what we showed through the analysis of this nasdaq or order book data is that a fairly simple model one factor model for order flow in imbalance where each the order flow imbalance of each stock has one common fact factor plus an idiosyncratic factor that's that goes already a long way in explaining the patterns that we observe in the cross-correlations of returns of no-fi across stocks as we showed you know you can go further you have a principal component analysis fairly easy to extend this to multiple factors but with a single factor we see that it's enough to explain the the magnitudes of these so-called cost impact terms without introducing more parameters into the model and then another important thing uh that uh that that was shown in francisco's size is that if you do insist on introducing these cross-impact parameters well then you really need to check that they're stable and the interpretation is is meaningful and when you try to check the stability you see that they're unstable over time and in particular the sine flux will fluctuate in a seemingly random manner from one month to the next so this makes them very difficult to really use in a practical setting so what we think is that it's more important to uh if you want to build them a multi-asset impact model which you probably all do because you know your trade portfolios what you need to focus on is building a model of common factors in order flow and this can be done in many ways a linear factor model as we showed already goes a long way you can do it with principal component answers of order flow and once you have a good model for the for the correlations across order flow across your assets then you can just deploy your single asset impact model which relates order flow in each asset to its own cr return and that's uh perfectly sufficient for explaining the amplitude of execution cost in portfolio execution you don't need any other ingredient that's what we wanted to show thank you all right thank you very much rama um there um we have a very complicated question by arsene which uh i'm i'm not sure if you guys uh yeah i can see it shall i read it uh yeah go ahead yeah so uh arsene is asking um to explain how you'll decide to limit your ofi decomposition to just one factor first idiosyncratic component because on the slide where we have the principal component analysis you see a fair amount of variance in the second and third factor that's true so it's not really concentrated in one factor yeah so uh you're perfectly right if i were an execution quant and my job were to do do this like you i would do this i would do multiple factor model and conceptually it's not more complicated than what we did you can do the you can use three factors and as you can see with three factors you explain ninety percent of variance and then you're fine so here we we we saw that with one common factor we explain a lot of the uh we we can explain the the magnitude of the correlations between the returns and order flows but their finer effects for example if we look at portfolios with long long or short then you you can explain those those finer effects with the uh higher factors you're perfectly right but if i may run um actually adding the second third factor actually didn't change to to answer answering questions for what we want to do here but uh because we only look at long positions okay so i wonder i have a question a bit about the applications of um you know these links between ofi and returns and you talked about an optimal execution problem uh with uh multiple assets so when when you're thinking about uh what kind of applications we could uh use your results to build upon it would you think that uh are we talking about optimal execution of of uh portfolios or about is it related to stat arb or co-integration or why why should one really uh go through the trouble of computing the order flow imbalance well i think one thing you want to do is you want to analyze your execution cost exposed even so i'm not even talking about optimal execution so you do portfolio execution and then expose you want to quantify your execution cost so every fund has some transaction cost analysis model in-house which they use to decompose uh basically their return into the gross return and and the execution costs so this execution cost is not directly observable you need to have a model to access that so this kind of model enables you to do that at portfolio level and what it tells you is that because of the commonality in order flow the execution cost of a portfolio is not equal to the sum of execution costs of each component looked at in isolation with the one single asset tca model but you need to look at the portfolio so that's what it says and the difference between these two is linked to the commonality here so if we're executing a buy order of every asset in the spy simultaneously we should expect to have an impact on the ofi of of spy yeah i mean think of the a simple viral don't even think about a tca the bid ask on a portfolio is not the sum of the bid asks on the components it's smaller because there's a portfolio effect and you know this model just quantifies that in a more general setting instead of instead of the bid ask it gives you an estimate of execution cost and obviously the the common com component plays a role in this oh we've got another uh question from swagato at chargi um would you have any thoughts on how cross impact can be incorporated into more prevalent square root or power law impact models to understand impact of trading portfolios well uh you know what we're saying basically here is that you don't need the concept of cross impact what you need is a good model for impact for single asset plus a good model for the common five factors in order flow across assets so you pick your favorite single asset impact model and then you you model the common factors in order flow and then you have your your multi-asset impact mode that's what we're saying uh and i guess finally we're going to end after this we have a question from jinping she who says have you tried so we're looking at uh equation 12. um and he says have you tried to use the first principal component from return in 12 in other words yeah so i guess here you're using the principal component of ofi um you know what's the difference if we use returns here well i mean first of all i mean we show that they're almost like a 90 correlation so and i mean we just actually wanted to follow our causal analysis to show that you actually need to model the commonality in order for imbalances to explain the returns so it's it's a different uh question and it's a different approach i think yeah but it's shown here it's shown here the the two are very correlated and the correlation is 87 percent so but if you put the return factor here then it's uh you know i mean you can correlate anything with anything but as francesco says it's we want to have a causal model where you have an interpretation for this equation in terms of a causes b so here uh what we say is that the order flow the common factor order flow influences the order flow of stock i which then drives the price of stock i that you can give it as a causal explanation if i tell you the return of stock j influence is the return of stock i well yeah maybe in a regression they do have a correlation but is is that a causal model we think that there's no causal model there it's just correlation okay rama and francesco thank you very much for this very inspiring talk um and uh so i hope you have a great night i know it's a little bit late in europe so uh we we give you uh the best the best wishes and uh and we'll follow up on things like sharing slides uh you know sharing videos and we'll we'll keep you posted uh on our email letter thank you and thank you very much for everybody's 