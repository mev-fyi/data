hello my name is Scott Bigelow and this is part two of what happens when a scammer runs a sweeper bot on your ethereum account in this talk I'd like to discuss recovery options using bundles to defeat sweeper Bots that are locking assets inside of your account by stealing all available gas if any of these concepts are unclear to you refer to part one of this video where we talk conceptually about what happens when a scammer gets access to your private key in this talk we will be discussing two new projects from Dark Forest an organization that I'm involved with that focuses on improving user Security in the ethereum space these two products are the Interceptor a browser-based extension similar to metamask and bokeh a web 3D app for conducting recoveries if you'll remember from part one the strategy involves using bundles of transactions that land at the same time to defeat a sweeper that is constantly removing eth from the account if we brought these transactions to the chain separately the sweeper would take this 0.1 eth before we were able to use that gas in the move nft transaction setting these transactions to ethereum as a bundle requires going through a non-standard ethereum service in this case we'll be using the flashbots relay which is able to bring multiple transactions to the chain at the exact same time in the past this has taken some amount of software development skill to create the bundle and also to send the bundle to the flashbots relay with a newly released Interceptor we have created a browser-based system that allows you to graphically create the set of transactions using standard browser-based apps and Bouquet converts the set of transactions into a bundle and delivers them to the flashbots relay before jumping into the demo let's quickly review the steps we're going to be taking to use Interceptor and bokeh to rescue assets on ethereum we will be installing the dark floors Interceptor browser add-on we'll enable simulation mode inside of that extension we will then configure the extension with the ethereum address of the compromised account and because this compromised account is going to require eth in order to interact with ethereum there is a special make me Rich button which gives you eth in simulation mode after that we can simply use ethereum as normal using the browser to construct the bundle of transactions that we want using the dapps that you are already familiar with then we will use the dark florist bokeh dap to convert this bundle from the Interceptor into a bundle that lands on ethereum using the flashbots relay one question I've received numerous times is whether this is going to work with other chains that are ethereum like such as BSC optimism or arbitrum and the answer is that no this currently only works with ethereum due to the availability of several important services that are only available on ethereum this is as of May 2023 when I am recording this video and I recommend reaching out to the flashbots Whitehead group if you have assets on other chains that you would like to recover flashbots white hats are a group of hackers that help recover assets but there are some considerations to make the rescue amount must be above a certain threshold to be eligible for recovery and there will be some modest but reasonable fees that will be taken out of the total rescue amount but this can be a great option to rescue assets that are stuck on non-etherium chains before reaching out to the flashbot's white hat group it's important to remember the type of assets that are available for Recovery these assets must still be in your account or must be coming into your account at a future date and the only reason you can't access them is because you cannot pay for gas due to a sweeper if assets have already been transferred to another account there is no way to recover them and anybody who claims otherwise is scamming you and you should stop talking to them immediately let's go ahead and proceed with a demo here we have the dark florist Interceptor link it is available as a dark dot florist that is the website if we come here we see there are two download links one for Firefox one for Chrome we're running Firefox we'll go ahead and click that okay now we just have a couple more confirmations continue add okay now we have the Dark Forest Interceptor installed as a button on our toolbar here so we've done step one we've installed the Interceptor we need to make sure it is in simulating mode and then we need to add the ethereum address that we will be using for this demo in this case this is the compromised ethereum account that has assets inside of it and a sweeper bot running the account we'll be using for this demonstration is this one here you can remember it as 0x CBC this is an account that I own that has several assets stuck inside of them one is an erc20 one is an nft and it has a sweeper bot running on it so we just need to take this address copied it here come over to the interceptor Click Change here this is where the account is you can see that vitalik is the default account that is used in the Interceptor so we'll say change add new address this is just a label for future reference and we'll say create and switch so now this compromised address has been added to the Interceptor you'll notice that we did not use the private key here everything we are doing in the Interceptor is read only and does not require the private key to use this account in ethereum for read-only Access next on our list is make me Rich this is an option on the Interceptor you can see it here which will give the active account a lot of if to play with in this simulation mode but before we click this button let's first see what it looks like to try to interact with ethereum without clicking the button so come over here to you in a swap we will launch the app if you remember from looking at etherscan one of the tokens we had was weth let's say we want to convert that width back into if we got to connect of course so we'll say browser wallet this is uniswap asking for access to read just the address of our account we'll say yes you know swap can know the address of the compromised account we'll say yes Max when we click unwrap we're going to get a confirmation dialog here from the Interceptor that has an error here about insufficient sender balance what this means is that there isn't enough even in simulation mode to pay for this transaction so this cannot this cannot execute successfully so if you see this error what you need to do is go and say make me rich instead of having zero eth here we're actually pretending that this account has a 200 000 eighth this is a feature of the Interceptor that allows it to have some amount of eth that's going to allow us to work in simulation mode on an account that has zero if in mainnet so now we can see the same transaction does has no longer has errors because there is some gas to pay for this in simulation mode in fact when we click simulate swap we're going to see that we no longer have a weft balance here because this transaction has happened in our Fork of ethereum that is running inside of the Interceptor but if we go over here to etherscan looking at this exact account address and refresh nothing's actually happened this is all happening locally in our Interceptor and what we're doing here is we're beginning to build up a bundle of transactions that do what we want it to do however converting width into eth isn't really what we want to be doing in order to rescue our assets we really want to be moving these assets into a new safe location now we can use any compatible damp to do this but dark florist has also created several lightweight token moving applications that work very well with the interceptor so let's go ahead and wipe out this simulation stack we can go ahead and say kill this we're going to leave make me Rich so the only thing happening right now is that this account has 200 000 Ethan simulation let's go back to the dark florist website click on products the product that I want to use here is called lunaria this is a very simple token sending application and just like uniswap needs access to the account address lunaria needs us as well we're not giving access to any assets in the account only to the address itself say Grant access connect the asset we had in question was weth say yes the amount we had was 0.06 and this is the address that I would like to recover these assets to this is different from this CBC address and this one does not have a compromised private key or a sweeper running on it and is a safe location to move these assets to so I will click Send so the Interceptor has popped up the confirmation dialog for this simulation mode and it's overviewing what would happen if we were to stimulate this and it's recognizing that 0.06 width is moving from this account to this account this looks good got to make sure this address is correct we can see there is a small gas fee for doing this again in simulation so I'll say simulate weft transfer now we see it showing up here we see that there is another item on the simulation stack in the Interceptor we've been playing around in the simulation mode for for quite a while now but we don't want to rescue our assets in simulation we want to rescue our assets on mainnet we want to move them permanently to their new location to an address that does not have a compromised private key to do that we are going to be using the product mentioned earlier in this video Bouquet I'm going to open this up in a new tab and bokeh's job is to take this simulation stack that is living inside of the Interceptor and convert it into a bundle to be delivered to flashbots to land on chain all at the same time so we're going to click connect wallet we'll bring up the confirmation dialog to share the address with bouquet just like we did with the other dapps we were interacting with and Bouquet has already read the transactions out of the simulation stack and put them here inside of the DAP just like the simulation stack here there are two transactions the first one is funding this entire bundle right this is the representation of that 200 000 eth that was done here from make me Rich but bouquet knows how to change that into a much more targeted funding amount that is easier to pay for and the second transaction here is the actual movement of weth that we did using lunaria if we click here to code transactions from etherscan this is not a required step this just helps visualize what the transaction does by printing a user readable name for the function call so we click on that we can see here we want to transfer to this address this is our rescue address the one that is safe from the private keeping compromised this is the ethereum representation of 0.06 with if you remember when we set up the account in the Interceptor we never gave it the private key the Interceptor does not sign transactions for us that needs to be done separately and in this case it is done inside of the DAP the DAP here requires the private key for the compromised account it's worth mentioning that this is an extremely dangerous thing that you should not be taking lightly giving private Keys away to dapps you should make sure that you trust the source trust the person telling you to do this this is a very unusual thing to do and the only reason that we're doing this is because this is a last-ditch effort to recover these assets and normally working with a white hat performing the same style of recovery you would need to give them the private key in order for them to help you with recovery so it's very important that you trust who is telling you to give away private keys in this way and only do this for assets that are already lost never give away private keys for accounts that are not compromised in order to provide this private key here for the compromised account see it gives us the the address here we'll need to go into metamask this is a completely separate browser profile that has metamask loaded in it and we can see I have this compromised account here so I'm just going to export the private key we go to Account Details export private key again it's giving us a very serious warning about what we're doing here and I don't want you to take this warning lightly I want to make sure that you trust where you're getting this information from and do not make it a common Habit to give away your private keys to anybody who asks for them on YouTube so here we go I'm going to type in so here I have the private key I'm copying this coming back over to bouquet I'm going to paste it so that checked out so it's checked that this is the correct private key for this so now bouquet is going to be able to create this transaction for us but we're still going to need to provide eth in this funding transaction bouquet accomplishes this by creating its own accounts and asking you to pay this account a small amount of funds just for gas this is not a an account controlled by dark floors this is something that lives exclusively in the browser and by paying this account on mainnet you are creating an account that is going to fund this transaction getting on chain so I'm going to grab this you can see here that I already have a small balance here because I had done this before in a previous demo so you can reuse these for multiple multiple bundles landing on chain but you can see that this is actually not quite enough that it's going to need at least 0.004 and I only have 0.002 so I'm going to come to metamask I'm going to select a different account that has funds in it I'm going to say send I'm pasting in the address that bouquet has asked me to deposit funds into and this should be a very very small amount this is just gas that we are paying for so it said that it needed zero zero five and we have zero zero two you can overpay it a little bit if you'd like just so you don't have to make another transfer I'll just give it 0.004 I'll say next confirm okay so we have publicly paid this account this is not done in simulation this is currently broadcast to everyone this is the recovery account paying this account that bouquet has asked us to pay in order for bouquet to send this bundle to flashbots bouquet is recognized that the Wallet balance is now larger than the minimum required balance to send this bundle we can run simulate which is just a way to sort of check all the settings make sure all your transactions are good you have enough funding to pay for these transactions simulation has succeeded so we're going to hit submit the way that submitting the flashbots works it can take a little bit longer for these transactions to get included on chain it needs to try for multiple blocks in a row but I would expect this to happen within about 10 blocks we'll notice that this has happened because this Wallet balance will will drop suddenly okay there we go we now see an error here for funding while it has an insufficient balance here and we also see that this number here for the wall of bounds went from 0.006 down to 0.001 if we go look over at this etherscan tab for the compromised account this is 0xcbc so we see two transactions landed in the same block we see the funding account gave 0xcbc the compromised account a small amount of heat for gas which had turned around and used in the same block to interact with weft and in this case it was transferring these assets to the new safe location we could also see that we now have zero eighth balance again even though we had a small amount of if left over here and that is because the burner is still running and swiped it in this case it ended up taking a few dollars worth of of eth but we were still able to move this much larger sum of weth to the new safe location the process we use for rescuing weft is the same process used to rescue any erc20 token stuck in a compromised account the only difference is that when you are in lunaria instead of selecting weft you'll select whatever token you want although you might need to add the token address here in this custom token section now let's move on to nfts this account has a single nft that was purchased for the demonstration that we will be moving to a safe location while the burner is running moving nfts requires using a different dap than you would use for moving erc20 tokens Dark Forest has created another dap that focuses on moving nfts we will connect the Interceptor to nft Sender now we could go and find the contract address and the exact token ID of the nft once we want to transfer but nft sender also has a feature where it can parse a URL from openc so if we copy the address of our compromised account and go to openc we can paste the address here look at all of the tokens that are owned by this compromised account we'll click on the one that we want to rescue just copy the address here and come back to the nft sender and when we paste it in it breaks it apart into the correct contract address and token ID that we want to move and just as before we'll need to put in the rescue address come back to the address we used here before and copy this is the safe account does not have a sweeper running on it and we'll click Send here is our confirmation dialog for the nft we can say yes we are moving nft 3254 and so we'll say simulate this gets added to the stack just like the erc20 transfer for weth was added to the stack and from here we can go to bokeh and bring these two transactions to the chain at the same time to defeat the sweeper so let's go ahead and do that running through bokeh second time won't be much different from the first we'll go further quickly we still have the old transactions here from the first rescue that we did again if we decode these we can see that it's doing a transfer this is that 0.06 so we'll need to reset the transactions that the bokeh is operating on and re-import them from the Interceptor we can already see these look a little bit different but if we decode these from etherscan we can see this is using a completely different function and it references the token ID of the nft that we're trying to rescue it does not remember the private key between your session so we'll need to re-provide it paste it in the funny account has not changed but the amounts have gas prices have come down a little bit since the first time we ran this and so we only need to deposit a very small amount so I will go ahead and do that now pop over to the non-compromised account to send in a small amount to this address here I think we only need about 0.00 say three that should be plenty okay that confirmed and Bouquet has recognized that the Wallet balance is now greater than the required balance to conduct this recovery we'll go ahead and say simulate this bundle simulation succeeded meaning I tried these transactions and they all succeed on chain so we can say submit okay this is completed now we see funding while it has insufficient balance we also see that the Wallet balance has gone down significantly if we come over to our compromise accounts in etherscan and we look at the transactions here we see exactly what we wanted we see the bundle of transactions that conducted our recovery we see the funding account from bouquet transferring funds into this compromise account which are used in the exact same block to interact with the nft token contract if we look at the details of this we see that the token we wanted this 3254 nft was transferred from the compromise account to the safe account and we also see the burn that happened immediately after that burned all available eth left in the account and we are left with a zero balance on our address we also see that we no longer have any tokens here and if we look at the transfers that happened here and go over to the recovery account we now see that the recovery account has the weft that we transferred earlier and also has this nft that was transferred to it we were able to move assets that were stuck behind a burner by moving them to a new safe location using these bundles for our simulation stack we used lunaria and nft sender from dark florist because they are lightweight allow us to move tokens between accounts and are compatible with the Interceptor simulation mode but these are just standard ethereum depths that will work with any web3 browser extension it is possible to use other ethereum dapps with the Interceptor simulation mode such as airdrop or other reward claiming Taps but these sites must be created following best practices which not all daps do if make me rich in other transactions in the simulation stack are not being reflected in the DAP it is likely not a proper decentralized app as an example let's check out sushi this is not a properly decentralized app and we can tell because when we are in make me Rich mode where we should have 200 000 eth on our accounts Sushi does not recognize that Sushi thinks we have a zero and if we try to do anything in simulation mode we get an insufficient bout we can't even proceed to the confirmation dialog because Sushi is not actually asking ethereum how much eighth we have it is asking their own servers and their own servers are not a part of this Fork of ethereum that we are running to create the simulation stack similarly if we go to uniswap a site that is more properly decentralized we can see that there is a balance of 200 000 here because uniswap is asking ethereum what the balance of this account is and not going to a central server in order to look up these balances if you have access to recover on ethereum from a compromised account check out Interceptor and Bouquet a powerful set of tools for recovering compromised assets and nft sender and lunaria for quickly and easily transferring tokens and if you're interested in being part of the community run into any issues or have any questions reach out to us on Discord and Twitter and both links will be in the video description and most importantly if you are in need of recovery be extremely skeptical of anyone commenting on videos or reaching out to you on Discord offering support it is extremely common for scammers pretending to be part of trustworthy projects or to recommend Instagram or telegram rooms that are not legitimate and will just re-scam you out of more funds if your tokens have been lost due to a private key scam I'm sorry for your loss and I hope that one of these tools or videos might be able to help you recover what is Left Behind and thanks for watching and I'll see you in the next video 