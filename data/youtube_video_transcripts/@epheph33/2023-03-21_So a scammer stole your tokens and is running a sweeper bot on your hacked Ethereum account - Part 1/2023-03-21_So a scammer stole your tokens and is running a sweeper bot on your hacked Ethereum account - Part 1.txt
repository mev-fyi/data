hello my name is Scott Bigelow and today I'd like to talk about what happens when a scammer is running a sweeper bot against your ethereum account using a compromised private key in this talk I'd like to discuss how your interactions with ethereum have changed now that a scammer has access to your private key what a sweeper bot is and how to tell if your account or any other account has a sweeper butt on it using only etherscan then run a live demo of a sweeper bot against my own account on Gourley then discuss the strategy you can use to rescue any assets that remain in your sweeper bot compromised account and three solutions you can use to implement this rescue strategy let's first explore how ethereum Works without a private key compromise in place you have access to a private key or seed phrase which we are using interchangeably and that maps to an address on the ethereum network using this private key you can create a transaction and sign it and broadcast it to the network for inclusion you can do this over and over again using the exact same key creating more transactions against this account the same is true for accounts that have a compromised private key you still have a copy of the private key you can still sign transactions and you can still broadcast them to the network the problem is that the scammer can do so as well and when they do so it will be the transactions they want to sign which are normally going to be taking all of the available eth erc20 tokens and nfts but just because they are sending transactions to the network doesn't mean you can't as well you can continue to send transactions to the network in order to move assets around that have not been taken in this prior step the problem is that when they steal assets they are normally going to take all of the available if which is necessary for paying for transaction fees on the ethereum network after the initial theft has occurred they're going to transition to the next step of the scam which is running a sweeper bot against your private key and ethereum account this is going to be a bit of software that is going to run all the time and its entire job is to take any if that lands in your account and steal it and because you're no longer able to keep eth in your account you are no longer able to send transactions even though you actually have the private key to the account because you cannot afford to pay the network fees even if you transfer them in just a minute ago so a sweeper bot in this context is a bit of software that is running constantly using the private key of A compromised account every block it steals absolutely everything that it can and it does so extremely quickly and it uses a very high gas price to prevent any sort of delay in getting their transaction confirmed by running a sweeper bot they've effectively prevented you from accessing your account and sending transactions even though you have the private key there are many types of crypto scams that occur and not all of them are related to private key compromise just because your assets have gone missing in your account doesn't necessarily mean that you have a compromised private key it's important to understand the method by which your assets were removed because they have different remedies so you need to ask yourself two questions one is your private key compromised and two is there a sweeper running using this this compromised private key so to answer the first question is your private key compromise the best way to tell if you have a compromised private key is if you have transactions on etherscan in the transactions tab that you did not create I'm not talking about token transfers here we'll talk about that in a bit but under this transactions tab do you have any out transactions that you yourself did not sign either with metamask or with a ledger if the answer is yes then someone else has access to your private key next if you transfer in any if into your account is that taken immediately in this screenshot we can see that 0.009 East was transferred in at block 770 here and in Block 771 it was already taken and swept into this account you can see that the transaction fee that was used was more than half of the payload that came in just 12 seconds prior so now that we know what a private key compromise looks like on etherscan let's look at what a private key compromise does not look like here is a victim that fell prey to a approval scam and the first thing that we can notice is that they have an eth balance they have 0.004 which is plenty large enough to be swept so because this has a need balance we can tell pretty conclusively that it doesn't have an active sweeper running on it furthermore we can look more into their their scam and the way that they lost money if you look at token transfers 42 days ago they lost 417 usdt that's 42 days ago but if you look back here they didn't even run any transaction here 59 days ago is the last ethereum transaction that they ran so they ended up approving some third party to spend their tokens and then a couple of weeks later they did but there's no out transaction here that they themselves didn't sign they signed this approval thinking that they were entering some sort of a daily interest thing or something like that and because they have done that they have lost their their funds at a future date no out transactions were signed here that they didn't sign themselves this is an example of a a scam that occurred that was not related to private key compromise so now that we understand what a sweeper bot is and how it works let's go ahead and run one for ourselves on Gorly in this case we're going to be using a very simple version of an eighth burner that I've used in the past but I recommend that you make sure that you trust whatever Source it is that you're getting the software from because it is very sensitive and we are going to be giving it private keys so let's go ahead and check this out I have here the the code it's on GitHub and the first thing that we see is that this thing actually hasn't been updated in a really long time about a year and a half and that just goes to show just how simple the software is that we're talking about in fact if we go and look at the bulk of the code the bulk of the code lives in this burn file and it's just a couple dozen lines there really isn't a whole lot to how the system works so let's go ahead and run one I've already installed this before locally and it's very very simple to do so and I am going to be running it against the private key that is that is obviously made up and this is just a bunch of B's and A's so please do not use this to store any real funds this is only for demo purposes we're going to be giving this burner a a private key to burn on and we're going to be giving it an RPC URL this is the location that is going to be querying for the balance of the eighth that is stored at this account and also where it's going to be sending the transactions that is going to cause the burn to get propagated to the rest of the network we're using the inferior endpoint for this just for Simplicity although any RPC URL would work here if you're running your own so let's go ahead and take this private key here I'm copying this to my clipboard popping over here to metamask we're going to import this so we're going to say import this obviously fake ethereum accounts but it still works and here we see that we have 0x858 is the name in fact let's go ahead and rename this just to make this a little easier to to demonstrate so I say Account Details name I'm going to call this burned account I've used this account in the past to do these demonstration so we're going to see this on etherscan we have these accounts from from eight minutes ago but let's go ahead and hit enter here so the first thing it's going to do is go out and say hey you know what the balance is zero so there's nothing to do right you can't burn something that doesn't exist so let's go ahead and actually make that balance More Than Zero by transferring funds into the account this is a very similar step that you would go through if you were trying to let's say fund this account in order to run other transactions from it so I'm going to say send I'm going to transfer it to this burned account let's just give it a small amount let's say point 003 so we're going to send the burned account some Gorly eth from my Gourley account one a completely different address and say confirm if I go over here and reload we can see this transaction is currently pending from that account it is coming in with .003 eth we see the burner bot has immediately noticed that there is something to burn here and it immediately fires a transaction that burns all of the if using the exact gas price that it needs to use in order to completely wipe out that account and if we go ahead and refresh here we see that in Block 244 0.003 each was transferred in and in the very next block 245. almost the entirety of that was burned in a transaction fee so when this burner bot is running on this account it is impossible for someone to use the mempool to conduct transactions from this account because the first thing that's going to happen is that the eth is going to be burned way before anyone has a chance to use this account for anything else we'll go ahead and kill that I hope that you've seen from this quick demo that a sweeper bot is not a very complex or elegant piece of software it's just something that has a singular purpose to destroy all incoming eth and either steal it or burn it using a transaction fee and in doing so prevent the original owner of that account from accessing any resources from that account what can we do to defeat a sweeper bot and to rescue assets that are locked in a compromised private key account to answer that let's first consider what it's like interacting with any account that has zero ethernet the first thing you have to do is transfer in some small amount of Youth to pay for gas and then you must run a transaction sometime later after this transaction is confirmed to actually perform the transaction you want however because you have a sweeper on your account whenever you transfer in 0.1 each it is immediately zeroed out 0.10 there's nothing you can do to avoid having zero if in your account in the next block what we need to do is take the funding transaction and the transaction we want to execute and put them together in a bundle this bundle will land on the blockchain at the exact same time with no blocks in between this transaction and this transaction now we can't get the sweeper off of our account in fact after this bundle lands we're likely to leave a little bit of gas behind and it that is going to be swept just like normal but but it's going to be swept here and not here and this move nft or whatever action it is that we wanted to take place will have occurred without the sweeper interfering in order to send a bundle you can't just use regular meta mask you can't just use a standard Json RPC like in Fiera or any of the common ways of sending a transaction you need to use a special relay in this case we are talking about the flashbots relay which is an API that is publicly available that allows for special inclusion rules when getting transactions onto the ethereum blockchain so when this is given to the flashbots relay it hands it to the validators of ethereum and they know the rules that it is only included together or not at all now there are several flashbots products that are user facing there is the flashbots protect and the the flashbots relay the flashbots protect is a very useful very easy to use service that allows you to use metamask with flashbots for transaction privacy prior to inclusion but this product is actually not suitable for what we're going for here because it does not have the ability to submit two transactions at the same time with special inclusion rules we need to be using the flashboss relay so how is it that we use the flashbots relay there's basically three ways to do it using the flashbots relay directly takes a bit of technical know-how both in the ability to code and also in how ethereum transactions are formatted under the hood I have a video which I'll link in the video description if you're interested in trying yourself but I really don't recommend this unless you have a pretty good handle on a programming language and how ethereum works a lot of things can really go wrong it can be pretty complicated but if it's something you want to try I have some resources for how to try it yourself the other way that you can use the flashbots relay is to work with someone that specializes in using the flashlights relay for asset recovery you need to be extremely careful about who you talk to about this there are significant numbers of scammers out there this often includes taking a fee and there's also minimum rescue amounts so if it doesn't reach some sort of a threshold a lot of times the the white hat teams will not take on the case and there won't be any real recourse for how to rescue these assets here's a couple of trustworthy organizations that specialize in different types of asset recovery flashboss is one of them and I'm a part of flashbots as well so if this is the way you want to go you can click on this link here fill out the form and come talk to flashbots on Discord but be extremely careful into who you talk to the last option I wanted to present is the Interceptor by dork florist this is a project that I am working on with fellow white hats and this is a browser extension that aims to improve the security of interacting in ethereum it sits next to metamask it does not replace it and it enables simulation of multiple transactions prior to confirming them on ethereum and we were able to take this ability to create what we were calling a simulation stack and convert it into a flashbots bundle so effectively you can use the GUI and used apps that you interact with on a day-to-day basis to create a simulation stack which is a set of transactions that you want to be included on ethereum even though you're not broadcasting them yet and instead of submitting them one by one we have created a service that allows you to take this simulation stack that you created using the dapps that you are accustomed to and to convert those into a flashbots bundle to do a bunch of things at the same time without having to program without having to give your private key to a white hat or or find a way to kind of navigate the white hat ecosystem there are no fees on the system and it's something that I invite you to try I'll be creating a step-by-step of how to go through this but I invite you to check out the the dark florist Interceptor it can provide a lot of features aside from recovery as well including transaction simulation and malicious transaction detection and the the service that allows you to bundle your transactions and turn them into a flashbots bundle is called bokeh and it's available here and yeah if you're interested in doing that I'll have a link to the video right here and I will see you in the next video 