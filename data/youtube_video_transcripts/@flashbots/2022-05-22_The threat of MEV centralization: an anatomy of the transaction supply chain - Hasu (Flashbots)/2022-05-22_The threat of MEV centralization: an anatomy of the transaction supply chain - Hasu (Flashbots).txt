[Music] so welcome to my second talk the threat of mev centralization the anatomy of the transaction supply chain this is already my second talk of the day if you didn't catch the first one my name is hasu strategy lead at flashbots also a strategic advisor at lido and i've been thinking and writing about blockspace market design and muv um for a couple years already so back in the day when designing your blog space market was easy and we didn't exist and the only threats we were to we had to worry about were things like selfish mining attacks and so on so in this talk i want to build on a new mental model that steph stefan of flash was introduced in his first talk of the day and we call it the mev or transaction supply chain this supply chain includes all of the major parties that are involved in from starting from the user getting a transaction included unchecked on chain second so it starts with the user the user has an intent to transact and they express this in terms of the wallet while it turns it into a transaction and then some transactions get picked up or manipulated by searchers and turned into bundles some don't and then a builder will select the transactions to be included in the next block send this block to a minor or validator and we will attest to it so um we often talk about the the guarantees that we want to get from public blockchains um and one major one is censorship resistance and the other one you could say this market power for users and where do these guarantees really come from almost all of them come from the competition between miners and validators the competition that they that they have among each other right so there's really there are some cool cryptographic properties of blockchains um but a lot of the guarantees actually come from um how the economics of the system work that there is not one party in control who selects what transactions go into a block but there are several several parties who all take turns making blocks and they are in competition with each other so that's how you end up with users who get their transactions mined at the cheapest possible price which is the cost of production of block space so what is the marginal cost of including another transaction as a miner it is only the increased ankle rate and now that we have eip159 it's also slightly higher it's also the cost of increasing the base fee in the next block um so that is a major point and censorship resistance right so whenever you have multiple parties competing to include users transaction there is really not much point in censoring because why if you like if you're the first miner in the in turn um can you can you really say um i'm not going to include this user at a price of 10 grey or because i don't like what they like that the user of sushi swap instead of unisrop no you cannot do that um because then the next miner will just include you and the miner who didn't will slowly go out of business so what is the scenario that we are concerned about this is also what steph talked about in his talk very briefly it is what we call med dystopia and that is this entire supply chain that you saw collapsing into a single vertically integrated party and when you have when you have this outcome then what would happen is that all blocks on public blockchains will be made by this one party and that destroys all of the guarantees that we wanted and that we established in the previous slide so no competition very good no like strong vertical integration means no competition between suppliers in the different stages of the supply chain and it means worse guarantees for users it means the loss of censorship resistance and a monopoly that can charge arbitrarily higher fees from users because they do not have to be worried about another block builder coming in and including the user at a cheaper price so what we are concerned about today what are the paths from here which is today we say we have a reasonably flat supply chain to this dystopia that we are trying to avoid at oil cost that is the topic of today's talk we will cover both scenarios where it has been already avoided and where we are looking right now and now we are concerned about increasing vertical integration in this supply chain before we go into the risks i want to make i want to dive into one particular part of this to make it very clear the builder and the validator slash minor are two separate parties and they have been two separate parties for a long time so the validators and miners have for years not been the party who selects what transactions go into a block so the role of the builder has for many years now been played by the mining pool the mining pool selects the transactions and puts them into a block and then they forward only the hash of the block header to the minor slash validators who then attest to it um with a proof of work or proof of stake giving it economic weight in the forecast rip and that is what allows all of the nodes in the network will come to consensus right it's not enough to just have a block that has transactions you need all of the other nodes need to be able to see one block that has a lot of economic weight so they know exactly which of many infinite forks they need to follow and stay in sync with the network so this separation between the builder and the validator and especially the focus on the builder that will be a topic of today's talk so we already touched on this in my previous talk but building used to be very easy going back to this slide so back in the day when in mind all the mining pool had to do was have a decent view of the memphis they had to see all of the transactions um with a good latency that the users propagate in the network so they always have all of the inputs in order to just run a very simple algorithm which is sort these transactions by their gas price um or by their by the price per gas um and then select the highest paying ones and that they can right so if there's like 10 million gas available then they select the highest 10 million gas of transactions but mev makes building hard why because extracting mvv is not just a matter of running a simple algorithm like the miner is used to it is a matter of identifying what the mep transactions are then making these mvp transactions possibly maintaining inventory of coins and managing risk and so on this is all skills that has nothing to do with what the builder or validator oil miner used to be good at in the past this is all skills from the domain of trading and so what we what mev in the absence of the system like flashbacks has caused is that [Music] miners and builders they had this incentive um but they had to become trading firms or traders in order to most efficiently extract the mvv that is available and they have no choice but they don't and some other minor will do it and they will make more money than them and slowly crowd them out of business and so back in 2020 before flash was launched there was already some of this vertical integration going on um and as some mining pools were starting to strike exclusive deals with trading firms and this would have been very problematic and this is the first the first step on the road to a single um dominant party who can make blocks more efficient and who may not be open to for other searches to join uh and not be open to transactions for all users and not be open uh for a hashtag from all validates so this is what we had to prevent and um that's when flashbacks entered the picture with medgaff so what med gaff is it is an ethereum client that the builders could run so the mining pools and it connected to an offchain auction where researchers were competing for med extraction and we already covered some of this in the previous talk but this auction it had a better blog space market design that allowed such as to express more complex preferences for example say exactly where they want the transaction to be in relation to other transactions and it also had the nice properties of atomicity so one transaction could not execute without all of them executing and you could not if your transaction failed it would never land on chain so this was really a system that was taylor made for med extraction and and it quickly gained uh almost 100 market share among the builders and so um the uh as a result you end up with this open system instead of a closed one so we we have set up a vertically integra like a builder that's sort of integrated with searchers but does it in a very open way it makes the best block available to all validators and makes the hash power from these validators and miners available to all searchers so it acts like a trustless api between the welder and the searchers now one or two years later we are looking at some new challenges that threaten the piece that we have right now you could say on in this supply check and that is one um of exclusive order flow so what is exclusive order flow that is transactions that some builder or searcher can use that other structures or builders can't right [Music] and the question is why is this useful so a builder for example who controls um a sufficient amount of order for that other builders have no access to they can always reliably make blocks that are better than the blocks of other builders and always win right so it's basically the same thing as with mev there is a there is something that lets you make more money so you take it away like you take it for yourself and you take it away from your competitor and you use that in order to create a monopoly position in the supply chain and um so that is something that we are concerned about so you might ask why would users go along with this right i mean the answer is simple because they get paid okay um as a user getting paid to transact is a really nice feature so um but the problem is in the short term so it's very good in the short term but in the long term it leads to a scenario where you know the liquidity um basically fragments into dark pools the same way it does in tradify so there's no global liquidity there's no global market price and even worse you end up with this with this one party that can monopolize the supply chain and extract a lot of rent or start extracting a lot of rent from users and other participants of the supply chain and so the question is how can you prevent that um first of all same with with mev we have to um we have to acknowledge that users and wallets will follow their short-term incentives okay so if somebody can pay users for their order flow then there might be some who would say no well we are not going to do this for ideological reasons but most of them will not so really you are in a race to who can pay use us the most to transact and um [Music] and so a system that wants to compete with that also has to compete on paying users forward some very simple ideas here would be so if a user transaction creates mvb then this is something very obvious like you don't even have to supply any capital from the outset and you can just capture that immediately and start playing it back to them so and we are raising a conjecture here so flashbots is a vertically integrated block builder um to generate the maximum uv but it is open and permissionless so you could say that flashbot is sort of this thing that we said we were worried about which is it's a block builder that's integrated with an med market but the difference is that it's open and commissioners so is there an equivalence here for other flow does a system exist that is decentralized and that can pay users more for their order flow than any centralized system can and i think this will be a very important research question for the next one or two years in crypto the third challenge is dashboards and none of its competitors currently give block builders and validas exposure to cross chain med so why is this important so in a cross-chain world um in a in a single domain right you have this concept of atomic transactions right so we have two transactions and one and they only execute together but you never had one without the other so this doesn't exist in the cross-chin world and if you're a trader who wants to do any kind of trading cross um cross domain then what you end up with is you end up with a lot of additional execution risk risk that the first lag of your trade executes for example on ethereum but the second one for example on arbitrary doesn't or vice versa and so this really adds a lot of risk and if you control block production if you control the next block on several domains you do not have this risk you can always say either both of my transactions are going to be included or none of them and that is a very powerful feature that will drive the incentive that will drive block building across several domains to centralize and to be done by the same party so if we don't want this to happen in a proprietary way then again exact same logic you cannot discuss cross-chain mvv away or you and you cannot hide from it we have to acknowledge that this is the reality of the market and we have to design an open system and a decentralized system that can provide this access to this cross-chain mvv to validators and to searches right same story again as with original mev so what we have to do here to be precise is we have to allow val validators on different domains to cooperate with each other and with cross-chain structures we have to create a new market a new version of flashbots that is cross-chain and this is strictly better than allowing them to form a private cartel note that this issue affects the supply chain on any domain so if you are if you are building a layer 1 a layer 2 a side chain it doesn't matter this will affect you so you have to deal with this problem so taking a step back here going back to the supply chain what do we want we want the supply chain to be super flat we want maximum competition at each layer and we want order flow that is private in the sense that it's not subject to front running or other forms of financial harm to users but we want it in an open domain so we want searchers and builders envelopes to have access to this order flow in a way that respects the user preferences and we want the barriers to join the supply chain at any stage to be and to be low um so this is what creates the best guarantees um for users of public blockchains and this is what it could look like right so in in relation to the first light you can see we have here several parties at each stage that compete with each other and then for example the wallet sends a transaction to a searcher or a builder and the user the what the wallet on the output user can get paid for that transaction um and um you have between the search and the builder you have the type of med auction that we know today between the builder and validator you have a system like math boost or pbs going back to metallics talk earlier so this is sort of the end game that we envision what are the takeaways the biggest risk from mev is that of vertical integration in the transaction supply chain the supply chain meme that we presented today is a useful mental model for understanding where incentives drive this risk of vertical integration and what we do at freshboard but also in collaboration with all of you and the research community and the builders we want to keep we have to identify what the paths are that lead to this muv dystopia into this vertical integration in the supply chain we need to make sure that we create create alternate systems that are available to oil that will prevent the need or the ability for these private integrated systems to win and we need to do this order to keep public blockchain centralized and censorship resistant we need competition in each part of the supply chain and achieving that keeping the supply chain flat will come down to creating the apis for trustless collaboration between the different suppliers right so what flashbox does is for example to go back to that we have a trustless api between searchers and miners it's not completely trustless but you know it's it's trustless enough to have wide adoption today and that is really important because if a lot of trust was was required between searches and minors to work together then a private system would always out compete a public one you need to create trustless apis between the different parts of the supply chain meaning between searchers and builders and builders and validators and in the future also between wallets and searchers and builders in order to start paying users for their order flow the final takeaway a lot of power and responsibility will accumulate in this builder role right creating the api through the validator and creating the ipi on the other side to the searchers and creating the api on the third side to wallets and users to start paying product so this is what we see as the hardest challenge in keeping public blockchains decentralized and that is what flashbots will focus on in the years to come we want to create a decentralized block builder that can out compete any centralized one and that keeps public blockchains competitive and decentralized thank you i'm not taking questions hi hello um so i was wondering how the node providers play into this because like for example infura runs a lot of the nodes that are like used by default um to to send your transactions to so would you see that like on the same level as the wallet providers yeah i think the closest i mean this is not there are some parties in here that we didn't capture but and we think that yeah this the closest analogy here is the wallet i would say yeah hey hasu uh you said that validators across different chains can bring them into synchrony and eliminate the risk of cross-chain transactions do you see validator set overlap as a significant issue in the future when multiple chains share a huge portion of stakers yeah i think this is what we are gravitating towards in the absence of a builder that gives access to the cross-chain md so i i think what will more likely happen is that the validators will be able to be separate parties um although in practice i mean if you look um who would who are like the professional validators and node operators across all proof of stake blockchains there's a huge overlap right now for other reasons why because it's i mean a lot of the same skills basically like a lot of the skills that it takes to be a good operator on ethereum transfer one to one to being with node operator on solana and ontario and so on right so you will have um probably a large overlap but not because of um the existence of crosston mev i think this would rather lead to the same block builders making the transactions or the blocks on all domains and then you will have like a more diverse set of welders listening and connecting to this hopefully in the public domain um cross yeah cross med builder i liked the uh the mission statement at the end about the the target of an open block builder and um and that's a laudable aim and i think flashbox's biggest moat um that stops other people getting there first is the brains that it attracts but in the long term do you not think that a um a non-open builder is still gonna win one day um it's i mean it's possible um we are we are hoping that it doesn't i think in case it does it also makes a lot of sense to pursue alternate research tracks um such as these side channels where you can force specific transactions to be included right in public blockchains um this at least gives you like censorship property so we should definitely do a lot of research as well into how public blockchains can keep their properties that we liked today even if the builder role is completely centralized but sort of one thing that i haven't seen so far that can be solved is this property of market power for users right where um right now you have multiple builders competing to include the user at the cheapest price and if you have one party like even see like technology like um the cr lists they don't help you with that like this party can still um charge arbitrary amounts of rent from users um i think i mean there are a lot of a lot of things that we have to explore here like a lot of advantages that go into being um that go into being like a cross chain builder for example inventory management across both chains right or across multiple domains like how can we i think if we don't want to like a centralized party to win then you will have the whole industry sort of having to pop up around this idea of keeping the supply chain flat like such as inventory on demand on on different domains so that you know searchers and builders don't have to maintain it themselves all right thank you asu i think we're done with questions um clap thank you thanks everyone [Music] 