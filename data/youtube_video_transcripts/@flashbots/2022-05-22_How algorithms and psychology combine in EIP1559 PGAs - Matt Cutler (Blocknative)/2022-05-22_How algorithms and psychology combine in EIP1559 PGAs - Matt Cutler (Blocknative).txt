[Music] hey uh good afternoon everybody uh my name is matt i'm from block native and uh we're here to talk about gas prices there's been a lot of discussion today around the impact of gas prices and we were asked to come share some of our research into the public mempool gatsby marketplace so there's a lot to go through here i'll jam through it everybody has access to the slides and hopefully at the end we'll have time for questions um we operate a streaming mempool data as a service platform but we really view pre-chain transparency as a public good to try to level the playing field for everybody in the ecosystems that we service but in doing so you can't just say here's mempool data it's really incumbent upon us as providing a public good to enrich and extend that data because the raw data itself is not that useful and one of the things that we do as part of that is gas prediction and so a lot of what i'll be talking about is what we do in gas prediction what we see and what's happening moving forward you may have used our gas estimator but that's pretty simple it's based on this underlying series of models that are doing next block predictions so we spend a lot of time trying to predict based on the contents of the public mempool what is likely to occur in the next block and then draw inferences and basically let people make better decisions help you be a better searcher as a result of knowing that um so this is what we'll go through today a little bit about free prediction we'll talk about pgas under 1559. and then we'll look ahead at some of the new stuff we just today released some basically prediction which is kind of cool and touch on the merge briefly so there's been a lot of talk about the good old days here the nostalgia of the past that was a simpler day and era so previously gas fees were really quite simple it was a first price auction model block sizes were fixed you picked one number miners included you and that was the whole thing okay but this had a whole bunch of problems and negative externalities as we've already heard about today but in particular they had this tendency to have these pgas erupt these sudden changes in gas price where the network would be coming along and then suddenly bots would go to war and if t launch would happen gas prices would skyrocket users would would have negative experiences and it was really hard to figure out what to do next and how to behave appropriately within this and so what we built this is back uh in this era was the first set of gas feed predictions and so what we basically said was hey we have the whole contents of the mempool we can look at that and we can say well these are transactions that are likely to be in the next block and based on that we can start to build some confidence levels and build some neural nets to sort of say hey look we can basically provide advice about what it's going to take to get into the next block so this a lot of the research that we've been doing as it relates to this aspect of our business is what are the likely contents of the next block and if you want to get to the next block in specific order what do you need to do and why and so there's a whole bunch of stuff underneath the covers that makes that happen and then we produce these payloads which are uh publicly available or you can get commercial plans for us for this as well that sort of show all these various confidence levels and how your gas needs to be set as part of all of that we we benchmark this against reality all the time so we're constantly calibrating everything to make sure that our models actually affect reality because when we don't bad things happen um and and then eip1559 comes along so as everyone is aware eip1559 was a fundamental reinvention of the fee marketplace not ethereum designed specifically to try to make it a more equitable market and make it a little bit more balanced but what it did was take one uh gas number which was pretty easy to understand and decompose it into these three so of course we have the base fee we have the priority fee and then the max fee which is disorienting for folks the base fee is algorithmic the network determines it so the network becomes self-aware about what the gas fee marketplace looks like and it adjusts up and down we're going to target these 50 full blocks the priority fee is uh up to the user optional quote-unquote and as the the the tip and then the max fee is a super disorienting thing for users because you gotta uh anticipate future base fee increases you have to overestimate your your max fee so you don't get under price and this is proven to be super disorienting but but practically speaking the base fee is determined by an algorithm and the priority fee is determined by user psychology and these begin to interact in interesting and unexpected ways and we'll be talking about that now and now what we're working on and i'll talk about this as well sort of making uh providing a lot more clarity into the base fee multiple blocks into the future so that we can make more accurate and more conservative estimates or lower estimates of the max feed so here's the base of the algorithm we won't go through that too much today but it results in things like this so here is a nft launch from earlier this year it was the ao artball nft launch and you see the networks are coming along base fees pretty stable and then the nft launch hits and the blocks start to get full and eip 1559 base b algorithm does its thing 12.5 percent per block and it starts to ramp up as fast as it can and it reaches some sort of maximum point demand drops off and we see a corresponding decrease now significantly under 1559 the the base fee tends to increase faster than it decreases and where it started and where it ends it tends to take hours to get down to where it was but we'll talk we can talk about that a little bit now that's just the base fee for this launch here is what the priority fee was doing during this launch so most of the time the priority fee is relatively small a couple of way maybe but under periods of network congestion the the user psychology kicks in people want to get in on these nft launches for instance and you see this sudden surge in just a small number of blocks the minimum priority fee to be included surges to above 800 okay now you'll notice it's sort of up there and then tails down but of course this is only half of it it's basically plus priority fee and so this is the overlap of those this is all to zero but if we add them together what do we have here we have a pga okay so during periods of network congestion during periods of high demand the priority feed dominates the user psychology kicks in and you have the exact same sort of cliff effect or tabletop effect that we had before where you have this sudden increase in fees to get unchained and then a decrease thereafter now what's interesting about this interplay is uh there seems to be this interaction between the priority fee and the base fee i.e as the priority fee is low the sorry as the base fee is low the priority fee is quite high but as the base fee starts to catch up the minimum priority fee starts to shrink and so the the priority fee which is set by psychology seems to be responsive to the state of the base fee and curiously it would seem that users who are participating in these launches sort of have some uh shelling point uh collusion if you will where they sort of all agree for this nft launch here's probably what the floor is going to be and that's what the transaction is coming out of the memphial as and so it varies over time but there's sort of interesting effects as the base fee responds the priority fee uh adjusts and and users make decisions in real time about how they're going to participate we also have this overshoot effect where you say here you can see the base fee is coming up the priority fee is now a declining percentage but there's a window for a few blocks where you could actually probably have gotten in if the minimum priority fee was lower but the the buyer behavior of this nft drop sort of accelerates beyond and you see the sort of bump up before now uh these are pretty common this is just a couple of other ones these sort of tabletop effects where you see the base fee in blue priority fee in red and the sort of jump up minimum block inclusion um and what we're seeing in the data is this overshoot effect seems to be coming more common and more extreme so here's the arcade land nfp sale orange here is the priority fee and you can see a significant overshoot up to 2000 way over the base fee similarly here's the relief ukraine nft sale this time peaked all the way to 2500 but you can see jumped way up demand wasn't supported and then came down pretty quickly once folks realized that that wasn't going to be sustained um here's the benji bananas pass nft sale this spike was at 6 000 weight minimum include minimum base fee in the block was it 6 000 okay massive increases here and what we're seeing as well we sort of did some gross analysis here to average out the pga profile by month and if you look in october sorry august of 2021 just when eip1559 launched pretty much what we'd expect this tabletop effect but as we click forward by the months we see this overshoot effect becoming more pronounced and we see as more common and so this is a sort of a summary of that but this is sort of monthly data the average peak height of the the average peak of the base fee versus the priority fee and what do we see here that the average peak of the base fee is declining over time while the average peak of the priority fee is increasing so the psychological impact seems to be growing as it relates to the gas fee marketplace and this creates all sorts of interesting problems because when you have these massive surges now you got to be really careful about your max because you set your max view in such a way to make sure that you can get included in a coming block but as these spikes continue to be to happen more regularly you got to be a lot more careful about this sort of stuff so uh this is the typical max fee setting the max fee algorithm which was set up at the beginning which is basically pretty simple you double the base fee and then you add your priority fee the challenge here of course is that it sets very high numbers and users get concerned about that and for many traditional users or regular users of ethereum this is a scary number and so what we've been working on is trying to predict into the future where the base fee is going to go 1 two three four and now five blocks out into the future so that we can provide more accurate base feed predictions and more accurate max feed calculations uh the good news is it looks like it's working so we similarly have released the multi-layer quantile regression neural network that does this and what we're seeing at least since we've deployed that is about a 16 average reduction in max feed calculation so again getting a lot more precise and a lot more sophisticated in terms of how we can look into the data set uh predicting in the future and make more informed decisions uh both as regular users and searchers around uh all things gas of course the further we go into the future uh we get higher error rates so we're really confident one block ahead and then we're a little less confident two blocks ahead and we today are publishing five blocks ahead and you can see the error bars start to stretch out but it seems pretty clear that this is a very practical thing to do and a useful thing to do for users of the network um these are in our payloads today by the way so if you if you go to our stuff you can start to inspect this it's on the bottom every payload so that's out in production we issued a blog post on this today too and then sort of the final thing i'll say on all this stuff is looking ahead uh to the merge so the merge will be 15 59 of course uh where things change just a little bit but there is this significant effect we believe which is that under proof of work you have variable block time under proof of stake you have a fixed block time so blocks will be every 12 seconds exactly that basically means there's certain milliseconds post block confirmation that are less valuable than milliseconds closer to block confirmation or block construction and and we think that this will impact intra block transaction velocity whereas today across the public mempool you see a pretty steady state rate of new transactions whereas uh post merge it'll probably start to pulse well there'll be certain seconds will be less uh transaction velocity and there'll be other seconds where you'll see more transaction velocity and that will create all sorts of new and interesting challenges both for user psychology to figure this stuff out as well as for searchers who have you know need to make bundles based on time so this is something we're paying attention to and we think it'll be super interesting to see the behavior as it emerges post merge and so anyways that was really quick but uh hey in the past gas fees mattered in the present right now gas fees matter and we certainly believe in the future gas fees are going to matter as well and uh we're super excited to be part of this ecosystem and super excited to be here and share some of this research and uh again uh just like uh ethereans and boomers have one thing in common which is we all like to complain about gas prices uh and that's what i had to talk about today so it's great to be here and i'm happy to take questions if there's any questions [Applause] do you have any thoughts on changing eip 1559 parameters such as the base fee escalation rate how that would impact users or for instance moving from 2x1559 to 3x or 5x in terms of the elasticity um we do work with the ef uh on this topic and it certainly seems that there is room for further optimization of some of the assumptions that are made in 1559 and barnaby was here before and he's really driving a lot of that stuff forward so uh we do think that there is definitely room for um refinement to what's there i mean it was a big step in the right direction but there's more that can be done obviously the big conversation right now is multi-dimensional eip 1559 which is awesome on one level because it's much more efficient that's challenging on the other level because it will just create additional complexity for everybody um but uh you know i think that we're a lot we're way away from the end of the road as it comes to gas optimization on these public blockchain networks do you have any thought do you have any thoughts on eip 2593 otherwise known as escalator algorithm or uh in other terms what do you think could combat or what would the ux for users uh be if we were able to reduce sort of the priority fee climbing and uh the first price auction occurrences so i'm not i'm not familiar with that eip but we are seeing a lot of interesting work on the usability of wallets and sort of how wallets present this information to folks and so that seems to be an area that's sort of ripe for innovation um i'm not sure if you guys have seen the tally wallet has a pretty interesting and different way of presenting gas and gas price and we're working with those guys as well it seems pretty clear that users are challenged by this that the slow medium fast the the distinctions the time like it just there the mental model among most users uh doesn't really reflect the reality of how the networks work and we're constantly um responding to questions about how this stuff actually goes so it seems to me that there's a pretty big gap between how things actually work how the wallets present this stuff to users and how what users understand and we're excited to be a part of simplifying that moving forward we actually do a bunch of front end work as well we have a web3 onboard library that's going to be incorporating a lot of stuff too to help simplify that but again i think we're early in that process there's still a lot of work to do any other questions awesome i'll be around if anyone has any questions again thanks so much and have a good rest of your time in amsterdam [Applause] [Music] you 