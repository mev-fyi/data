uh yeah so today I'm going to give a talk on how our thoughts have evolved uh over the last several years and a pretty unique design uh that we have since put into quotes all right so yeah we have a very high level overview of RQ uh I think it's a much more you know longer system uh at this point uh how to think about Dex quotes dig into a bunch of data and then we'll have to talk about our design all right so quick timer on what RP is so RQ allows you to create your tier against professional market makers uh so user comes in they request a quote you know what's best price you could give me for you know I want to make a trade of this amount all the market makers respond with their best votes user agrees and submissive transaction RFQ has uh some really nice properties from an Mev standpoint so trades are always uh they always happen at a predetermined price that is is fixed in the signed quote therefore they always have zero slip no Med is possible when training is hard here the quotes are tailor-made for the speaker as well uh so the order format actually specifies the paper's address as uh the only addresses allowed to build order uh therefore they can't be frontrunned or anything like that and uh yeah that's going to do the presentation a couple years ago RFQ was making up roughly 40 of volume through 0x uh so yeah just a reminder for those who aren't too familiar uh Xerox is a liquidity aggregator uh so it routes between RQ and all the other on-premely sources so 40 trades for NAD free but if you take that step further it is not actually enough uh right like if you're if we're comparing an RQ quote which always has zero slippage versus other quotes uh that you know potentially have slippage you can't actually really treat those quotes equally uh and yeah most people don't really understand this but yeah a m quotes are kind of cool like they don't they don't really uh mean too much uh the expected value of a whoa uh is going to be less than the quote itself um you know they don't account for any Market option anything that's happening in a mempool anything that's happening happening in you know private Medicals um don't account for any hidden keys like positive slippage um and yes you thought you were done with Tom memes but from 2019 that is from sometimes [Laughter] so yeah uh uh and yeah another reason to think about this is that what people think of as Market orders maybe sacrifice exchanges are really basically limit orders uh so they're currently kind of framed as okay I'm gonna make a market order at this price and I'm willing to pay up to some other price but if we rephrase that what you're really doing is you're placing a limit order at that second place and you think maybe you could get that that first price but there are no guarantees uh around that at all so you can we can do better uh you know so we seek out uh how do we address this problem how large is the problem first of all um you know since we are an aggregator we have a lot of data right we see all the user quotes we can try to map those to uh the actual trades that are settled on chain and we can compare it to you and uh have a lot of data on Realize slippage you know across every single uh token basically uh so this is a oh sorry uh there's a histogram of uh realized uh slippage and the the scale is normalized so don't be too much into that uh you can see on the right hand side the positives the page follows the power law distribution so that's when uh your realized price is actually better than your quoted price you know that that is possible to happen um but the the negative slippage on the left-hand side is is pretty interesting we see these these spikes uh where users are realizing uh you know higher than average slippage um and you think that that is happening because uh those are the levels which users are setting their slippage confidence um so I will show you more data uh proving that that is actually happening um here here's another chart uh showing uh slippage exhaustion across all trades uh so this is a metric we've created uh which is the realized slippage divided by the slippage tolerance of Trades um so you know if you set your map footage to 10 basis points and you realize nine basis points of slippage that's uh 90 slippage exhaustion and uh you know it's also more or less it's like a power law distribution until the very end and you see there's this huge Spike uh where you know a larger than average amount of Trades are actually hitting very close to that map slippage tolerance uh so what's happening there is that and researchers are you know basically treating these as limit orders they are capturing as much of that Delta as they can um and we can also see that this problem gets worse as trade sizes get larger uh so the likelihood of uh you know you hitting a uh your your max slippage uh or a very large trade uh it's gonna be something like uh 14 um and then we've also see yeah this this uh kind of quantifies in dollar terms uh how how bad the problem is uh we can also see that slippage Trends up as trade sizes get larger uh for all these major pairs so we have all this data how can we actually put this into use and help out uses uh so we created this feature called slippage protect which I think is a pretty unique design which I haven't really seen anyone else uh do anything like this um but the idea is to yeah essentially make the aggregation routing Mev aware so we have all this data on uh you know what is the average slippage for every single given liquidity cool uh token pair and trade size bucket um and then when you're routing through all of these sources uh we can you know actually essentially analyze certain routes if we think that they are going to realize slippage and you know route people towards things that will be always less liquid uh yeah so our hypothesis is that uh you know by factoring in average slippage users could have higher quote accuracy they should decrease their realized slippage and overall should improve execution quality for users uh so I kind of think of this as like a it's like an order flow pre-processor uh so you're you know optimizing the route to uh minimize the Mev that is extractable after the fact so did it actually work well you could you can see uh the the difference in orders that use the slippers for that feature and orders that do not uh so it's optional for uh you know users of the API so some people use it some people don't uh but we can see on the right hand side that the trades that are using slippage protect actually realized pretty significantly less slippage on average than those that do not have this so uh yeah what are the implications of the seizure um users are going to get improved accuracy quotes um it's going to end up routing more volume through operating sources that do not have slippage or have less slippage um today that's pretty much the Sparky like a zero slippage and also uh you know some border books as zero slippage uh trades on average should have better execution but yeah one limitation is that does not mean that every single individual trade will have better execution it's actually possible for you know trade to have to end up having a slightly worse price but on average it should be much better um and yeah like like I mentioned it's basically an oracle preprocessor so it should decrease the total Med that is possible uh to take out from Syracuse uh it's also just automatic reviews they don't need to use custom rpcs or anything like that so uh you know as Tom mentioned with metamask there's no way to like force your users through a private mempool uh so you know especially if it's a non-technical user and you know I assume most people don't even know what a private mental is um this is really going to help out that episode um one limitation is that if you are using private event tool um this is not perfectly account for that although it should be somewhat reflected in the data um because the data set is using transactions that went through both public and project rules foreign actually thinks this and it's like kind of weird to say like oh like I wanted to give you the same information it wants to be like yes you can trade your like a million people exactly that's fundamentally the point is like there's only a certain amount of liquidity so it's maybe a less explicit version I would say that has a trading part of the beginning so I had an idea any thoughts on that but well I think there are actually a lot of products out there that that do three quotes equally right like those aggregators in their routing algorithms they're gonna get all them the same uh meta aggregators that compare multiple aggravators they're going to look at quotes in exactly the same way so um so I actually think it's also great because the routing problems was convex so you can just solve it right I can just like give you a very fast algorithm like install it for like ten thousand pools and like 100 milliseconds so um code online for it too so but um how does that compare with the slippage like you're providing certain markets that have so but we need to solve the problem optimally like in the first place like why not just solve it and then goes on chain does that make sense all right yeah yeah I think the way to so what were you doing as a family book and let me make sure I'm saying this correctly we're going to remove pools for which there's a lot of diverse lipids right you don't remove the pools you simply penalize them for the expected slippage model sure okay but um the point is okay what are you doing you're saying let's look I'm gonna give you for you give me a bunch of e and I'm going to give up right I'm gonna I'm gonna guarantee that in fact the amount of Cheapo that you get out is maximized that's ideally with your kind of thought right that's the whole time so Mike Clayton is that problem is actually efficiently solved too much to Global automatic so why not just do that instead of the heuristic where you analyze tools how do you solve it yeah actually you should check that out cfma router.jl uh and there there's a very thousand dollars right just didn't change up one exactly sure yeah but that's why you have like you're giving me a dark pool in the first place right why not just like submit the thing the order if you executed at something you can pretty much yeah right you have the same problem even in the case of like submitting Learners to through menu like thank you some sort of like realized model ability I think why is there such a difference in different goals you know is it just like certain standard interests like having to live in certain pools and like fight the people who like go across it is I mean I think it's not that much different across a M's you know it probably depends if it's like you know more like you didn't do or a tick based and um um but yeah I think generally it's not great but it seems to be more of a property of the liquidity rather than a property of like that particular pair so then one of the thing is you can just have a model for that in the first place not like this limited model it's like like you already know like what the slogan's gonna be ahead of time prices I don't know maybe I'm I'm not quite understanding but the mechanics of this like slippage space when you say slippage do you mean price impact I will explain myself that's what I hear you saying thank you does that make sense there you go that's liquidity for you um I think they're more mathematically inclined than I am uh but yeah it's interesting to be interesting oh okay okay thanks um how do you think about like okay like sort of Market based apparatus to sort of a pricing like cash flop versus like zero X I I think they're I mean I think for this specific model it is like largely stackables with other models I don't think it was like one or the other but I think like internals engine type model letter for years I have a question um we did the analysis of slippage uh like on Lower slippage orders you have like a higher chance of your order reverting it's like cheaper for someone to make their order hurt did you like incorporate like your multi-block fill like if some if users get refer to them they spend the same over a quarter quarter and over over again and I keep reverbs that's a good question do you not do that although we haven't forgot about it um it's a little and you can you can measure like while it's gas box you can't really measure or lost time that well and overall I'm just not sure if any support is squeeze but uh it is it doesn't really matter but for like lots that have been tagged into performance flow the information you give up like like I just suggest the fact there's a lead SquarePants and I'm actually really mad at the very strong identities to get the first bill and that um you can effectively expensive from a product like essentially for my large wallets that have are perceived that information 