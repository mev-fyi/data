all right everybody welcome to mev day thank you for coming thank you for coming here at 10 a.m i know it's been a packed week from for everybody here i'm also hopped up on caffeine so bear with me but thank you for joining us here in the dark mode stage uh and we're going to talk about mev and what do we do about it and what do we do next um so we're going to cover a few different topics in this talk we're going to talk about the past and why we're all here the journey that's brought at least me here and that's kind of intertwined i think with the journey of a lot of people in this room i'm going to remind us about a lot of blasts from the past that are still relevant today still big open problems in the space i'm going to talk to you all about why you're here hopefully both in this talk and over the course of the day so i encourage people to come up to me about why you're here and i'm going to give some of my own opinions on where we should go next as a community as you know not only flashbots and academic researchers which are the different hats i wear but also as as a as a cryptocurrency ecosystem um so i think it's always important to start with a little bit of reflection on the past that's something i think is a little bit all too rare in cryptocurrencies so before mev meant anything in ethereum it meant this um the energy that's released uh due to the com you know in in mega electron vaults basically a measure of energy and i think this is actually pretty interesting because this didn't factor in at all when uh you know when thinking about what acronym to use for this weird description of minor ordering power nonetheless it is kind of relevant i see mev as almost a potential energy in our financial universe on our blockchains and in all our dapps and mev extraction is the idea of choosing a future kind of collapsing the state function that kind of most optimally channels this potential energy into realized financial value in this case for the miners but potentially also for the users of the protocol as we'll see in many many other talks today so this was the og mev definition but still philosophically relevant to me today so you're going to have to excuse my like corny you know like wizard hat technologist silicon valley guy like tech adoption curve graphic i think this is like not universal but i think it does anchor us and like kind of give us a sense of where we are on the mev meme where are we in taking this to the world um and developing this beyond kind of just the few people uh in this room and in this conference who are who are actively involved today so for me there are three parts on my early mev journey that i think are worth revisiting one was a paper called the hydra another was a blog post flaws of decentralization on xerox and etherdelta and another one is the idea of ordering as the reason for mev okay mev comes from transaction ordering i think these are all relevant historical ideas and these are all joint works with other co-authors that you can find by googling the titles of these papers so my first exposure to mev was in about 2015 or 16 when we were conceptualizing this paper called enter the hydra and our goal there was to create a smart contract that had some economic security to it some value so you know that this contract can secure up to a million dollars without getting hacked and any rational hacker would rather take a bounty and kind of notify the community rather than exploiting the contract there were several properties we wanted for this boundary we wanted it to be completely free of any trust in any institutions arbitration process or anything like that hackers much preferred deterministic payments and we also wanted the bounties to be low priced so the protocols wouldn't constantly be paying out their entire pot in in bounties so we developed a system based on end version programming a technique that came out of nasa kind of flipping it on its head to create these decentralized bug bounties plus a game theoretic model of competing attackers where you could basically say if your contract holds x your bounty should be y which is much smaller than x depending on how you structure your code and your model of the world basically and then you could have like a rigorously rationally secure piece of software which is something that you can't have in like the traditional world so this seems totally unrelated to mev but actually like more than half of this paper we spent whiteboarding and arguing about this one problem which is that if you have a marketplace for these exploits and you don't know that you'll be the first one to reveal your exploit at any given time um this completely breaks all of our game theoretic properties and the marketplace collapses right and and you can sit on exploits for much longer if you know you can front run someone else um commit reveal is not enough because like if you know someone's committing to an exploit you can also if you have an exploit from the past kind of front run that commitment as well or commit in every period and front run the reveal so this led us down the rabbit hole of like okay how do we formalize this front-running adversary and how do we defend against which which one such project is lib submarine this is a working ethereum commit reveal library where everything happens in kind of secret and the commits just look like regular ethereum spending transactions um so in my opinion an underrated project probably way too early for this kind of thing but all leading to mev today um after that for me at least um the next step was this kind of blog post when we started looking at new dexes that were coming online and the rise of defy specifically with ether delta and 0x which was a kind of upcoming ico at the time and we wrote this blog post where we said you really shouldn't build financial systems for users on top of this decentralized stack why because this decentralized stack has certain like really inconvenient properties it exposes you to arbitrage miners can just arbitrarily front run any payment so they can just get in front of you and like this is totally uh opposite of like you know years of accepted financial practice and there's abuses by these exchanges and these decentralized protocols that are claiming to be fair we also ran our own bot to prove this was possible because we had a lot of people say this wasn't a real issue and we we found approximately 1 million a year in profit or so this was a pre-pga mev bot the gas was not competitive at the time and once we once we wrote this article we observed the first pga on this type of mev opportunity within like two days or so after the article and within about a week there were 10 to 15 bots competing for these opportunities and we became uncompetitive this led to gas token and other things like that kind of came out of this work but interesting historical bit and shows you the power the power that we're harnessing here of both financial incentives and competition which i think is very near to everyone in this room so the next question is like technically speaking what is mev where does it come from how do we prevent it what do we do about it right and one proposal is that mev comes from ordering so this was a talk i gave uh dev khan i believe in prague um talking about how ordering will constitute minor fees in the future and these fees are much more complex to optimize than centralizing on the minor stack than traditional transaction fees due to the size of this end complexity of the states-based search and that's something we've seen kind of played out in practice so i think this talk was basically me begging the crypto community like pay attention to this and like we have to really think about this in the design of our systems and like the systems we have today are not working for for users they're very exploitative um and in fact not really much has changed in that regard um so initially you know ordering seems like the natural uh source of mev um thought around mev kind of became more expansive once the question of like what is a fair order came in and what is fairness i think at that point you realize that insertion and censorship which are valid minor powers are just as important as ordering transactions and all the actions the complete action space the miner has in the protocol is important whether whether it can change ordering or not whether you have a fair ordering protocol or not these are all critical to the fairness of your system so that led us into mev so that was kind of the flash boys 2.0 era we're kind of getting into the early stage of the mev adoption curve we also had um at this time the first paper written about mev flash boys 2.0 where we tried to warn cryptocurrency that basically a large part of the stack was getting insecure and quantify with data and experiments and observations uh this effect uh we defined two terms in this paper uh mev and pgas both of which are kind of still in use today um thinking kind of beyond ordering about how what powers does a validator have how can they be extracted what game does this create for the bots that play on the system um this then also in parallel kind of led to this work addressing the previous issue i mentioned which was ordering um which is kind of this fair ordering line of research you'll hear a lot about that today on other stages uh by by mahima kalkar a co-author of mine and others so these protocols look at how can we come to a joint distributed consensus on what the fair order in a system is and what does fair ordering even mean so they have certain definitions that we'll cover here so flash boys 2.0 um we essentially dove deep into mev for the first time we we conducted a longitudinal study of every single bot that was arbitrary arbitraging about eight or nine different decentralized exchanges and we lower bounded the amount of mev that was both being paid to miners and that was available to the bot ecosystem in this world so that was step one then we deployed this infrastructure of nodes all around the world to measure what was actually going on in the system and we observed these kinds of pgas which we created these interactive graphics for um that were getting faster and faster over time so these extremely high frequency auctions that these bots were playing with each other where they would start with low bids and raise them very quickly to compete so there's there's a very complex game theory behind these auctions and why not do it this way why not have like a first price auction in this setting things like that and we go into that paper into actually modeling the ethereum client and the mempool in a game theoretic sense um and and and showing what the game actually is and what the incentives in the game are we also find some interesting strategies um that inform that actually we see bots playing in real life so we predicted some strategies and then saw the real world converge those strategies which is super unique in research like seriously the math came first and like usually you back solved the math like fully fully honestly you know what i mean so like it was a very shocking result for us and showed us the power of this game theory but at the same time the market was still small so when i would go around and present this work people would say like is this real is mev real should i change my job to deal with this blah blah blah blah it's complicated right so it was at the time a market on the order of like 10 to 20 million dollars per year so yes it was real and the math says it will be more real in the future as people start to use these things um which kind of happened later in defy summer but it was kind of still an uphill battle to to get people to think or engage this deep in the stack which thankfully is no longer the case so going back to our old definition of mev this paper actually proposes a new definition of mev so this is a direct quote from the paper basically saying ordering optimization fees represent one case of a more general quantifiable value we call minor extractable value which refers to the total amount of ether miners can extract from manipulation of transactions within a time frame which may include multiple blocks worth of transactions so we were also very concerned about the probability of reorg attacks which basically changed the time order of transactions in the past to let's say do trades that would have then been profitable or bring people's transactions into the future in the execution timeline and this opens up a wide range of attacks on basically every cryptocurrency application so this was kind of the warning to the space and we also showed that the size of these graphs it was enough that the incentives were there to actually do this attack if miners so behaved rationally um so a response to this was to say okay let's rethink byzantine consensus let's think about how to solve the ordering problem right because like ordering fees are one substantial source of mev and the way they do this so there's two major works in this in this realm but there are more coming out and there are several companies also that are here and in other places working as well in this in this space um so the academic on the academic side this work started with equitas and then went to themis which is basically the same thing but in a permissionless rather than permissioned setting and they use this definition on the bottom of my screen here gamma batch order fairness and that says that suppose you receive a transaction a before b in the majority of the nodes in your system then we'll order a before b and this is fair right now smart mev people in the room here might say that like there's a lot of wiggle room there right there's a lot of who gets the first transaction is it spam based is it latency based these are these are important questions to ask there um also what does the network look like so if one person can see transactions faster and send transactions faster they can achieve this notion of fairness but still front run everybody in the system so this assumes kind of a perfect network and many other things there's also some impossibility results here which say for some sequences of things that's been seen in the world there's no way to tell which order is fair essentially so there is ambiguity also inherent in these systems so very promising line of research very many open questions and likely that mev extraction on top of this like looks very much the same to to systems like first come first serve or randomize sequencing we see in l2s that's still an open question i think the main thing left to do in this work is to kind of have an economic model now of rationality and like prove it secure in that which is quite a challenge all right where do we go from there so a relatively new line of work uh is is a paper that i have with a bunch of co-authors called clockwork finance and this kind of tries to give a more mathematical more formal definition of mev so here because this is something like the previous paper kind of punted it was like this is mev in english but like we're not going to define it so here we define mev as basically maximizing over the possible blocks a minor can can can produce and looking at the difference um or sorry the minor here is p this player and looking at the difference of balances in the end of the block and the beginning of the block um in in all possible future states um so the so basically it says like you have this model you have this world state you have like many different um programs essentially that can execute in the state that we model in the paper and that we model that we execute in in a framework called k basically um and then you can search the state space for like okay what is the best ballot block to increase my balance um and that valid block will be kind of the highest mev block in the system so i think this definition of mev is relatively good people say mev is not not defined et cetera et cetera there are for sure issues with it and refinements to be made but the high level idea that's captured in this math is that we want to look at the maximum amount a minor can increase their balance across a block or series of blocks given a state of the world that they can't change and all the actions they have available to them in this game and another thing we do here is we actually implement this in code and we we analyze uh for various different games that we implement like uniswap what are the optimal behaviors in the optimal blocks in a mathematically rigorous way um scales much worse than things people are doing in practice of course in terms of searching and like solving this in more bespoke ways but this is a general way to mathematically reason about what is the mev in your system okay so now we're getting more to the present day of mev a few other important milestones i'd like to share with you one of them is flashbots and another one is a blog post i wrote about a year ago or a little more now called mev what too and also at this point in our adoption curve right before we kind of reach the critical growth of mev and the end of the early adoption period we're also seeing many other startups and many other projects in the mev space so i know there are many searchers here there's many projects there's many companies that are looking to operate in this in this meme domain um and so this is kind of the beginning of the cambrian explosion i think of mev projects and so in in this blog post that i wrote i argued kind of two different uh two different sections the first was that mev is fundamental to everything we're building here in crypto and this is like a very controversial political i guess position uh or technical position i believe it's a technical position um that's not to say we can't reduce mev or make extraction more difficult there's many many talks today about that on the light mode stage also here panels about it so we can reduce mev i'm not saying like the m the exact mev we have today is fundamental but as a concept as an energy as an ability to be extracted mev is very much fundamental to these systems we're building and there's there's three reasons for this so the first is transcriptability we want cryptographic transcripts that tell us about the truth of the world and we want these transcripts to be machine validatable we want them to be able to be read by a machine that then tells us something about the state of the world right so this is how we achieve decentralization is by being able to audit the system by being able to audit minors in the system and we achieve this by having a transcript a cryptographic transcript that we check of their behavior um once you have transcriptability and you have a cryptocurrency you can also condition a bribe right so you can say give me one transcript i'll pay you this much if it's this kind of transcript but for this other kind of transcript i'll pay you this much and the fundamental fact that we all have different future states of the world that we prefer subjectively i might prefer s1 you might prefer s2 you know other people might prefer s4 and we have different values on these states and the fact that we can make these transcripts to show what state did we actually get to those two things combined create this mev ecosystem of basically bribing people who are responsible for determining the state for selecting a specific kind of collapse of this potential energy so that's kind of what we see in with minors across all domains today so that's transcriptability there's also interoperability or trust so the idea that we're going to have one single blockchain one single trust domain is ridiculous we have many blockchains many domains with many assumptions we have many domains that aren't blockchains that are in the centralized world or even outside of technology entirely and these domains need to interoperate they need to communicate information and economic value across each other this information moving across these trust boundaries needs to be kept by trust at the edges of these systems somehow and that creates mev right how does cosmos communicate with ethereum who is responsible for that message to get past and if that message is valuable who gets to be the first one to talk after that message these are all questions that come from these different trust domains executing in parallel and the last is permissionless design um so permissionless design is speaks to the fact that we want to do things without without needing to pick who's going to do them right and the way you accomplish that in crypto is you put some money on the table and you hope someone will take it in the world and it works really well as we've shown with those bot graphs and like the 10 pga bots in one week it works extremely well and people want this ux pattern right so if you want this ux pattern of permissionless design you don't want to choose a liquidator you want anybody to be able to liquidate you and you want your protocol to work um you don't want to choose a liquidity provider you want anyone to be able to provide liquidity and you want your trade to be executed these are patterns that inherently create muv and along with these patterns we kind of issued a bunch of suggestions about what we think various categories of actors should do so adapt developers think carefully about mev users understand your mev and like demand that your adapt developers are thinking about it l1 and l2s have to be redesigned with mev in mind first so if you're doing an l1 and l2 and your strategy is like okay we're going to think about that in a year we're going to outsource it to flashbots great i mean we're happy to help you do research but like seriously you need to be thinking about this in-house and like from the design principle stage of your protocol if you want it to be a good ux especially if you're building defy on top validators extraction i believe is critical to the continued security of blockchains having asymmetries in which validators extract or not is a centralizing force to the least ethical validators in the space so everybody needs to be able to have access to their share of mev and for everyone else try to mitigate the negative externalities on the rest of the system so don't create contracts that incentivize the network to be spammed don't create bots that spam the p2p layer otherwise affect quality of service for users don't attempt to civil the validator set or mess with finality right like these are important norms for us all to have as a community even if we want to make money because it doesn't it's not meaningful to make money if we're destroying the pie in the process right so another another thing that happened in response to this is obviously the birth of flashbot so this is an effort i am a co-founder of along with four other co-founders it's a pretty uh started as a distributed research group now is also a product-facing company as well as a research group um and flashbots really has has three uh mandates that were laid out in our founding post on medium called front-running the mev crisis um and the three mandates are to correct things that are like obviously wrong with the mev space the first is to illuminate the dark forest so provide information to the user which they don't have and which is opaque otherwise the second is to democratize extraction of mev so make sure every validator and every user has equal access to the benefits of muv so that it doesn't become a gay cap centralized system owned by you know jump trading or ftx no offense you all in the audience from those places but i'm going to call you out and distribute the benefits of this mev as well to the users of these protocols so i feel like flashbots has empirically done the first two things actually very well and the third is kind of the next phase that we're starting to enter now um in our in our next products and next efforts all right so now we've gotten to the present we've crossed this gap in the mev curve and we're at the point where mev i think has achieved critical mass the fact that we had to accept like only 20 of applications or whatever for this event is like proof of that like we can barely contain uh mev anymore it used to be like five people in a room now it's not right so at this point we're at the point where mev is guaranteed to affect um the space and the world outside of our consciousness here and outside of our efforts in our community and that's a kind of unique place to be because we get to define now as a set of early adopters what this means for the rest of the world and what we want these norms to be for users for people who aren't users of the system for the entire world other than us and so that starts here with mev day and with the conversations we're all going to have here i'm really excited about that and i'm also going gonna talk about cross chain mev which uh you know is uh is an upcoming kind of research topic um so as i said mev day here offers the choice we have the dark stage and we have the light stage we have the dystopia and the utopia it's still a period of great uncertainty we're still in the early adopter timeline of mev and i think it's an open question what muv will do for users in the world i think there are many ideas we're going to hear a lot of them today we're going to hear a lot of them on both stages we're going to talk about a lot of them in the hallway that being said you know there are many actors here with many different goals and so what will be the outcome who can say it's up to you all a particularly poignant warning for me v day and for the state of the world today is this cross-chain mev formalism uh and related results that we've kind of laid out in our cross chain mev paper this is something i really hope to discuss in depth with many of you but at the top here we define mev across two domains i and j and we basically say look at the actions that a minor any minor the ideal minor can take across both domains and add the the the kind of maximum mev in one domain to um the pricing function times the maximum mev in another so you need a pricing function because you need to calculate the utility in one single metric and if you maximize this joint utility over here you basically end up with the optimum mev extraction across two domains what does this mean this means that there's a high incentive to collude across two domains executing this kind of mev extraction this kind of trade probabilistically across domains you don't control comes with risk makes it less efficient to do the most efficient way to do this trade is to fully control the sequencing of both domains and to do it with no risk whatsoever this also becomes analogous in a way we lay out in the paper to the market making game which wall street has particular expertise in so this is a very kind of scary prophecy for the multi-chain world it also means you cannot abstract away chain security so chain security is intricately linked to every other chain that economic activity is occurring on so it's not enough for eth to be decentralized if solana is not if binance smart chain is not and the incentives there are not this will be a centralizing force on the eth validator set as well on any other l2 um strong block chains will rear weak ones you know all sorts of doom today prophecies happen in this world so we really need to think carefully about the implications of this cross chain mev and build very very carefully around it because this is extremely dangerous for the space and has a huge centralizing potential in my opinion worth noting that we're here talking about all this decentralized mev but what we still don't know about is what the f the centralized exchanges are doing in our space um you know it's well known in the rumor mill that many of these exchanges are their own users market make their own exchanges do all sorts of things that are like very verboten in tradify right um and so to what extent are they profiting to what extent are they extracting value out of their users we're talking about dex's uniswap the biggest source of mev as a one billion dollar per day ecosystem and centralized exchanges in crypto as a as a very opaque poorly policed 95 billion dollar a day ecosystem the the mev of centralized exchanges is massive and because of this slide it will affect decentralized systems as well we're already seeing this through coinbase starting to validate we're already seeing this through binance starting to to validate and have a chain ftx having solana as a chain gives them a good position in this cross-chain muv world right so there are many centralizing forces here and we have to be very careful as a community of how we respond to these things okay so what do we do next let's talk about the future um so as i said to you here we're really sitting on the precipice of centralizing all of crypto through mev this was the warning of mev that i talked about earlier in the slide it's still here it's still present i'm here to tell you like this is something you need to be thinking about and we now face a choice so my opinion is what do we do next the first step is to attain understanding so do more research about the future engage experts from all over the world outside of mev economic experts political experts um sociological experts let's take this technology beyond just crypto native people and beyond the kind of casino-style video game that we've built on top of it today not that we can't keep elements of that but we need to do more as well and preserve the decentralization of the space this is something you need to wake up every day look in the mirror and say preserve the decentralization of the space because it's dangerous we're playing with fire here and like it's not a joke like these technologies are important for humanity right and we don't want this room of people to be the reason that we lose this property that would be very sad now that doesn't mean that's why everyone is here is here right maybe you came to get some alpha maybe you came to figure out what flashbots is going to build in the next version maybe you came to make money maybe you came because you're starting a company and you're like wow that's a whole nice centralized pie we have there would really be better if we owned it you know um so these are very strong incentives in this space very strong incentives in this space and you know you have to ask yourself are you on the light mode or the dark mode here and i think people will be watching this very carefully certainly i will be on the various actors we have here so these are two conclusions i had from my talk like three years ago about mev four years ago four years ago wow time is like horrible um so conclusion existing dex designs are inscrutable was the word i used for the poo emoji and while we're sitting here in decadence at conferences at the time in prague real users are losing money um and i would posit that both of these things are still true today so we haven't really progressed so is the mev meme good or bad for the world is it good or bad for the other six billion people on this planet who are not in this 800 person set of highly technical crypto native leaning technologist biased uh subset of people is it good or bad for the world right now it's headed towards the bad like i'm going to warn you all like people are not going to be happy right like so let's clean this up really so really it's up to you light mode dark mode where are we going in the future it's not up to me anymore i've done what i can here you know it's up to everyone in this room and you know think about it think about it tonight think about it tomorrow think about what you're doing every day in the space and how it's contributing is it centralizing is it decentralizing is it exploitative is it fair these are important questions to be asking yourself so i leave that up to you and that's all i have today thank you so much for listening and for coming to mev day can't wait to talk to everyone out in the audience 