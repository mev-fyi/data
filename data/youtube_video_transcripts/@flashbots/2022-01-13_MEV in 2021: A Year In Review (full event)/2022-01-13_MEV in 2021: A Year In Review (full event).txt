all right hello can you guys hear me i mean people on this call can answer in the chat sweet all right let's get started all right hello can you guys hear me i mean people on this call can't turn the chat one second okay i'm back let's get started all right before we start real quick i want to welcome you all here uh and on the youtube stream as well thank you all for for joining um this is the agenda that you have here but before we look at the agenda i just want to say this event is meant to start more conversations about these topics rather than to state things unequivocally or state facts without any kind of invitation to contest them so you know this is a relaxed event and please do take what we say as points for future discussions and conversations right you can see the the schedule here um with four four presentations a fifth one by hastu in that second section followed by questions so we'll do questions at the end rather than after each presentation uh the reason for that is for for time constraints uh so please post your questions on youtube on wherever we'll collect them and then at the end we'll we'll address some of them um hopefully we'll be able to address all of them but i i i doubt it so in which case uh we'll pick some all right all that being said let's get started with the first presentation so i'm even 21 survey um i believe that youtube chat work works uh shinran if you want to check actually i did send a message there all right sweet sweet sweet all right before i start is everything good because i can't see youtube etc no problem people can see the presentation right there is a delay that's that's uh normal um cool so let's get started hello everyone i'm alex i'm part of flashbots researcher at flashbots i want to talk about mev uh it's growth on ethereum and never changed in 2021. i want to focus in particular on the chains mentioned here so ethereum bsc avalanche and polygon um the reason for that is purely because this is the chains uh i was lucky to get data for there would definitely have a change where maybe exists uh and so this is not uh to say that these chains in particular have a lot of mev and others don't but this is just the chains that we're gonna look at for 2021. um and let me put a timer all right sweet so first before we kind of dive deep into it and i'm sorry this has been you know probably hammered on you a few times but it's definitely important to think about what's mev right in particular what's relevant to this presentation and what i want to address is uh this debate that has been going on a while back on uh twitter on uh whether arab is mev right so there were a few a few posts about it a few tweets about it uh and people kind of debating on both sides with their arms around me going on this is this is crucial for the rest of the presentation that's why i kind of want to talk about that so so really what's what's muv right um mev is maximal extractable value this is what the three letters m and e v stand for so an informal definition so i'm looking for my mouse uh an informal definition of that um is the one that's stated below mev is the total value that can be extracted from the ordering censorship or insertion of transactions within a block being created so this is kind of a little abstract um and so um another way of looking at this is that mev is quantifying an incentive so the the incentive we're quantifying is the incentive for someone to influence the ordering right so when we're talking about extractable value we're talking about the value that one can extract from influencing the ordering and so what mev represents what the val what this value really is it represents the incentive that one has from influencing the ordering so going back to whether arbitrage trades or a mev um well you know looking at it from that lens i believe yes they are and i would make that claim for all the networks uh that were mentioned at the beginning of this presentation um so yes i think they are they are mev uh because arbitrage trades are finite um they're capacity constrained and so when several people go after the same opportunity there is um value relative to the ordering that actually goes through for these trades whoever goes first actually makes the opportunity assuming that they take it all and so there is an incentive to influence the ordering and so what we're trying to quantify with this is simply the incentive the financial inception that one would have to influence the order all right now that we've uh fixed this let's go back to our mev 2021 on these chains all right let's look at some numbers but are you welcome to argue this definition i'm happy to talk about this more of course um so in 2021 at least 500 million uh dollars worth of media was extracted on ethereum bsc avalanche and polygon thanks to the great people who gave resources here below and i'm going to talk about this more so first i'm going to address something where we do have a dashboard that we released a while ago called the movie explorer and in there there's a bigger number than this the reason for that is that there are many misclassifications when we released uh the the dashboard and the code base behind it and we've been working very hard in particular the team mentioned here the data team and the team working on rev inspect pi has been working very hard at correcting those so this is a much more accurate figure that encompasses um correcting a lot of these mis-classifications so to add even more disclaimers to this 500 million number this is incomplete so it is very much a lower bound that's why you have at least in front of it so liquidations if not be counted in on all these networks and some time ranges uh for some of these numbers here on for example avalanche and bsc only partly for the whole year so it is really a lower bound um and the methodologies to quantify this are also slightly different i'm going to talk about that a little more finally it's not homogenous in the sense where um 100 million worth of mev extracted on one chain might represent something different than another chain in terms of who this incentive is for and why and that's also important all of that being said this is still 500 million dollars worth of value that has been extracted from these networks in 2021 and that people have made as real money um so to to kind of uh hammer that point of the lower bound we talked about extractable value a little bit earlier right and this is extracted value so this is a good way to kind of see this extracted value is is this concentric circle extractable value is all the value that could have been extracted and the maximal extractable value is really this boundary here that's really what this is i mean it's all inside as well but it's all of this right and so where we are when we're talking about that in this presentation is really like this smaller circle this lower bound of something that is bigger and that doesn't include everything but it's still a representative amount and that's why i wanted to bring it here and so another way to state this term here at least 500 million worth of mvp was extracted is this um so put another way in 2021 uh the incentive for someone to reorder censor or insert transactions in blocks produced on ethereum bsc avalanche polygon was at least 500 million dollars um which is cool to think about and we're going to kind of get into why it's cool more but first let's get into a split uh in particular we're looking at a split enough of the whole year because again there's some numbers that we don't have but we're looking at a split from august 1st to december 1st 2021. um so the split that we have here is the following um we have bsc that about fourteen percent polygon that's about four point five percent avalanche seven point seven percent and ethereum still the lion's share uh seven seventy three point five percent for these five months right but what's really striking here is that there is a non-trivial share of this uh pie chart or donut doughnut chart um that is not ethereum so although mev has traditionally been thought as a concept that is very um substantial in ethereum this clearly shows that mav extraction is happening in other places as well um and that's very interesting and that's that's that's what i want to focus a little bit more on um so let's dive into that more and let's dive into why right like why uh are these things here why have they been growing maybe as well all right so there are two main reasons i want to talk about in this presentation um the first one is the growth of decentralized finance right and i'm going to use tvl total value lot as a proxy for growth don't kill me for it i know it's a flawed metric and i know there's a lot of other things we can look at exchange volumes etc but it is a convenient one and i still think it's very representative again open to arguing this point so this is the tbl of ethereum by defy lama which is stands at about 150 billion and this is from uh the great team uh building mev inspect pi flashbots the accumulative extracted mev not only 2021 there's before but it goes up to about like 400 and something million uh and it starts here at around about like 36 million um and so this this doesn't tell us much right now but this is just um the tvl of ethereum and extracted mvp there now let's look at uh polygon this is polygon's tvl it is in usd we can look at it in matic but it looks very similar um and so it's 5.17 billion but what i want us to particularly pay attention to is the fact that really the tvl kind of started picking up may onwards right so now if you look at the the extraction numbers on polygon in particular we're looking at the numbers provided by marlin uh not unsurprisingly we can see that i mean the extraction kind of started happening between may and june right so it's it's pretty obvious to look at these two things but it does give us a clue for why there would be more mev extraction activity uh somewhere else than ethereum right because there's tvl and tvl implies financial activity financial activity implies the existence of inefficiencies and opportunities that our capacity capacity constrained sorry finite like arbitrages um so now let's look at another chain that we talked about right avalanche avalanches 1089 billion again the number of matter is a little bit less in this context it is more about looking at where their tvl picked up so here we can see you know mid to late august their tvl picked up what happened then they launched their yield farming program which i don't remember the name of but that was august 18th right now let's look at numbers given by the current people of parsec in particular wills thank you will uh of quantifying atomic arbs on avalanche um and we can see it's kind of dead in august so the numbers it starts here starts at 1st of august 2021 we can see how there isn't much happening and then starting pretty much september or mid-august this is where we are this first of august things really picked up so this really coincides with the yield farming program that was started on august 18th by avalanche and again it coincides with a large increase in their total value lot again uh we can see a pattern there where there is more financial activity in other places uh hand in hand with that comes mv extraction activity so again doing a similar thing looking at bsc the the tbl here is a little bit more skewed so i did look at it it'd be in in in bnb directly so you can see there's this in usd it implies you know the price rise of bnb which we don't necessarily want uh to look at and so here we can see actually the tvl grew before right but really it most of its growth happened around may onwards i would say uh looking at this and so looking now at data from eigenfire who were very very kind in providing this data and um i invite you to check them out again this starts from the first of june because they did not have data before that but you can see basically uh a lot of energy extractions from there so this is less representative of the point i'm trying to make but i think it's still very interesting data so this is reason number one reason number one is the growth of the centralized finance on other chains inevitably means there exists inefficiencies in these places which then in turn means that there is mev to to extract there now the second reason is that the mev game on ethereum became harder to play um and luke is going to give an awesome presentation after my presentation on this so i won't go into any numbers because i would leave it to his presentation but i'm i'm going to give some anecdotal evidence uh they were provided by by robert thank you robert uh for providing those um and so what do i mean by the dmv game is harder play right what i mean is that uh being a searcher being an mbv search on ethereum became more competitive so these are for example extracts of tweets where any of these searchers are talking about optimizing their code even more by writing an evm assembly instead of writing in solidity so that they can like optimize their gas efficiency more and so that they can win the auction um by doing so um and you can see you know again this is anecdotal evidence luke is going to have much more concrete data but you can see how these dates kind of match up with the dates that we were looking at as well right and so um another example of for example like the mev game becoming more competitive on ethereum is pushing the limits of energy extraction and having orbs that are much longer for example which implies like more sophisticated models and also more compute that is more like latency sensitive um and another thing again by any sensei and again july around the time that we looked at these other chains like gaining a lot of tdl and imev extraction happening there more frequently um this is another kind of optimization technique and things there that i believe luke will talk about so we have two reasons right the first one is really that tvl grew in other places and so obviously they're the existence of inefficiencies there but the second thing is that uh mev extraction on ethereum became so competitive that um a lot of searchers prefer to go to greener pastures right and they migrated from ethereum or ethereum only to other places where they still have an edge and where they don't need to compete with people that optimize their software a lot another thing is a very interesting movement of developers and of traders right and so what do i want you to take away from this very short presentation a few things um the first one is that 2021 is the year movie extraction and ethereum not only grew clearly there was a lot of energy extraction and ethereum is still like 73 of it for the year uh at least for the last five months of 2021 but also became competitive and that i think is is a very interesting fact to to reason about and because of this fact right and combined with the d5 growth whenever places this has led searchers any researchers to much greener pastures um and so why this is interesting in my opinion at least is because we can now compare the activity the med activity and the negative externalities that might come from it on these different networks and so instead of purely looking at mev extraction on ethereum only we can now look at it on polygon on bsc on avalanche and i'll never change that weren't mentioned in this presentation like solano like terra that have you know 10 or 15 billion tvl as well and surely have inefficiencies in their systems as well and so this is what the next presentations are going to be uh about as well they're going to um so i'm i don't necessarily want to give away the topics of these presentations but it this is why i think this is interesting the second thing that i think why it's interesting is i think it makes designing protocols with mev or adversarial behavior assumptions in mind a lot more relevant than it once was so a lot of assumptions that a protocol designer would make in the past where it would be more like tail end cases now would happen much more frequently because i think it is more likely to assume the presence of med searchers that are economically rational actors trying to influence the ordering on these networks um so this was like a very very quick overview of mev on some chains in 2021 and the message that i really want to communicate is the one that i kind of just described in this takeaway right and and the other presentations will kind of continue building on that message but so what's next for 2022 well clearly if you all believe in the message put forward so far as that enemy extraction is probably coming to a chain near you um and that this movement and this movement of searchers actually going to our chains it's probably not going to stop and so we should think about the implications of that all right i think i'm says 15 minutes here i'm within time kind of so thank you for listening i hope they gave you some food for fall i am happy to talk about any of this more so please talk about this on the flashbacks discord maybe your research channel otherwise please email me or dm me on twitter i also want to shout out to all these people that provided data on short notice so most of the data here was provided by by others uh so par second will it parsec eigenfire modern protocol who took the code at mevinspec pi and forked it to run it on polygon and made some changes to it uh and the awesome evidence by mev inspect pie team um luke who is part of that team speaking in the next conversation in the next presentation um all right that's it thank you very much uh i'll leave it now to luke luke if you want to share your screen we should be able to do that um okay one second let's see it's gonna stop yours i can stop okay and is it meta it's showing my background yes and did we see the wrapped yes awesome okay cool i'm going to keep video off just because my internet's a little constrained right now but hopefully we should be all set through um awesome so how's it going everyone my name is luke and i am here to talk about uh ethereum mev and ethereum in 2021 this is your 2021 ethereum mev route uh unwrapped by media inspect um alex has already shouted us out a decent amount but um like we said the data is from mev inspect pi which is our open source block inspector at flash spots you can find it on github if you want to play around with it yourself um or if you want to contribute um or just uh have questions on how to run it come check this out in mvv inspect in the flashbots discord so let's jump in mev on ethereum in 2021 so it you know it's no secret that mev got a lot bigger in 2021 on ethereum in particular um from our numbers we saw over 400 million dollars of extracted value on me on ethereum in 2021 and this excludes sandwiches which we know to be another uh several hundred million dollars of of extracted value there's a huge amount of activity going on to quantify it a little bit more from a totals perspective we saw 1.6 million arbitrages 809 000 sandwiches and 20 000 liquidations in terms of minor payment uh over 300 million dollars of that went back to minors just in terms of payment for priority to place these extraction opportunities and so while it's interesting to see all these numbers kind of going up into the right and seeing mbv growing as a space in general what i think is more interesting when we talk about uh 2021 is what alex is mentioning in that introduction which is about the competitiveness and the sort of changing the landscape of mbb on ethereum through 2021. so let's dive into that a little bit so here i've got a chart and on the bottom on the x-axis is going to be the percentage of profit that was paid to a minor and so uh let's say i make one dollar and i pay 50 cents that would be a 50 payment to the miner that would be that 0.5 that's getting pointed to you right now now on the y-axis we're going to have the total number of opportunities that paid that percentage of profit to the miner so it'll be a graph over time graph showing basically the percentage of profit paid to minor spread out how much are people basically paying and we're going to look at that for different time segments sort of early on then going later into the year so looking at march to may we can see that in terms of how much of profit is going to minors from extracted opportunities it's relatively flat so there's obviously an upward inclination towards you know points towards like 60 to 90 or so but there's not a ton of agreement on how much money searchers should be paying as profit to uh two miners and also there's uh there's also a potential sorry i was checking the chat for a sec there there's also um you know a lot of discrepancy in terms of the actual gas usage of the different contracts that are executing all these transactions so we see basically this this relatively flat uh um distribution in terms of how much people are paying and we even see this little section near the bottom where people are paying virtually no money back to the miner in order to extract arbitrage these are these are definitely the good old days early days of flash spots uh sort of taking off when we fast forward to mid august there's a noticeable change happening already we can see that in general miners are or in general searchers are sort of centering around 80 of profit going to miners with some a little bit over a little bit under people who are historically paying maybe uh you know a little bit over 90 95 are now pulling that down because they realize they can still be competitive while paying less and then people below uh 0.5 or below 50 percent are bringing their payments up in order to remain competitive and unfortunately for those people who are paying zero they're now out of luck they're getting out competed by people paying a little bit more and of course there's an interesting trend that we can imagine happening here let's say that i'm about sitting solidly paying 80 percent maybe i decide okay um i can make i can i'm leaning on chain maybe 25 of the time with the opportunities i'm trying to get and maybe if i pay a little bit more i can beat about the guys who i'm competing against so i'm going to bid a little bit more but then of course they're going to get upset get themselves a little bit more etc etc and so it's natural for these little sort of inchings forward to lead to the price increasing overall for everyone if you look at twitter from that period of time you can see this is a famous searcher xerox on 9-1-1 saying uh we often see basically with a long thread talking about how bribes will potentially may or may not converge on 99.99 of profit over time and then mbv intern actually calls out that uh the searchers have been in the flashbots discord chaining bots that are bidding way too high up basically saying hey you're ruining it for the rest of us can you pull your bids back down and be a little bit more competitive on gas features things like that but unfortunately shaming and the discord only goes so far um if we look at august october now we're well within the 90s in terms of percentage profit paid to minors if we look at october to now a continuation of the same trend up into 97 of minor payments so a huge push upward throughout the year is competitiveness increase another way we can look at this is just total search of profit versus minor total minor payment over time there's a clear trend towards minor payment um and so this is talking about when we think about minor priority how does a minor choose which transactions to prioritize in their ordering it's they think about dollars per gas they have a fixed amount of gas that they can put within a block and they want to maximize the amount of money that they're making based on that amount of gas and so this is talking a little bit about the money so if we had the same contract who's paying a little bit more but there's this whole other half which is around the gas optimization as well so let's dig into what the data looks like for people doing that over time as well so here's one situation that alex alluded to a little bit there's two ways that you can pay for you can pay the miner for your priority you can pay either in fee which is sort of the traditional way that people use ethereum you pay fees to the miner which post uh one five five nine or a base fee and then some optional tip amount or you can pay it by something called the coinbase which is basically a direct transfer of to the miner's address and so there's a lot of reasons why you might want to use coinbase over tip and with the adoption of flashbots increasing in april and may you can see that there was a steady increase in people using coinbase which is the red section but then as searchers got smart and competition increased there was an alpha leak that became common knowledge that using gas price for your minor payment is a lot more gas efficient than using coinbase transfer and so as a result we can see in the data uh kind of post that tweet the adaptation back people switching uh from using coinbase back into using tip and it actually came at kind of a nice timing because um i think probably two weeks later was uh eip1559 so people had to go on and change their logic anyways in order to support the base fee so they probably thought well if i can get a little extra gas by switching over to tip instead of using coinbase i'll just do both at the same time and we'll kind of check both boxes so uh alex already shared these shout out to robert two for being the tweet provider for uh for all of us these are uh these are some good ones um so yeah increasingly we see competition around gas usage in general and one interesting question you might ask is can we see this in the data then can we see the efficiency increasing for people in terms of gas usage every time when we look at mev opportunities and i was actually on this for quite some i was on this for for a good hour or so uh confused check out this graph so this is the weekly minimum gas used by any arbitrage you can see there's this giant spike that happened uh uh here around uh august uh it's right on august 5th is what it turns out to be which is known to be the eip-1559 adoption day but it's also the adoption of eip 3529 which is a reduction in refunds so it used to be that you could do all sorts of self-destructs on contracts and other sort of gas manipulation techniques in order to reduce the amount of gas that your contract uses and so people use this to the absolute maximum and then when it went away the floor in terms of what was possible in terms of minimum gas used had a huge bounce up this this makes it this graph makes it relatively obvious but the sort of graph that oh and here's you can see the decline that i'm even inspected sees on the number of self-destruct calls that happened just to trace calls so people associated with me the opportunity so basically now that there's no benefit there's no one doing any any of their opportunities here's a graph where i was looking at it it was a lot more confusing but so you can see still that little pivot around august 5th um one interesting thing though is we can see that beyond that point of august 5th there's there's a rough flattening happening so you can see the markets somewhat sort of reaching a point of you know max efficiency in terms of extraction of arbitrages um but you can imagine maybe the trend adjusted for that this is not a mathematical adjustment adjusted for the uh for that eip change looks something like this and it trends a little bit more like what we would expect similarly for sandwiches they have a little bit more of a dramatic situation you can imagine the continuation absent the eip change would keep the downward movement of gas used but again we see that really solid line in terms of people reaching sort of maximal minimal gas usage for extracting the opportunity so i want to talk briefly about a couple um i want to drill basically into two types of mvv extraction arbitrage uh to start and see some of the unique things that happen uh with arbitrages so here's total arbitrages over time extraction is about 10 000 arbitrage dollars a week on ethereum at the moment um with a slight decline recently and one of the interesting things to look at with arbitrages is the share of profit that's uh being split among searchers so for the year of 2021 this these were the top searchers in terms of net profit that we found and how much money they made and the percentage of the total profit of all extracted arbitrage value that went to them so we see some pretty large numbers here 5.9 six percent etc um so it's kind of a small handful of people who are really deep into this uh who are who are heavily optimized for this competition basically um here's another graph showing that this is a graph of how many searchers split the top 95 percent of profits so if you said let's take off the five percent tail of remaining people who maybe landed one arbitrage throughout the year uh or throughout the month this monthly batch um how many people does it take to fill that 95 percent we can see that uh it's roughly doubled over the year uh a little maybe a little more than doubled from about 20 15 20 to 50 40 to 50. here's another interesting angle look at arbitrages from is the number of hops in a captured arbitrage so you might think that there's sort of competing ideas here where you might think that because uh people are getting smarter and smarter they might capture longer arbitrages but at the same time the gas used the profit amount from maybe if i have an arbitrage featuring swapping from one pool to another to another versus one pull to another and back the profit might not be substantially different enough to justify the gas cost of that additional swap and so we can see that there's a relatively substantial increase in two swap arbitrages as compared to the rest of arbitrages although i am happy to say that um since uh since that slide that alex used was updated there has been crowned a new winner of the longest arbitrage on ethereum at least that i've found so far which is 14 hops um so thanks to mvb inspect for crowning match champion congratulations um now i want to talk about sandwiches a little bit so here's a graph of sandwiches over time this is total sandwiches by protocol and this the state is not as clear as we might like it to be it's this we group all unisloppy um protocols to be into the same bucket so sushi swap unit swap v2 pancake swap etc would all be considered that unispot v2 pair we can see that the vast majority of sandwich activity happens on um those markets like compared to something like union spot v3 which has activity but substantially less so looking at this around april which is sort of the take-off period of flashbacks adoption in general you can see that there was a rough doubling of sandwiches uh in general and then around and then on may 5th which is the spike at the spike of you know swap v3 pool adoption with the launch of v3 there was a fairly immediate transition of liquidity from v2 you'll have to excuse this my photoshop abilities this is v2 liquidity unit swap v2 liquidity over time um and you can see that the drop the drop in liquidity from unispot v2 correlates pretty heavily with the number of sandwich attacks happening overall in the network and still even as unit swap v3 overtakes v2 in terms of total liquidity um it still uh it doesn't sort of compen it doesn't become the larger source of sandwich attacks basically saying that new swap v3 is actually more resilient to sandwich attacks it seems it's pretty cool something else to look at in terms of this decline in sandwich detects over time that we're seeing is miners and how they're thinking about front runners and sandwich attacks back in october ethermine announced in the flashbots discord that they will no longer be processing bundles that front run dex trades and so we wanted to take a look and see here's all the major minors and based on divided up based on how many sandwiches they've processed over time and so you can see ether mine here sort of holding strong to their commitment uh around october there was a really substantial cut down in the number of sandwiches that they processed and they've since i think been refined and it's an approximate you can't just it's hard to detect sandwiches so it's not the sort of thing they can just flip a switch on but it looks like they're getting better and better at it in terms of reducing the number of sandwiches that they're processing um and it doesn't look like we're seeing that amongst any other large miners that they're deciding to cut back on sandwiches quite yet in fact it looks like f2 pool is taking most of the capacity that used to be attributed to ether mine i want to give one last shout out just to some of the other mev uh that has been extracted that wasn't mentioned um there's been all sorts of long tail mev such as um salmonella attacks which are attacks on sandwich bots just in time liquidity ads all sorts of nft activity um this is there's there's definitely been a lot more than what we've had the ability to share here that happened in 2021 but i think we're looking forward to new additions to muv inspect by in order to be able to analyze that going forward in the future that's what i have thank you awesome um supra super gear if you're here do you want to share a screen uh your mic is very quiet uh yeah am i audible no yeah now yes now yes okay so sure i'll share my screen [Music] sorry your your mic is still a little uh i don't know if you're speaking too close to it we can hear you properly but then it feels like you're you're breathing on it very closely try speaking like a relative distance to the mic compared to before sure um is it fine now now it's fine yes yeah i know i'll just try all right i believe he left the call let's just wait a second for him and then uh if not ward i'll i'll ask you to go in the meantime i'm sharing my script can you all see the yeah right i hope everything is sorted now i'll just try again okay so let me share my skin um yeah i think sure so is the presentation visible right now yes it is thank you and your mic also sounds a lot better so that's great yeah yeah so hello everyone i'm super girard developer at marlin and today i'll be discussing the case the brief of m v on low fee chains uh with focus on polygon pos chain so uh just a general outline of the presentation what i'll be touching upon as topics in this format now first uh i think i'll be discussing on why we chose to analyze and help facilitate mvp extraction on polygon pos chain and what was our motivation behind the choice um also next comes a few stats we have uh regarding mav on polygon pos chain also we will be discussing a few modifications that we did um to mayb inspect five to help with our analysis of mmb on hydrogen robot chain uh for us that's polygon um i mean our modification of bohr client for uh polygon akin to i mean we get in ethereum to facilitate mev extraction will also be discussed um then we will touch upon a few concerns that we have seen in uh polygon with respect to the adoption of mav4 uh we further also discuss um the steps that we are undertaking to alleviate all these concerns and finally i'll wrap up with uh how we think we'll be going forward uh and the next steps so the motivation of trying to solve the mvp problem analysis and facilitating the extraction of mav on polygon people's chain uh was primarily uh because there was a large d5 ecosystem currently standing strong on polygon so polygon pos has currently over 3000 d apps and around u.s dollar 5.5 billion logged in all of these endeavors and of course so in fact a lot of well-known d5 platforms such as away quick swap balancer draw the direct parallels from ethereum counterparts and polygon pdos is also evm compatible so bot writers and searchers would have easier time putting their systems onto polygon if they have already invested that time building on ethereum so how big is it uh we know that out of all the mav that's extractable a fraction of it is actually extracted and yet another subset of uh that is identified by various method of analyzing transactions so flashbots methods uh implemented in mvb inspect pi and earlier the rest version of software also showed somewhere around 897 million us dollar of maybe extracted over a period of two years from january 2020 to till now so running a similar albeit modified version of the same system on polygon yielded us somewhere around 37 million dollar worth of meb uh since january 2021 uh till october 2021 and that only includes uh unisoft v2 based swap based arbitrages so also tbl on polygon primarily grew uh in may 2021 as alex showed so the 37 million is far underestimation of maybe that's been there and extracted on polygon so here's an example of what blocks and things look like on um on polygon scan here we can see an example of these transactions on polygon pos all of which technically spam that stain in order to extract med at least as of now since polygon gas v is quite low successful extraction more than compensate for any reverted to transactions or any unsuccessful mev extraction attempts so prima facie evident that spamming happens on polygon and race to extract mvp so we can ask ourselves how big is this problem really um and how we get this problem really for platform as a whole so we did some analysis to find numbers pertaining to this for a lower bound we try to classify the transactions into whether they have interacted with contracts which we know for certain have at least one successful uh chance of extracting the maybe using arbitrages over a span of hundred thousand blocks and that's a lower bound and that is around forty percent of the transactions that we see in in this hundred thousand block span on the upper and upper end uh we try to isolate accounts that have shown successful or unsuccessful transactions in at least three consecutive blocks means that they are spammers and these are totaled up to somewhere around 57 so hence we can see these numbers 40 to 57 percent that's a huge spamming problem on polygon pos chain resulting just from mvp extraction attempts so a few uh statistics that we want to share with you uh regarding mav on polygon on average we see at least one twenty thousand us dollar worth of emily extracted every day one of these images have been already shown to you uh from january 2021 to october 2020 uh october 2021 we see a cumulative extraction of over 37 million us dollars and that's just for units for me to contract sub-based arbitrage it does not include even the sophisticated methods like flash loans sandwiches flash swaps or use of other d5 products like balancer so all of this data is extracted from our event based arbitrage detection system which is a modification on top of mvb inspect file so let's have a closer look on how we modified the mav analysis system to get these stats on polygon so mvp inspect pi is a tool written by the flashback team thank you thanks to them um it helps us analyze the uh extent of meb post hoc using a blockchain mode so it's much more involved than the block diagram i'm showing here but and it can do much more than swaps and arbitrages liquidation etc etc but for the purposes of this discussion we will limit ourselves to the high level design of the inspector shown here at the core inspect uses arrogant or parity-based ethereum archive and it calls its tracing rpcs among other calls to retrieve the block releases and transaction receives to inject and then further classify using trace classifier and then classify the steps of the transactions into swaps liquidation transfers etc etc and swaps are then used to find cycles between tokens and if positive amounts are seen after a cycle of swaps then it's called out as an arbitrage so flash force team have incorporated a few more changes to make this system even faster for example they have implemented a new rpc method on ethereum nodes to allow them to batch multiple blocks tracing requests into a single call resulting in a lower http overhead of request and response times and also every time the tracing is done they cache it into databases so that later on they do not have to do the tracing again uh when we wanted to use this system on polygon post chain we hit with a few problems uh polygon doesn't have a parity or arrogant implementation for it it's bohr is go ethereum base um and the tracing of get is not compared compatible with parity traces on a side note a lot of evm compatible chains are quite similar um they only give one implementation of um such as these or parity for themselves like optimism gives only and we do not have choices uh whether we we should take a parody or git uh second polygon has a lot more transactions to analyze um caching may just not be feasible as dbs tend to grow a lot bigger so optimizations aside the first course of action for us was to make mvp perspective by works somehow for polygon pos and the basic need was to uh translate these depth traces to parity trace so by using uh gets caller tracer we were able to write a translation layer for mvp inspect pi and that actually translated the get traces to biology traces and once this was possible the rest of the system need not change much so um this translation layer basically based on mvp inspector i worked on polygon for us it was able to detect arbitrage's etc liquidations etc however we faced a few practical problems while backfilling our data so we ran an experiment for ourselves the archive node was running on bare metal amd system and it was powered by 5950x cpu which is 16 core 32 thread machine and even on this system when the tracing was invoked uh all the hardware threads were fully pegged 100 and we can still only manage around 1.5 seconds worth of tracing per block when the polygon pos still itself has the block time of around two seconds so this resulted in a real issue for us if we wanted to get any kind of historical data from polygon for example if we wanted to get around even six months worth of data we had to wait four months just to extract it and if we wanted to add any another inspection algorithm uh since traces can't be stored in db because dbs themselves grow too huge we have to wait another four months for six months worth of data so we cannot really catch up to the head of the blockchain in that in that case however uh while the translation mechanism posed a practical problem uh for polygon pos chain in theory the system worked well so we saw a group of students at columbia university tried our translation layer on optimism and since optimism is a relatively new system with little over one million transactions in the starting month the team was able to detect mvp extraction in excess of forty thousand us dollar in just one month that's november to december uh in 2021 for unicef v3 live contract straps alone uh the nice thing about it is that all of these uh mev extraction uh arbitrages uh required the router for v3 units rp3 uh this is also a good example of uh to illustrate that the mav exists um and is there on other systems as well so in order to solve the practical issues of using the translation layer on polygon chain we started to look for other ways to reduce the computation load one way of doing this was to perhaps use events as bloom filter so such that only the transactions emitting a certain set of whitelisted events such as swap event think event transfer event are traced otherwise they have skipped we implemented this by modifying the code for both however the results were still not very promising we got a speed of around 30 going from 1.5 second per block to around 1.1 second per block in batch racing mode however this was still not good enough for uh backfill so eventually uh then we thought what if we restricted the kind of swaps that we can detect as a startup and we forget about other kind of results like liquidations for the time being um can we then use events themselves which we were using for bloom filter as the data source for swaps and then detect arbitrages from them so if we concerned ourselves with only unit swap v2 at least we can do so by using the statements it turned out plus a few each calls were required then this is also results uh in us not needing a large uh archive node anymore so we replace the tracing component of m in spec pi and implemented direct conversion of events to swaps um the results were quite dematic uh not only did the size of polygon node ready use uh we were also able to backfill the data for entire 2021 japan to october in just around 36 hours this is where our statistics stem from however as enunciated before this system has limitations the biggest one being if there are more complex mvp extraction techniques the component data of which may not be derived derivable from the even data the system does not really work well we are still working on it um let's move on to the next part of our presentation on how marlin attempts to facilitate extraction of mvp in fashion similar to how flashbot fits in ethereum ecosystem uh we modified both the evm compatible get-based component of a polygon pos node setup akin to mav gas we added support for bundles and brought forward the following features uh maybe both promotes the manpool transactions and bundles it receives from the relay for max profitability of validators such as can pay validators directly through uh the payments to coinbase addresses and our marlin private relay helps reduce a spam in bundles arriving at validated nodes by simulating it first and then transmitting it ahead along with this there is a nice thing about polygon pos chain that we were able to implement so since we know that the polygon pos chain has a system of sprint that allows us to know the validators responsible for signing the blocks beforehand we can limit the recipients or recipient validators for bundles we receive on a relay at any given point in time so this increases the security of bundles and this is an additional feature that we have implemented and is part of mbp right now so with this i would like to discuss a few practical differences between maybe get for ethereum and maybe bore for polygon and how that shapes our trajectory uh trajectory going forward so ethereum has been around for a longer time in polygon the miners on ethereum uh generally use a bit more sophisticated setup for mining uh with this for practical purposes a miner can run flashbots maybe in more of a supplemental format while uh mining block centers reduce his or her dependence on mbvs so in this slide we can see one such setup conceptualized uh the miner runs two versions of geeth uh vanilla give 10 mvp heath and the candidate blocks generated by both these nodes are compared by a system before dispatching it for mining to the mining rate uh while this may look involved it is interesting note note that even if maybe fails in this format for any reason the miner system is not compromised and he or she does not lose the hash power and the hash power isn't sitting idle so the situation changes uh when we talk about post change like polygon because there is no longer a separation of candidate block versus block that's mined eventually so a single node is responsible for signing the blocks hence the previous format of supplementing instances does not translate well into polygon pos and hence map bore needs to offer a lot more guarantees so we came across a few frequent concerns from validators who were interested in our system uh first of all they were afraid of losing rewards uh remember in ethereum uh supplemental setup there was no case where the hash power goes to waste however in since maybe bohr can only be a single instance it if it fails there's no signing and validators were afraid of losing rewards and eventually even their reputation in the network um also they wanted attestation from polygon foundation the proposition of replacing bohr with m ev4 is what leads to many asking for this the troubling part here is however that every future version of mvp board can't be can't be guaranteed a foundation attestation even if current uh version is tested and whether the mvp wore uh double signs while we made sure that the mav board only adds in a contained wave of on how more already works we understand why this concern arises and lastly unlike ethereum the private key of uh validator it's on the same system as bohr and is accessed by both so the participants hence also want some surety of not having bugs that will leak such sensitive information so we worked on a few uh mitigation things this leads us to think about a few mitigation steps to alleviate the concerns of the validators first of all we are running the locate test net for polygon that is incentivized upon our own token so enterprising validators can try maybe more without risk of losing matic or block rewards and we also want to touch upon an important design decision that we made sure to respect that we didn't change heimdal code that is responsible for us taking rewards only the bore layer is changed with mbb4 um going forward uh with all these um already done we believe this is how we should be moving forward we should continue uh improving our fork of maybe inspect buy and unravel more maybe as we go forward we are also bootstrapping me both front by running our own large validator node based on mme board with a large enough stake on polygon mainnet so we are already working closely with matic ops of validated on polygon plus chain to make this a reality and on top of it we already have 10 million matic tokens committed to this setup once this is done our rpc will soon be functional uh for people to submit bundles on our test network is open we have welcome we welcome the validators on polygon to join us and run any report and we'll explore uh avenues to analyze and support mvp extraction on other platforms bsc phantom etc but that's a long term goal for us since once we have experience building the same on polygon so that's all from my side that's how i would like to conclude my presentation we at marlin would love to have you come to our discord and say hi to us these are the qr codes you can take the snap thank you all right thank you very much as i said earlier we'll take questions at the end so thank you for your presentation that was that was dope uh ward if you're with us please share your screen next let me know if there's any issue oh yeah one second all right sorry it's taking a second um oh sorry uh here oh yeah um here uh can you see my screen right yes we can see your screen and it looks great all right awesome um yeah so uh i'm going to present on how protocol design affects your strategies and this year the avalanche network had a few changes to the core protocol um i'm gonna discuss how yeah uh what happened and how that affected uh any researchers and vice versa um firstly just for a little bit of history um i'm sure a lot of the audience is aware um before the i mean the geth was big and um network latency optimization was quite important um and it isn't as much now on ethereum but it still is on other networks um i'm going to be focusing on this on avalanche because it is still quite important and um i'll discuss it in the presentation um so yeah i'm going to talk about um how the changes in the vertical design of avalanche um drove searchers to change their methods to minimize network latency um primarily for um both receiving what like what i refer to as target transactions these are usually messages um isn't because um depending on the messaging protocol um or the arbitrage it can be created like if the arbitrage is at the top of the block or a background um i'm generalizing missing messages there um yeah um so search sorry um yeah this is what we're going to be doing uh this is obviously a very informal talk um what i'm trying to loosely do is um lay out this is hand wavy but so sort of this framework for um how messages are gossipped on these peer-to-peer networks or like message gratification um and um it's actually pretty interesting it's it's sort of similar when i was researching this it's um sort of similar to how it's sort of intuitive to how uh infectious disease disease spreads because uh if you view like a pending transaction as a um i guess the disease that that's spread by these the nodes on the period of your network um and yeah so in this discussion um these are some assumptions i'm going to make um the first one's a really big one um because like geo distribution and uh network latency and like um etc are are a very big part of um operations um but that's not that doesn't really change um based on the protocol or like with my simplifying assumptions that doesn't change um in this model um and then for certain like liveness and ordering guarantees um i'm going to assume that that two-thirds or two-thirds plus one of validators are honest um and that's safe to say because everything falls apart on a lot of these networks that's not true um and then this last one is sort of just like something relatively minor is that um we're gonna assume that um nodes or like uh uh validators on the network aren't um say like ethernet like um running their own searchers and and not like they're not running the default client um here yeah so in this next paragraph um this is obviously very informal and very rough um just a sort of a sketch of a model of message propagation or uh essay in effect because i think the comparison sort of makes sense um that we're going to be using um so first here this is this this initial state and this initial state obviously like in practice it's usually like in pure an rpc provider or some trader's local node that originates the transaction and then the messaging protocol propagates that message to other nodes on the network and so i'm going to discuss i'm going to focus specifically on how different messaging protocols affect the strategies of immediate searchers um not in isolation but that's sort of the core focus of like what has changed over avalanche uh over the past year um so this is the first i'll give you this overview of um but before i go into how the protocol changed um i'm gonna separate the state of the protocol onto three distinct phases um where the dominant strategy for optimizing um network latency was each of these here which is actually quite interesting because say as compared to like ethereum miners in theory don't have any um advantage for hearing for optimized network latency but the avalanche protocol implementation made such an advantage quite explicit in various ways over the past year um and so it led to this novel these these novel strategies for me the extraction or this novel layer that wasn't present on ethereum um and so briefly go through like the this first one is just maximize your stake the avalanche that's was how it was um initially when the network launched in early 2021 i think that's about when they launched a smart contract platform um and that's very similar right to other proof of stake networks and even ethereum where your the share of any of these should extract is approximate or your advantage is approximately equal to um your hash rate or your stake um and then next um for the next phase was they implemented a change called they called snowman plus snowman plus plus or um apricot phase four and this was due to the result or this was fixed some of the contention issues that the network previously had and the dominant strategy here was to hear about sorry to minimize the to minimize your network latency to hear about arbitrage creating transactions um the optimal strategy was to maximize the percentage of nodes you control on the network um and i believe this is very similar to how it works on ethereum um because the default number appears is i think something like 50 and i believe you could loss of the square root of the number of periods you have um and do you hear about a transaction as well as possible it makes sense to yeah uh too much to be peered with everyone that's propagating these transactions um and then this third one was quite interesting it was uh due to some consequences of number two um they only got these pending transactions to um validating nodes um and this was quite interesting because it introduced the concept of what a lot of people refer to as a private mempool which to my knowledge is not seen on other blockchain protocols um and so now i'll go through and discuss the setting for each of these strategies and work towards why they became or why they didn't make sense um so the first phase as i've discussed where the strategy is to maximize your state avex the probability distribution which i talked about two slides ago here um this is one of the key differences between each phase is when you decide who to send or who to propagate a value of valuable target message to um is decided by this probability distribution um in the client implementation and initially one of the key features of avalanche was that there were no transactions that were propagated across the network just um unconfirmed and confirmed blocks so the strategy was to maximize the amount of stake you have or one one component of the optimal strategy is to maximize the stake you have and then as soon as you hear about an unconfirmed unconfirmed block in the sense it's similar possibly to in some ways to an unconfirmed transaction on ethereum where um you could try to back run it um which is sort of what this the dominant strategy became um one thing that was quite interesting was um anyone could propose a block in this network not just validators which was pretty unique i don't know i'm not aware of other networks where that happens um and another unique feature was that there was a hard-coded gas price in the network so the only thing that mattered really was network latency um to achieve that network latency you just uh dominated this to maximize your state then in late september um there there's a funny um in like september uh the protocol changed to snowman plus plus um and one thing that remained unchanged here was um this probability distribution for you propagate blocks to but um one key there there was two key changes here one to fix the prior contention issues was that there was now a designated block producer for each block height and um you and to enable this there was now a global mempool and pending transactions with gossip across the network so back running in the same block was now possible which became the dominant strategy um and then another really important thing was that um while before it was um you started for this latency advantage you needed a large amount of stake that was no longer the case because the probability distribution for sampling sorry for sampling the recipients of penny transactions um it was it was uniform uh sampling um but across all all peers not just validating peers um and the dominant strategy now was to launch many many nodes as to uh yeah to to minimize the expected duration until you'd hear about the targeted transaction and then um now also a key change was that rather than creating a block um with your background transaction and propagating it to the network which you had done in the prior version you actually couldn't do that anymore because of the designated block producers so um propagation to the block producer became quite important and then oh here's this picture um there's a lot of discussion about this i think in the uh avalanche discord and this is just um one picture that uh someone uh thank you to the person that gave us to me um around that time um and what we're visualizing is this last bullet point um which was i think snowman plus plus release on september 22nd um and right here you can see people very clearly playing around with um launching large quantities of nodes like all at the same time [Music] which which i thought was quite interesting and then i don't have a later graph but i believe that once this no longer became viable you can see it dropped off in this chart of several hundred nodes for like a thousand so about half of the nodes on the network or at least the third from what i've was told um were used to extract any fee and what we can what the the next phase is was um for certain reasons um this wasn't um it people i think that this uh or they were saying in the discord they thought that it could have been an attack but um but for for whatever reason that the protocol then changed um it was actually quite interesting that uh over there were uh third third of the notes were running to contract and then in this most recent version um after which the protocol hasn't changed um this is what was causing a lot of interest in the community with the private medpool um was that the protocol changed such that for access to this valuable data you you know need to run validating nodes um also interestingly uh sampling is uniform not weighted by stake as one might expect um the dominant strategy is now after this to launch many nodes instead of launching um instead of accumulating massive amounts of sleep as it was in this first phase um stake now matters less than the quantity of nodes which is sort of um interesting and other than that it's largely unchanged from the original form of snowman plus plus um that's the whole presentation thank you all right thank you ward that was great um cool next presentation so again we'll take questions at the end so if anyone has questions on youtube please add them there and at the end we'll have a discussion over the end i mean until the a lot of time will finish all right next up hasu if you're with us and you'd like to share your screen let me know if you're not with us i can see you but oh yeah yeah yeah yeah give me one second i'm sorry about that where do i look at the right all right my apologies hassan try now hello can you hear me now yes tweeting this out okay share screen that's not what i clicked space market design it says no yes no it's correct okay already all right uh i'll okay um okay so is it full screen no probably not right no you have to click on the r show yeah i'm so good at these things alrighty um yeah first of all big thanks to robert and to alex our wonderful host because um i had very little time to prepare this presentation because of a busy week and not dealing well with the covet covert vaccination um but here we are and um yeah i'm ready if you are should i should i go ahead and start yes please you can go ahead and start we can see your screen and we can hear you very well perfect yes so we've already heard a lot about how uh mev extraction works on other blockchains today and i i'm just here to give you know a little summary of what we've heard today um a little overview and how these things all tie together and um so first of all why block space markets i think um good to start from a high level perspective um in in blockchains we have a limited amount um of block space we we we constrain this so people can still run full nodes and validate um the current state of the blockchain however there can be a potentially unlimited demand for that block space we've seen this on ethereum many times you know here ethereum is a whale chain uh right now i think gas fees are above 300 way so we need some way to match this demand with the available supply and that's not an easy problem um because we need to figure out two things first we need to mediate access so who gets into the block at all um and for the longest time um in crypto this used to be actually the only problem like people only care about getting into a blog but due to mvv we sort of see a secondary problem come up and that is transactions increasingly want to be mined at a specific target position so um the original problem of just inclusionary block it used to be um [Music] quite easy um people were concerned about under bidding and if they underbid their fee then they would have to wait longer for inclusion maybe their transaction would fail so maybe if they want to buy buy something from unicef and they under bid then uh the price might have already moved against them and then their transaction fails so this this happens um and if they over bid then of course they paid more than necessary so in both cases um it hurt market efficiency um and uh but it was ultimately not that hard of a problem to fix so um created eip1559 and what erp159 does is basically it tells the user how much to bid so it um it basically uh it quotes it quotes a price where if the user is willing to pay that price they are definitely getting included and that price is uh it's almost never higher than it needs to be um there's a great article by pintervale if you haven't yet read it who recently analyzed if if one five f9 has fulfilled these objectives of preventing under bidding and over bidding and he came to the conclusion that yes it has and um it's actually a really good read it shows that um a lot of uh so uh the users who today use the erp one five f9 format i.e they outsource their bidding strategy to eip10559 they consistently pay less for their transactions than those who still use the legacy type okay so now so but so block space market used to be easy but mvv has made it hard again why because we now have the secondary problem of transactors wanting to express preferences on where exactly they want that transaction to be included and um mvv is a really big economic force right so we see this is an absolute minimum amount um on anybody that has been extracted it's just like an extremely defensive gas by flashbacks but as we can see here even 800 million dollars um since 2020 and this is a substantial part of minor revenue so as a miner you can't not care about mev and so not just as a minor so uh this this is just a huge honey honey pot um too that attracts a lot of searchers and you know um financial firms to compete for these you know um arbitrage opportunities like gradations etc and as a result unfortunately of this mev extraction there we have seen some negative externalities that have risen so in the short term um we have seen like more um in this actually not very logical uh the way so this this should actually come before um so we can see that the choice of um the market mechanism it informs a certain med market structure um and we go into like a bunch of any market structures uh or market mechanisms soon and see the results and these market structures they lead to certain negative externalities and these can include ones that are quite short-term in nature so for example if you have if you have a market mechanism that allows for very finely grand expression of uh you know where you want your transaction to be mined then the result is that you can it leads to for example much more mvv extraction period right so and users might care about this specifically because it could lead to more cemetery attacks more front running you know um more exploitation of nft jobs etc so this is very problematic but if there's no way to express your preference then it might lead to a lot of wasted block space um because if you have 800 million dollars of mev on the table then it's you know searches and miners are going to go into some way to extract that money so it's just a matter of you know of how and what are the negative externalities of their approach and in the long run we have to be very concerned about concentration in both the block producer and the block builder set so for example if miners start to extract all of the mev themselves then this massively raises the barrier to entry to be a minor and really hurts the decentralization of the blockchain um to the point where there might only be one mayana who can compete because they have the dominant mvv strategy and they're all proprietary in nature but equally you can have a really decentralized blog producer set um but there's one searcher for example one financial firm that sends their blocks to all the miners um and that that firm is so much better than everybody else that they they basically even if they started censoring um some users over others they would still not that would that would they would still be so profitable that people cannot do anything against it right so miners don't really have a choice to switch to a different producer doesn't censor so it's actually really important that the market for mining and the market for searching that they both stay reasonably competitive so we know we want to minimize these negative externalities question how and the answer is via backward deduction so we go from these negative externalities we see how they arise from you know certain mmv market structures and these tend to be the result of specific choice of the mbv market mechanism and in the wild we have seen a bunch of different of those and we have some time to study them so on ethereum for the longest time we used to have transparent batched auctions uh also called pgas priority gas auctions um today um most mvp extraction has moved from pgas to sealed pitch sealed batched auctions that happen in the flashbox relay we have seen some chains for example arbitrom experiment with first come first serve approaches so they have a single sequencer and the sequencer processes transactions in the order um that they have first seen it right and then finally um another popular approach is that of randomization so you collect orders you batch them same as in pga but then you randomize them once um so i think um a chain that does this might be i'm not actually sure if any chain does this right now in the white i know it's on near's roadmap i think it's on osmosis this road map um so this is definitely like an approach that has been known for a long time and we can understand the dynamics that it would create so um we will go through some examples now of how the market mechanism informs the domain strategy and creating the following negative externalities so ethereum used to have a pga pga means um that all basically uh all of the bidding both for inclusion but also for the position in the block tended to have inside the public mempool and priority was simply mediated via the gas price that's that's why they used to call it the priority gas auction so if you wanted for example to be on top of the block then you just paid a very high gas price because miners would sort all other transactions by gas price they had this very simple uh sorting algorithm basically um and if you wanted to if you saw a transaction and you wanted to front right on the transaction then you looked at the gas price of the transaction and you just bit very slightly more okay so you would be inserted right before um etc and for back for back running you used to like understand the under bit and so on um but there is the problem here was that um the bits of like as everybody uh saw each other's bits there was a very big incentive um to just constantly update you a bit so you would this this caused a lot of strain on you know the the p2p layer and the mempool and it was a game where as a searcher as an mev extractor you needed very good latency and you needed a very good view of the transaction pool so you always knew when you had been outbid so it was a game very much of speed um and what it led to was a lot of fake transactions because even though some even though searches knew when they were outbid and they could sort of replace their transaction with one that played very little guests still this did not work all the time in practice and so about i think for some time more than five percent of block space was actually filled with failed transactions in ethereum so this was not great um it also because of the high unreliability in extracting mvv it it created a significant incentive for vertical integration so vertical vertical integration means that the producer owns all layers of the supply chain so um and the supply chain in in mining is basically uh yeah um the order of transactions in the block right so um a minor might so if you look at flashbacks today then you basically have the opposite of vertical integration and you have division of labor where um miners receive their at least part of their block ordering from a specialized marketplace that tells them which mev transactions to include right and this is sort of public for all the miners um but this is not that this is not the standard outcome uh like the guaranteed outcome right so this is something that um you have to actively work towards and in pga because of the higher reliability of med extraction uh basically there was a big incentive for miners to just start extracting emily themselves and not not just higher unreliability also if the market for searching is very it's not very competitive so there are very few searches and they control a lot of the mev activity and like a certain opportunity such as front running then the result is that these searches are the price setters so they can pay a very low because they have no competition rates but they can pay a very low amount of their of their revenue to the miner and this further increases the incentive for the miner to just extract the energy themselves and we saw this um i think there was a time where some mining pools started to extract their own mvv and they eventually most of them stopped doing this um and instead adopted um flashbots but without flashbacks this is some of the outcome that could have happened um however there is a lot of good things about flashbacks um so we always see a bit uh see a bit auction mechanism and what this does is everybody basically only submits one bit instead of many so uh your incentive now because you can update your bit is just to to to bid the highest that you're willing to bid which is very good for the miner um and instead of competing on latency now all of a sudden um the searchers are competing on gas efficiency so they they want to they want to create or finish their arbitrage opportunity or their transaction with as little gas as possible and this is great for users right because it frees up a lot of blocks based on the chain however there is one negative externality here as well which is simply that because it is now so easy to express preference on your transaction and stay exactly why where you want to be mined in the chain that this leads to more enemy extraction period and this has some negative externality on the users who suffer from more sandwich attacks so another example how much time do we have left by the way that would be um quite um you have another 10 10 minutes or so maybe a little oh okay that's perfect that's perfect we want to leave like 15 to 20 minutes for question and it's 37 so let's say eight minutes okay so another example here is brc binance smart chain so binance smart chain is very similar to ethereum um it also has public mempool um in the pre basically um yeah it just has like a lot bigger block size and shorter block time so i think block block time on blc is around five seconds um and the block size is i don't know how big but really big so um it's a chain that has very low fees and it has a very concentrated well that i said i think it has 11 uh validators who are all owned by binance um finance and friends um and what this leads to is it also pga because there is no so you can or you can think of sort of the flashbox mechanism it's almost like a side channel that exists on like next to the public memphis where you can express your preferences about where you want to get mined and and this happens in an environment where it's performed with very few negative externalities so but bsc still doesn't have such a system so what instead happens is um it's pretty much the same that we saw on ethereum however with even sort of less bidding it's just more spam so i think robert he made a good tweet the other day about a block in ethiopia you know about it yeah about a block in um in bsc that had um i think on average a block on bsd has between like one 1.5 k and 2k transactions in it and that particular block had um around 1 000 transactions that were all uh competing for the same arbitrage opportunity so and only one of them was able to fill it and all of the other 1000 uh transactions failed and actually wasted more than half of that entire block right so um so that's that's a clear negative externality because the these searchers they are going to fight for this arbitration opportunity because it exists but um they basically pay they compete in an auction and they pay sort of with with failed transactions right but this this is not actually born um yeah this this is a cost that has to be borne by users basically that they are not compensated for um and the outcome here for market structure is kind of the same that that i alluded to earlier with with uh theorem which is that if you don't have a market where um searchers can if you don't have this this permission is side channel that every uh validator can adopt where they communicate with searchers then the outcome is um that you might see vertical integration so meaning that the values start extracting the mep themselves this is not really a big deal at all and bsc because blc doesn't have the same it doesn't have the same uh yeah agenda in terms of decentralization right so they don't claim to be as decentralized as ethereum they know of course that they have concentrated well data set and this is not a big problem and so this can actually be fine in this case however the way it's a block space i would say i would say that is still an issue especially when the network you know can get really uh overloaded at some at some points um we briefly touched on arbitrary arbitrary single sequencer they use uh first come first serve and so what happens what happens here if um if a bunch of uh searchers see the same for example arbitrage opportunity so someone traded on the dex and then the state of the decks on an arbitrary is different from you know the state of the exchange on binance and so they want to perform an arbitrage opportunity so in this case um we still know that they will do everything that they can in order to satisfy this opportunity um however so and we know like definitely that um they will just try to spam as hard as possible but mostly i would say it's it's a game of latency so they want the optimal network network location and like the closest proximity to wherever that arbitrary sequencer is and um if sort of trading on traditional exchanges and high frequency trading is any guide then i think the end game for all of these um yeah for for all of these things where you have a single sequence and they they they sort basically by latency then the final outcome is always a massive incentive towards collocation so that means basically you being in the same room with the sequence and the sequence i can say these collocation spots um so uh on the one hand this again leads to wasted block space but on the other hand very high barriers to entry um both in um both in the market for sequencing so if albertum ever wants to decentralize the sequencer then you know sequencer sequencers might have an incentive you know to to offer such co-location services um and this might not be available to everyone but also to search us right so if you don't if you don't have access to very high latency uh or to co-location then this might be yeah this basically is very bad for the switcher market and finally um the randomized batch auction um so the here the case is actually quite clear so you have 100 transactions in the block um and you know you're going to get randomized and you have two ways either you fill up you know as much of the block as you can with that transaction that you must get in mind or you coordinate uh with the miner to just ignore transactions that would in any way be competitive with you right so um the dominant mev strategy here is just censorship so excluding some transactions that might pay um a sufficient fee but would reduce the the probability that your mbv transaction would succeed um yeah and this once again especially the spamming it needs to waste the block space and um the censorship there is an incentive here again for vertical integration um because it's actually very hard for searchers to extract mvv here in this in the scheme without spamming so um i think this this leads to concentration um in the blog producer blog builder set as well and well the takeaway is kind of you know show me the incentive and i will show you the outcome it's um if you build a certain market structure um then this market structure better um you know better ideas up to the realities of the market which is that there is mev uh on the table of a certain value and so searchers and miners both will you know do whatever they can uh in order to extract the semi and if your if your market structure doesn't consider that and in many cases it doesn't that's that that was the point of like the second or third slide in the in the past our market structures our blockchain marketing mechanisms only really cared about inclusion and like dealing with inclusion well but not dealing with with the exact position in the block very well then then you then you get extraction strategies and med market structures that that create a lot of unforeseen negative externalities and um yeah here is sort of a great example of that um because right now um you know we have this climate crisis but at the same time um a lot of airplanes are sort of yeah basically forced to do these unnecessary flights because otherwise they would lose their landing spots in airports and this is one of the most extreme examples of you know just bad market design driving extreme negative externalities so takeaways uh i summarized that here for you um the dominant mvv strategy and these market uh mechanisms um and take away yeah we touched on this i mean maybe it's an editorial so the market list is a marketplace that i should very uh should think very hard about the long-term consequences of your design choices uh and um yeah build mechanisms that you know adhere to the realities of the market not in utopia where mvp doesn't exist and app designers don't rely on marketplace designers alone because we have seen actually in the in the last year some big innovations on the application layer um to give just two examples um maker daws liquidations 2.0 um instead of having a fixed amount like um a fixed reward for for liquidators you have a reverse touch auction so um the the amount that you get for liquidating it starts from zero and then it goes up every block so you get liquidated at the best possible price and the lowest possible med and second unisop v3 because it allows market makers to concentrate their liquidity around a certain price point it has greatly reduced the price impact um of many trades that users have and thereby greatly sort of um reducing um the amount of sandwiched attacks that happen so um so this is uh really really positive both so um so i think mostly um you know the the the responsibility to prevent to to protect the users from mvp still lies at the application layer um and so you know don't we hear a lot about you know chains that protect the users from maybe but in reality is that mev will find a way um just with very negative con externalities on the users thank you all right awesome thank you hassan that was great um cool well we have 13 minutes left and we can address some questions let me put my camera properly um so we have some questions in the chat actually that uh shinon was kind enough to post and i posted some as well so we can address some of those and then i have questions myself to to the to the people here um so maybe actually a question for you if you're still here um is the the number that you're giving you you gave earlier the 40 to 57 spam statistic does it still hold posts gas increase in october so in october as if i understand correctly polygon increased the minimum gas price from 1 to 30 gray as like a hard-coded value in validator nodes partly to reduce spam activity on the network so does that 40 to 50 figures still hold then so the newest numbers that we actually uh have seen uh relating to this uh without the bounds was somewhere around 35 to 37 so technically yeah uh this has been reduced by this 30 limit but not by much we still see in the new block that come out a lot of spam transactions uh the way it has it had been earlier a similar kind of thing is seen right now in fact a lot of these uh spam transactions which generally uh are not successful enough uh you'll see them posting their transactions at just bare minimum above it like 30.001 way and they still post it because it's still economically viable for them uh to do so and uh successful uh arbitrages or whatever maybe extraction techniques they apply is able to cover that so it has uh put in some kind of uh speed breaker for the uh for for researchers uh but not by a lot i see also if there is more spam right it doesn't feel sustainable to just increase that gas limit even more right um oh because then it would it would i mean it affects all of our users as well i presume because then now a user has to pay like 30x more if they are sending like the minimum fee for for a transaction on polygon yeah i believe so because uh when we had looked at this that if you look at the ratios of how how many um unsuccessful transactions you can afford for each successful arbitrage that you generally do that number is quite huge even today um it goes into hundreds or even thousands and so that means you have to at least increase the minimum gas prices by 100 and that's practically not feasible for network as a whole so that way of uh increasing the base gas price uh does have its limitations i see cool all right thank you i'm picking another question from youtube actually this one is for you hasu it's from harith from etherscan asking on arbitrom would it be possible that the team requires a certain minimum geographical difference between sequencers so actually if anyone here in the chat want to jump in as well you would welcome that question i i'm not sure um i mean then if that works i i think uh some plan that would be more likely is that they would move from a single uh single node implementation of the first come first serve to a multi-node implementation so you would have basically a multi-party protocol between different different sequences to to agree on on a fair ordering so proximity to any one sequencer would then be less than less important right so so if you have 10 sequencers and they are at specific geographic locations in the world and they talk to each other they run some protocol in order to arrive at what they deem if they are ordering uh all reporting you know what they saw first then i think that would probably do exactly what what you had in mind okay cool thank you um there is a question here that shinuan posted from youtube on why was mev from arbs going down there was a chart about it i believe luke that might be you um i'm not sure if that was i'm not sure if it looks yeah luke you're still here yep yeah i'm still here yeah why i i uh i don't think we have a good answer to why yet i don't think i'm i don't think i'd be confident in an answer to that yet there's an answer in the chat from robert yes so hey it's robert i haven't been presenting today but uh my uh what i think about this question is that we saw more emphasis on nfts buying selling uh you know nft med and less on decks trading at various different points during the year so there's parts of the year where there's just less volume on dexes less people buying things less new fewer new assets coming up and that leads to less mev from arbitrage and more med in other places but at least that's what i would answer to this question of why mev from arms went down at certain points in the year thank you seren posted another question um how does cross domain mev change the game other than increasing even more the incentive for vertical integration collusion of sequencers does anyone want to take that question all right i shall give somewhat of an answer um uh you're right that in at least the early research that we've done on cross domain mev there are network effects to uh some of the effects that household talked about right and so to wanting to influence the ordering on multiple networks at once um so i'm not sure what you mean by change the game right like does it change the game from what muv is today and the dynamics that we see happening i don't think it does does it amplify them or does it accentuate them in a way that is going to accelerate trends that we're kind of already seeing happening or that we're predicting i do believe so um are there risks about that that we're not currently seeing that might show up in the future that we need to be acutely aware of i also think so and i think we're assessing these risks in research and we're also thinking about not only risks from centralization perspective but also systemic economic risks as well as just security risks of the systems we're building and the systems that people are are using and are kind of migrating to one from alejo actually alejo if you're if you want to speak if you want to add to that um oh just yeah just uh perhaps there might be more probabilistic maybe right because like you have to deal with different systems with different finalities so you can many of the opportunities are no longer going to be atomic so you have to put some more at stake for extraction take more risk um there's another question in there by mdr i would have another point on cross chain if you want sorry i would i would have another point on cross chain if you want please change the incentives um yeah so we already discussed that there's an incentive for um for vertical integration right so i guess what you mean by that is um for that to be the same sequence on both chains um but due to the probabilistic nature of execution on these chains um i think you add almost like a geometric return to to size um if that makes any sense so on ethereum if you have 20 hash power then you you're 20 percent likely to execute um a transaction in the next block right but um if if you are if you have 20 hash power on ethereum and 20 hash power on polygon then you're actually um 20 times 20 percent likely to execute the next block and so uh they are increasing returns to size that are much bigger than if you're just on a single chain it would be my guess very nice thank you um there's a question for ward word again if you're still with us yes you are um the question from mdr lolcap has there been any evidence on avalanche of transactions being ordered by anything else than the default go avalanche client um this is an interesting question um because uh i assume it means no man plus plus because yeah uh beforehand there was um only a constant gas price um and i i'm going to take this question i mean that it's asking if they've been sorted by not guests price descending yeah so maybe maybe i have a yeah you in your presentation you described how people optimize uh either like uh depending on which version of the avalanche network either like how much stake of uh avax do they have to be validators or optimizing their latency some other way right and that's it feels like that's because you're assuming some ordering that nodes will follow so has has it been the case that nodes kind of follow a different ordering than like that ordering that you assume right is that a good way of looking at it uh i um i think it's not if well if he's asking the question is for evidence um i think that um before sun man plus plus that's that's sort of uh it's hard to answer that succinctly because of like or ordering blocks and you could say like there was a lot of contention um but for like if if the question is have is there evidence of transactions not being ordered by price time um i'd say not significantly um i i have heard the statistic that there hasn't been an instance of sandwiching um which is very interesting um given it's the prevalence of sandwiching on ethereum um 