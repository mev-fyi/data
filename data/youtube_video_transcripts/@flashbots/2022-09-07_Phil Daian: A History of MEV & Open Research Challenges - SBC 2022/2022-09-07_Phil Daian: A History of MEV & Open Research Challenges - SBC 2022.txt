all right let's get started hello sbc who's excited about mev woo hell yeah so i'm gonna be kind of opening up today and and and talking about why are we all here what is mev i'm talking a little bit about my personal journey through mev which i've also talked about at mev day in amsterdam so the first 10 minutes of this talk is going to be like a hyper speed uh you know early morning version of that and then i'm going to talk a little bit about how flashbot sees some open research challenges some open research problems where we want to collaborate more with academics and also how we view kind of the product landscape in the next like let's say six months to a year and even beyond that so let's get started so we all know before mev meant anything in blockchain um it was a unit of energy um millie electron volts mega electron volts i think it depends whether you capitalize the m or not so here i guess it would be mega um and so why is this important well mev is still a unit of energy today in our financial system and that's what mev is on a blockchain and why are we all here because we want to know how to deal with all this energy in a way that's constructive for the community and for everyone else so i'm going to briefly take you through my journey my personal journey through mev also you know kind of both through cornell and through flashbots these two different facets of my mev experience and also talk about some research papers that you might want to check out if you're interested in where mev comes from the past research problems that are solved or the future problems that are going to kind of be on our horizon and so yeah let's get started so for me the first phase of mev when i fell into this rabbit hole of incentives and financial battles was this paper called enter the hydra which we wrote around 2016-2017 and this was looking to create a bug bounty program that was decentralized incentive compatible and robust so we could have secure smart contracts that were secured by economic value and you could say okay this smart contract has a million dollars of security and we have a whole infrastructure for doing this without any trusted third parties which was kind of a first of its kind result in software security you can't do that in traditional software without a blockchain but there's a fly in the ointment which is if you rely on a bounty based system on a permissionless network how do you know that when you have some alpha about what the exploit is or what the bounty is and you're playing any kind of security game or mechanism that you're not just going to have a front-running adversary come front run you and then take the money instead it turns out this one technical detail of blockchains and how the transactions are ordered erodes the entire economic security game that you can build on top and prove that like okay this contract is secure and so to solve this we created this two-phase commit reveal with kind of steganographically hidden commits called lib submarine probably a little too early for its time but still in my opinion an underrated project in uh um mev so check it out after that a natural question is okay what about dexes so 2017 we had the ico boom and we had erc20 tokens kind of find product market fit and we had an explosion of these dexes so in 2017 me and a bunch of people at cornell took a look at these dexes and wrote an article about the flaws and costs of all these dexes that people were deploying and we flagged several issues with these dexes for the community including exposure to arbitrage so possibly getting a worse price than you would want to or would on a traditional centralized exchange including minor front running so the fact that miners have ultimate control to just insert transactions in front of yours and basically own the entire market um including exchange abuse so if there was someone centralized running infrastructure order books they could potentially abuse their positions over users we also ran our own bot to see whether this was actually a problem and whether kind of the flaws that we discovered were real and found that we were making about a million dollars a year with basically a pre-pga mev bot so this was before these opportunities were actually competitive on chain you just had like one bot it would take the opportunity pay however much the fee was and that was that and there also wasn't a lot of volume so a lot of people would come back and say well is this real is this a real industry like is this really going to be something i can spend time on or maybe like you know explore or make a company or or a professional career solving if it's such a small market uh but that kind of shows you how we tend to underestimate how rapidly these things can take off and grow so from here i kind of got a little bit obsessed with dex design and went down this rabbit hole of trying to warn the eth community [Music] about dex design and its insecurity so this was a talk at uh devcon prague basically where we talked about transaction ordering and the pitfalls of transaction ordering and how ordering and insertion together uh kind of comprise this thing we call order optimization uh at the time or oo and this is like what we were claiming is how miners would eventually make a lot of fees because of the size of the incentive to manipulate basically this transaction ordering so we were warning people like look your dex designs not only are vulnerable but they're also making the entire chain insecure because these unpredictable incentives these degrees of freedom you're handing to the minor they incentivize reorgs they incentivize censorship and withholding and all sorts of other nasty kind of network level properties on the one hand and on the other hand they're very economically centralizing because it's such a profitable kind of optimization problem because it's such a hard optimization problem to solve because you need to take risk to solve this optimization problem unfortunately what you end up with is like a privileged set of actors that are good at this and are able to extract rent in the market and therefore centralize the validator set politically influence uh lobbying on the protocol and all sorts of other negative things that like let's say we wouldn't want an entity like goldman sachs doing right like we wouldn't want them having like a billion dollar incentive to kind of lobby uh the eth protocol um so this was kind of my attempt to warn the community i felt a little bit crazy at the time but this is kind of a cool example of like um the relationship between emmyv and ordering which i still think is a hot unopened topic of discussion today um so after this this is like very early in my mev journey i kind of wanted to write all this down and like distribute it to people so that led to all this work called flash voice 2.0 the early part of that research which was presented in in prague and the the definition of mev the first kind of time mev was used as a term kind of going beyond just ordering optimization or the ordering of transactions and looking at like all the minor powers and all the economic implications of the rent in the system and then in response to this we also had some work on fair ordering in byzantine consensus which is a new line of research that was kind of a response to the just the value and the ability to reorder in these economic protocols not being something people had pre-designed into bft consensus um so we can talk about flash boys 2.0 a little bit if you're not familiar with mev and i assume most people in this room are but if you're just coming into it i think this is still a good intro um so what did we do here we we said okay we know there are a lot of bots that are extracting mev on the blockchain let's figure out what they're doing and let's figure out where this is headed so we deployed uh like eight nodes all around the world um uh and had this kind of timing synchronization based observation stack where we just gathered data on what transactions were happening on the mempool because and these are this is what we saw basically so this top picture is a picture of a typical pga gas auction uh circa around 2018. um so you can see two bots here the orange and the blue bot are competing for this opportunity the x-axis is the time and this is the bid they're placing to the miner over time basically and we characterize all the game theoretic properties of this game as like continuous time and perfect information uh with possible collusion and things like that and we derived a bunch of game theoretic results kind of about the pga auction and told the community like look this is a big problem for consensus because you can actually lose consensus security through mev um and we need to find some way to harness this this potential energy to do a little bit more than just make our system insecure or erode our consensus um so enter mev this paper was also the first time the letters mev were ever kind of published into the world and this is a direct quote from flash boys 2.0 on the relationship between what we used to call oo fees and mev so oofs represent one case of a more general quantifiable value we call minor extractable value now maximal extractable value anyone who doesn't like that meme catch me outside [Music] so mev refers to the total amount of ether miners can extract from transaction manipulation within a given time frame which may include multiple blocks worth of transactions so this was the first kind of very informal english language definition of mev and then we talked about why this is bad for consensus why having this form of unpredictable fee with extremely high variance and extremely high spikes destabilizes your underlying consensus incentive scheme basically um so one natural response to this is okay ordering is the problem let's fix the ordering and let's come up with some ordering definition and find some protocol to enforce that because that's what we do in crypto we like figure out what we want we distill it into a definition and then we design a protocol um so these two papers out of ic3 also were attempts to kind of go down this line of work uh mahimnikelkar and several co-authors in in ari's group were kind of pushing this and they came up with something called gamma batch order fairness which basically says suppose you have two transactions tx and tx prime then if most nodes essentially receive tx before tx prime then tx will come before tx prime in the order this is fairness so i think this is a very interesting line of research and constraining and creating protocols around ordering especially in various deployment settings you know in roll-ups and permission settings in all sorts of types of chains this is a super underexplored area there are many limitations we know about also of these definitions for example you may not be able to order two transactions uh the the schemes that you can build on top to satisfy this also need to be proved to be incentive compatible in a rational model and collusion resistant and things like that so this is an ongoing line of work still very early days but very promising all right then from there what did we do we thought about okay let's define what mev means how can we create this definition that unites all these researchers across various fields across optimization formal methods economics distributed system security so we wanted something really simple that really any field could kind of take and build tools and and a language around to communicate around like basically these financial incentives um in blockchain in a way that was very blockchain native so like almost like a blockchain native uh game theory framework um so this is what we came up with and it basically has these two quantities the top quantity is eb ev sorry and it has three parameters a proposer um a set of uh basically blocks that the proposer or the player um sorry ps player is allowed to generate and a state s that the system is in that the player cannot change so there's some state that the player can't manipulate and it looks at the maximum of all possible blocks and takes basically the player's balance across these possible blocks and the difference between the player's balance so the max difference between the end of the block sequence and the beginning block sequence is the ev for that sequence and then we look at basically mev saying like okay calculate ev over all the valid blocks that a minor can produce and then maximizing that gives you basically this english language quantity which is how much can a minor increase their balance across a series of blocks all right so that was one phase of mev entering the next phase of mev we had a blog post that i wrote called m e v what do which if you haven't read it please if there's one thing you do in this talk i would love to engage with you because i think these ideas are still relevant and this this blog post had kind of a two-part uh argumentation one is that mev is fundamental to the types of blockchains at least permissionless blockchains that we're building and another one is like what should we do about it so why is mev fundamental i laid out three characteristics of blockchains that directly lead to mev one is cryptographic transcriptability one is interoperability across different trust domains and the the information control basically at the boundary of these trust domains and another one is uh permissionless design so if you have some system that's exchanging value that you want to be truly permissionless you need to put the money on the table and let the world organize around it and that is exactly what mev kind of quantifies um so what do we do about this because like obviously mev is a complicated thing right it leads to certain attacks it leads to like flash loan attacks it leads to sandwiching et cetera et cetera so this was my prescription so if you're a dap developer think about mev and limit your mev to what's required if you're a user audit your protocols for mev with that in mind if you're an l1 or l2 make sure you think about mev when you're designing your incentives and how that affects the core incentives for validators in your protocol if you're a validator and this is the most controversial point on this list my belief is in a rational security model you do need to be extracting the maximum mev to kind of maintain your competitive share of stake against the actors who are willing to do this and maybe have less morals so if you're operating in a network which is not permission not relying on honesty assumptions and is relying on rationality then you're actually contributing to the security of the network by extracting the mev and everyone else mitigate the negative externalities so try to avoid spam latency wars centralized random extraction like weird politics all these other consequences of just having these billions of dollars on chain okay so then we enter flashbots which was kind of the next phase of this accompanying me and for other people co-founded because we thought that it was kind of time to uh do something about these these issues we were seeing in the evolving industry side of the meb marketplace um so flashbacks has three goals that we laid out in our post announcing its origins one is to illuminate the dark forest so we believe that competition is key here and transparency is like the bare minimum and mev has the potential to become opaque how are these bots working how much are they extracting what are the attacks we don't believe in opacity we believe we need information symmetry for efficient markets we also want to democratize mev extraction so we want to disincentivize validators and mev actors from having to sign social or legal contracts to maximize their revenue why because this creates asymmetries in how much each validator in the set can earn and centralizes your system and we also want to distribute the benefits of mev so we want a fair system for both users and validators and other actors within it i'd say we've been really successful at the first two almost surprisingly successful and the third one is kind of our next major to do um so why are we all here and i'm sorry i'm kind of reusing old slides so this is like not the president's like two months ago um but um we're all here because we're on the precipice of kind of a change in mev which is the world-going cross-chain the crypto becoming very controversial in kind of the geopolitical landscape and this all intersecting with these complex financial incentives so if you're interested on talks that really go deep into these subjects and cover literally every single facet of mev from trading to hedge funds to technical side to consensus design to cryptography to any other facet of this diamond you can imagine we had an extensive series of talks at this mev day event just recently that i think are extremely high quality and topical so i encourage you to check those out and there we also talked about cross chain mev which basically has the potential to incentivize validators across different chains to collude to more efficiently extract these financial incentives and why this is a huge centralizing problem for the system and we also talked about how in the centralized world which is orders of magnitude bigger we still don't know if these actors are behaving honestly or exactly what's going on so mev is very transparent and it's easy to get caught up in that but we shouldn't forget about the centralized world and kind of how shady it is in crypto all right so let's talk about what we're going to do next about this real quick so this is a warning kind of to this room as academics as industry partners as vcs that are funding projects we're on the precipice of losing the decentralized option for humanity and centralizing all of cryptocurrency through mev so there's a real choice for why we're all here on the one side we all want to attain understanding as researchers and we want to preserve decentralization for the community because we all owe this community like a debt of gratitude on the other side we can't ignore the incentives in like this raw financial system we're building to both make money and have parties that attempt to own the centralized stack possibly in hostile ways so what i ask for every person here is to like decide what you're going to do every day and which one of these axes you're going to be on and have very rigorous and principled reasoning about why that's kind of my ask for you all i'm going to skip this so is is mev research good or bad for the world hard to say so far i think it's up to the people in this room all right one last thing i want to talk about uh and then maybe i'll have time for one or two questions or maybe you'll have to catch me after what are we doing about this at flashbots where are we going next what are you going to hear about today and how are we continuing this work forward so there's a number of research issues that we have on our flashbots research website flashbots is a dual research and development project with a balance of kind of academic style crypto research and product development so we're looking at all these efforts both internally and externally and we can use help on all of them auction design economic game theory computational game theory and auction incentives both cryptographic and crypto economic privacy and how it relates to the the economics of these systems mev and other systems such as eth2 which i guess is like going to be very relevant soon and l2 a taxonomy of mev how do we characterize where does various mev come from and what are the good and bad implications of it on the system is there such thing as an ethics framework for mev falls under that as well can we achieve features like account abstraction through mev how does mev interface with protocol design and what tools and techniques can we make for protocol designers so that they can design protocols that don't surprise them through the consequences of mev how can we optimize mev search so the market is actually efficient and achieves these like kind of security properties we're talking about and how do we think about flashbots as critical infrastructure and make sure we're not on the critical path of harming any sort of properties we enjoy in cryptocurrency such as censorship resistance or liveness or safety um and on the product side of flashbots we're also thinking about constantly how can we improve this two-sided market for mev for block space whatever you want to call it on our systems so the way we see this market is as a tension a compromise between the user and the validator where the user side wants to minimize and the validator side wants to maximize mev so people always ask me oh flashbots is maximizing mev is that really what you want yes does flashbots want to minimize mvvs flashbots doing that yes those two things are actually the same right so if you want to design a market you need to do both and you need to find some tension in the compromise between these two goals to actually like find economic efficiency and this is some criteria we're thinking about privacy decentralization competition at every layer of the stack transparency tooling for users economic efficiency geographic diversity which is very important for robustness of your validator set and its incentives fewer externalities on the network like spam and latency wars and still fewer first-party deals with validators which i think are highly corrosive to any blockchain's incentive model so please join us i was going to change this to flashbots.net which you know you should check it out wink wink but this is our github we have everything on here about our research our product et cetera we've we hate github and you know for obvious reasons i think in the last few weeks they've all really failed us so we're working on that but bear with us for now and you can you can check out our information there all right thank you very much uh for listening and i don't know if we have time for questions it says i have four minutes left so maybe i'll take one or two if anyone has wow we killed it today huh oh yeah sorry i can also repeat the question yeah all right uh so on the mev what do blog post uh you said the user's goal was to optimize for using apps with minimize mev is that a reasonable expectation for users given that they just don't do that in drag fi um that's a that's a good question i mean i think i think um the equilibrium in tradify is like very complicated and has like a long history of complex incentives i do think we can do better than that i also do think the equilibrium and tradify like speaks to some user preferences of like i don't want to see like a fixed fee on my transactions you know i want like the certain ux pattern and i think we can't ignore that so like we can't escape it is it fair to users um you know yes and no i mean i think that's one of the many obligations like the users should really be putting more pressure on the dapps to say like do we trust you what are you all doing about it and like i'm hoping that in tradify especially as crypto starts to come into tradify and we see more mechanisms like we have in crypto like bleeding into tradify i'm hoping that like in the long term iterated game this also exists in tradify where like if robin hood is worse than like alternatives like people will switch and things like that um so yes it is like we can't like just fully like punt this to the user and say like it's only your problem you also need like the l ones to like be aware and like help the dap developers build good apps and help the dap developers like actually build sanemev systems and communicate this to users and like help the users then evaluate the claims so like this is like the whole kind of loop and i think users are one part and like we can't trust them entirely but we should also respect their preferences yeah uh first question um you're mentioning for validators like there's a very corrosive effect of first party deals could you explain that a little bit um yeah so basically the the tldr is like when you're reasoning about uh the economic security of your protocol let's say you take like an economically rational model um oftentimes in crypto you'll use things like stake or hash power or some other resource as like a proxy for like percentage distribution in this network um right and so you don't want and a proxy for like essentially power so like in theory if you have 20 of power in bitcoin you should have about 20 control over like the parts of the network that hash power is responsible for this breaks down at 51 which is like a well-known like cliff in theory or even a little lower if you consider selfish mining but in general you want like five percent to have five percent ten percent have ten percent if you have a curve that's like super non-linear and like super linear in your percentage of uh of hash power stake whatever resource people are like fighting to accumulate so like let's say there's one actor that knows that if they get 20 of the stake they can make 80 of the money and everyone else is on this like linear curve if i make 20 of the stake i make 20 of the money it just becomes a impossible to like reason about your incentive so you can't prove economic security anymore and b this party that's like okay if i can get 20 then i get 80 and if i have 10 i have 10 is hugely incentivized to make this deal to go from 10 to 20. and there's like a lot of iterative advantages like this that just end up being like centralization pressure on the network um other things this plays in on is like latency and geographic centralization so people co-locating for economic efficiency at the expense of uh distribution of the network at the expense of the ability to like have multiple regulatory jurisdictions instead of a single one etc so these are kind of all the like small corrosive effects of this but the tldr is like you want to as close to a linear curve as possible and if not like things just get very weird thank you other question do you have any thoughts on like for example the move language and formal verification and like the effects with med on that yeah so i think formal verification is a great tool like uh clockwork finance which is one paper where we defined mev is also like how can we use formal verification tools to prove security of protocols in the context of mev where instead of using this boolean property you use like integer reasoning in like a game framework basically so i think there's a lot of potential there to build like estimators static analysis tools mev model checkers composability provers like this is how we need to this is one facet of how we're going to understand what we're actually building i think awesome thanks all right thank you very much everyone find me offline you 