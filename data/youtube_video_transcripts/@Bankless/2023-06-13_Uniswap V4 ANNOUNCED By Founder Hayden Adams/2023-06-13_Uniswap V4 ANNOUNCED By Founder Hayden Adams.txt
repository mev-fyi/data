one cool thing about Singleton design is it actually reduces current estimates have it have it reducing the gas cost of full deployment by about 99 wait what sometimes people pay when gas costs are high like north of a thousand dollars to deploy a pool just a gas cost and uh that same deployment would be something like ten dollars Bank of station there's a big announcement for everyone in D5 today uniswap version four it's coming out we have Hayden Adams on the podcast to tell us more we talk about a few things what is uniswap version 4 V4 what does it do when's it coming how big of a deal is this from an order of magnitude size is this as big as V3 we also talk about hooks this idea of a modular uniswap what are hooks what do they do what is the future for liquidity on ethereum and finally we talk about D5 has D5 slowed down has it diminished does Hayden still think we're on track to eat traditional Finance all of these topics unpacked in the episode today guys before we begin though want to tell you about a prized linked each denominated savings account from our friends and sponsors at asymmetrics David what is this asymmetrics it is a way to make your teeth staking super exciting or super boring or super exciting if you want that 4.5 5 eat steak to range anywhere between zero percent or one thousand percent asymmetrics maybe for you okay what the hell am I talking about so asymmetrics it's a little bit like pulled together same kind of concept where everyone Stakes their ether but only the yield goes to one person who gets a lot of yield while everyone else gets zero yield this is why Ryan called this a prize linked savings account so if someone just feels like a little bit uh extra lucky and they want to add some excitement to their teeth staking they can go to bankless.cc slash asymmetrics to get anywhere between zero or one thousand percent stake on their yield Ryan diving into this episode when I was learning about uniswap V4 I really just got visions of a microcosm of ethereum so I'm I'm calling this unit the hook Centric road map for uniswap whereas ethereum has its roll up Centric roadmap uniswap now has Hooks and it allow allows for uniswap base to be extremely primitive but hooks to reintroduce complexity into the uniswap amm on an opt-in basis and I think this really gives a lot of power to builders who want to make their uni swap pools very expressive uh overall it starts off as a very small update V4 is a small update to V3 but the cool thing is is that the size of how awesome and Powerful uniswap V4 is actually grows alongside the open source developer Community around uniswap so very bullish on this new update Hayden's going to unpack it for us in this episode a small disclaimer uniswap Labs is a sponsor of Bank list they currently sponsor the bank list podcast but human swap V4 is an episode that we would never miss and so we're having Hayden Adams the inventor of the uniform protocol on to discuss all about unos.v4 so let's go and get right into the conversation with Hayden Adams but first a moment to talk about these fantastic sponsors that make this episode possible including and especially Kraken a preferred crypto exchange for 2023 if you are scared that the operation choke point is going to choke us off maybe you should get all of your Fiat money into the crypto world and perhaps you should use your brand new account with Kraken to do so let's go hear from them right now Kraken Pro has easily become the best crypto trading platform in the industry the place I use to check the charts and the crypto prices even when I'm not looking to place a trade on Kraken Pro you'll have access to Advanced charting tools real-time Market data and lightning fast trade execution all inside their spiffy new modular interface kraken's new customizable modular layout lets you tailor your trading experience to suit your needs pick and choose your favorite modules and place them anywhere you want in your screen with Kraken Pro you have that power whether you are a seasoned Pro or just starting out join thousands of traders who trust Kraken Pro for their crypto trading needs visit pro.crackin.com to get started today mantle is a brand new high performance ethereum layer 2 Network built differently from the other layer twos you may be familiar with mantle is a modular layered built on the op stack but uses eigenlayer's data availability solution instead of the expensive ethereum layer 1. not only does this reduce Mantle's gas fees by 80 compared to other layer twos but it also reduces gas feed volatility mantle has a decentralized sequencer set eliminating the risk of downtime and censorship on the network and because mantle implements multi-party computation nodes layer 1 settlement execution is shortened from seven days to as low as just one or two mantle is the first layer 2 built by a dow and is backed by one of the biggest Dow treasuries in the world bit down mantle already has sub communities from around web3 onboarded to help the growth of mantle like game 7 for web 3 gaming or edu Dao for the world of D side and buy bit for tvl liquidity and on-ramps check out mantle at mantle.xyz and follow them on Twitter at Xerox mantle immutable is at the Forefront of web 3 gaming on a mission to bring digital ownership to every player offering the world's best games and game development platform immutable lets game builder and players focus on great gaming experiences so build your next web 3 game on easy mode with immutable's leading full stack web3 gaming platform it's built-in ux features like the immutable passport are designed for games to scale to the next billion players coming to web 3. with immutable players can sign up with an email pay with a credit card and experience a frictionless purchase flow inside of games so discover your next favorite game and explore a network of 150 games building on immutable including such titles as gazam chains Guilds of Guardians eluvium Ember sword and metalcore so join web3's largest ecosystem of games and players build play and connect at immutable.com banklist Nation I would love to introduce you to Hayden Adams the inventor of the unispot protocol and CEO of uniswap labs a software company building on and around uniswap and today Hayden is here to talk about the vision behind uniswap V4 and what it could mean for liquidity on ethereum Hayden welcome back to bankless thank you for having me so excited to be here and to talk about unislav V4 yeah hey we getting a new unit swap uh short answer as we are um long answer is that you know the the process of getting a new unit swap is going to look a little bit different this time around um I think that you know a really important starting point is that we see uniswap as very similar to ethereum itself uh where ethereum where it's you know a core piece of infrastructure or public infrastructure on which you know thousands of teams are building hundreds of thousands of liquidity providers and it's really just this like public infra for the entire space right it has about uh you know at times it has over 90 market share for on-chain trading on on ethereum at least and so uh you know similar to how ethereum has this like public process for it being rolled out and uh there's a lot of time for people to respond and react and give feedback and input there's time for all the different projects building on top of it to you know begin preparing uh their infrastructure and you know build on top of it yeah with this version of uniswap uh we really wanted to build it in public and so what we're uh rolling out today is basically a you know vision for uniswap V4 as well as a you know white paper and a you know a draft of the code so the code is you know we have an initial code base that and it works and it proves that it can work uh but it's not final and we don't expect it to be final for many months okay so the big new announcement is unit swap V4 jazz hands yeah we're getting new uniswap and also the way that unit swap V2 and V3 were built was it was built and then I think within a month both of them were live on mainnet and this is not what is going to be happening with V4 there I'm there is no release date if I'm correct and it's just a very long open period for public collaboration Community engagement public conversation to Tinker with unit swap V4 is that correct yeah I think that you know unified V3 was kind of like a Beyonce lemonade album drop where when we released it it was this cool thing and it was entirely ready and it was a surprise and you know I think this time around and honestly one of the pieces of feedback we got at the time was hey this is really cool this is going to take me like a month to understand let alone you know build an entire integration on top of and so you know that was one aspect of it the other aspect of it is that you know there were even like mine that at the time that we announced it the code base was basically Frozen and already well underway of auditing and so there wasn't time to incorporate any pieces of public feedback and there were like very very minor things that people I mean it was like a very good code base we did a really you know good job but it was like there was like minor pieces uh very minor improvements people found at the time and you know they weren't really able to be uh integrated and so with uniswap V4 there's going to be many many months uh there'll be time for people to you know open issues to to submit you know submit PRS there's contribution guidelines uh and there's a lot of time for people to you know start planning Integrations and start building on top of it so what are we getting right now hidden at the time this episode is released what can people go um get busy with and start digging into yeah so you know first we have the blog post which just outlines a high level overview of what it is uh or at least what our vision for it is uh you know similar to like ethereum right you sort of have a sense of where things are going right we had this sort of vision of proof of stake and then everyone started marching towards it um so we have decision for what newspap4 is uh we have a white paper that you know gives a lot more background and Technical information uh you know and supporting you know math Etc and then we have a code base and the code base really just contains a full draft implementation so kind of proves it works uh it's definitely not audited it's not you know production ready um and we aren't you know going to March straight towards audit production ready we're actually gonna you know give space and time uh for people to contribute into to you know give feedback into it and so yeah right now we have an initial implementation we have a vision excited to talk about what that vision is and yeah uh before we um get into the vision of of uh V4 I I want to just maybe zoom out for a minute because it's not often hidden that um we're able to get you on on Bank list and have this kind of conversation but like let's zoom out all the way back to to 2018 and I'm wondering if you could kind of like share how far uniswap has come from that point in time I was reading the blog post a little bit earlier something like 1.5 million or sorry trillion with the T my God million how quaint of me trillion uh in in value flows through this platform give it give us some stats give us some um some of the numbers that you look at to to understand to Flex unit swaps progress and its impact yeah Flex on us for a minute yeah I mean it's it's been an absolutely insane Journey we have the the previous bankless episode we did where we really went through a lot of the early days but since then it's just been absolutely insane um I guess a few of the the things that we look at that are pretty interesting um definitely like total all-time volume traded is you know north of 1.5 trillion at this point uh which is which is pretty crazy there's you know billions of dollars in daily trading hundreds of thousands of liquidity pools created hundreds of thousands of liquidity providers uh you know millions of Traders there's you know I think you know even just like the the amount of um like the market share on on ethereum it's like you know north of 90 at times of on-chain trading on ethereum uh happens through the uniform protocol uh you know it trades off at different times but um you know it's been trading off with coinbase in in total uh trading volume um you know all sorts of things that we look at uh to just show like the amount of activity happening on top definitely I wish I had a number for the amount of projects building on top of it my like intuition says tens of thousands not just thousands you know just because of the number of of you know tokens and projects that exist so so given all this Hayden one question in my mind is like can you swap get even bigger like I mean haven't we seen all the growth is it aren't the growth years already behind us how can this thing possibly get any bigger uh I I definitely think that unit swab can get much bigger there's a few ways for it to get bigger definitely like in terms of like market share on ethereum it's hard to get much bigger um you know there's there's very marginal gains to be had there right in the order of like 10 to 15 um and so I'd say that where uniswap growth bigger is about you know basically growing the entire space um about having you know more uh enabling more you know things to be built on top of it um you know basically growing the entire growing the space around it and really um you know taking Innovation that currently happens external to unit Swap and having that Innovation happen within uniswap I think that like one you know pretty important like nuances that you know uniform has this like dominance in market share but there is a lot of innovation today that does happen in the amm space and a lot of experiments and you know maybe a little bit of a spoiler like for some of the stuff that's coming is it like a big part of what we're trying to do with unisoft V4 is make it easier for people to you know experiment and innovate uh even within you know on amm design and uh functionality but having that happen still within the swap ecosystem oh what's the goal here hey now I mean I remember at one point in time when um dexes were still in their infancy and we were just hoping to get like a uh you know like five percent market share from centralized exchanges so basically all of the exchange volume happened with with centralized uh exchanges and like wouldn't it be great if um we could actually get this whole decentralized exchange thing off the ground and we we could like eke out maybe double digit percentage of um volume like how do you think of the competitive landscape these days do you consider centralized exchanges as uh competitors or would you like draw those lines differently than maybe we did back in uh 2018 2019. yeah I think that it's you know a pretty uh interesting I'd say that generally like decentralization offers some fundamental advantages and the way that we always think is how do we expose those advantages to more people and so it's definitely possible like I think central is like centralized you know exchanges are going to continue to exist uh but I think that there are really strong advantages of decentralized exchanges and you know even like things that are centralized exchanges today will you know start tapping into the liquidity from decentralized exchanges over time um in terms of where you know where it actually ends really I think that you know first it's D5 growing bigger than T5 and then it's you know D5 growing bigger than Chad fi um that's like the long the long term of it and uh the purpose of that is not like for its own sake but because we think that you know uh that leads to a world uh you know with with fairer better you know uh Financial system you know more more accessible Financial system uh you know just a better world in general these are what we call a bankless values and um yeah we don't talk about them maybe well maybe we talk about them too much David I'm not sure we'll let the listeners decide but it's uh it's definitely why we enjoy having hated on the podcast to kind of re-articulate it's been baked into the DNA of uniswap um from from day one to provide a bankless uh exchange experience where user can retain custody of their private keys and their assets and that is certainly um if we don't talk about it as as much now in 2023 right we're off chasing other things but like that is the core of this entire movement I mean that is why we're here yeah I think you know it's what you said like a lot of time kind of people have been in the space for a really long time like take it for granted instead of like yeah of course we're doing all that stuff let's talk about what's new but um yeah I agreed like the the values are super important and really important to like guiding you know even day-to-day decisions so he had an element when uh unit swap V3 came out and concentrated liquidity uh added in just a whole entire layer of expression onto Universe V3 uh you can swap it in general I was like oh that's that's the last unit swap that's the final completion of uniswap it's The Logical conclusion uh that unified V3 is is now uniswap so clearly I was wrong about that uh so what was what was incomplete about uniswap V3 that we need unit swap V4 so let's start unpacking the uni swap V4 box what does V4 bring to the table that that V3 still had left to complete yeah so you know Unison P3 I I don't think we uh I think it was a really really good protocol right it's really proved itself um there's a reason it has such dominance today um it's you know really extreme you know it's really efficient uh really flexible for liquidity providers relative to previous editions I think that like what the the maybe the one thing right that we really you know wanted to tackle with before is unit swap V3 was also extremely opinionated and what I mean by that is you know when you have these immutable smart contracts uh the rules for it are kind of set in stone at creation and the more you can you know modify and upgrade uh the the in certain ways it compromises uncertain security properties and compromises on you know um uh you know other things as well and so I think that you know with uh as an example right uh in the process of Designing us on V3 there were like a million trade-offs that had to be made and you know one example trade-off is the price oracles uh so the price oracles were really just you know basically at the beginning of every swap uh the contracts store the you know the first swap of every block it stores the price and you know adds it to these like accumulators and with that you can basically other you know other applications can extract uh really efficiently uh average prices have cross any period of time in the uni swap uh in that u-swap pair and that's a really you know it was a really good almost like public good for the space many other projects have started you know have built on top of that uh feature um at the same time running that logic for you know these price accumulators actually is a gas cost that is paid by swappers every Swap and so you could think of maybe something like 10 don't quote me on it uh of all Gap you know of of the gas if swaps is going to like updating these price of our goals and that amounts to a huge amount of money over that swappers are paying over a period of time and the thought process was basically like well you know if you swap can be used in more ways and in more places than uh ultimately that will lead to more like you know usage of the protocol more liquidity in the protocol and that will you know be better for swappers and offset like the increased gas cost now it has that played out uh made probably in certain situations some pools the oracles do get used and they're tightly integrated into important protocols um and in some pools maybe they don't get used at all probably the majority of pools actually they don't get used at all and that's just like attacks on swappers paid over time and the kind of like opinionated uh way that V3 was was implemented that what isn't like a choice that you can make when you deploy a pool um so I'd say that like the the flagship feature um of Unison actually before I even I'd say like another area um that you know is really interesting as it as it relates to like the sort of opinionated nature is like fees and how fees are implemented um you know most like there's a lot of different people who kind of experiment with we're gonna build our own amm and usually what they're doing is actually just like experimenting with the fee logic sometimes they're doing other things but that's like the most common thing that people do and there's like a few other changes so people are building entirely new uniswap forks and what you're saying is like and they're really just tinkering with the fee model and so they're building out entirely new exchange just to Tinker with fees sometimes and you know maybe sometimes they're doing other changes as well uh but sort of no matter what they're probably doing more work than than they they should have to yeah if all they're really trying to do is modify the functionality of a pool and so I guess you know well we'll get get to the point of it which is you know you know the flagship feature of uniswap V4 is what we're calling hooks which are essentially you know modules or customizations that you can make when you deploy a pool and you know anyone can build a hook anyone can you know can Implement one and anyone who's creating a pool can choose you know what Hooks their their pool uses and these hooks are you know pretty expressive and they allow you to add on new features new functionality modify parameters of the pool in in really uh interesting and meaningful ways so it looks okay so you you started off this conversation with uh oracles and then also talked about fees and these are all things opinions that you're saying uniswap V3 had if you wanted to start a new unit swap uh V3 pool you had embedded in it this Oracle feature whether you asked for it or not and then because of that feature uh swappers who touched the logic of every single V3 contract every time they swap pay for that uh complexity to be built into that V3 pool so what you're saying is um unusual V4 has these thing called things called hooks that are like generalizable place things to insert into a V4 pool so I'm guessing a base V4 pool a V4 unit swap exchange uh has almost zero features built into it just like by default and then the idea is you can opt in to certain features like the Oracle like V structures Etc after the fact but the standard issue unit swap V4 exchange is just like Bare Bones primitive reductive maximally simple maximally cheap maximally efficient is it am I am I on the right track here yeah exactly I think that the you know the funny enough unity4 actually has like the the base system has almost less features right because the oracles have been taken out of the contract right and now they can be implemented as a hook and so you know in the process of building V4 we also build a whole bunch of example hooks uh to show how expressive it is and the types of things that you can do you know the simplest form actually has has fewer features in in a certain sense so so you just saw before uh I could just start going through some examples of what I was going to do with hooks maybe we'll make it more make it more clear um okay so you know one example is definitely Dynamic fees so right now you know all right now we need to play a new pool the pool Creator gets to choose between a few fixed V tiers and actually the reason we use about V3 the reason yes in V3 you choose between you know uh there's like four different features today and governance has the ability to add more um and the reason that there were like arbitrarily many is you know to encourage you know to kind of discourage liquidity from overly fragmenting and encourage people to kind of consolidate around specific tools uh with with unity4 when you deploy a pool you can choose any fee you want as a static fee or you could attach a dynamic fee Hook and the dynamic V hook could actually customize you know the logic of your feed in any way you you want uh one example would be that you could do you know um you know you could basically try to do some sort of Oracle that tracks on-chain volatility and automatically adjust the fee based on that and that's an interesting experiment we've wanted to run for a long time but we didn't want to you know hard code it into V3 because it was unclear if that was the optimal design and so with unusual P4 people can experiment with a whole different uh you know world of fee implementations um you know volatility based uh you could imagine Dow controlled um you know Etc and so that's one example I think that's like a hook that will probably get a lot of usage other you know pretty major features that you can add onto a pool we have a you know an implementation of a limit order hook which allows you to place limit orders at ticks so right now you know you can you do you can provide you can kind of simulate limit orders a little bit and use swap E3 by providing liquidity to very narrow ranges and withdrawing your liquidity after it's filled uh but within swap V4 you could actually just create straight up limit orders that execute at you know and basically maybe to step back quickly hooks are basically code that uh that run at certain points in like the life cycle of a of a pool and a transaction so you could imagine there's a hook that runs at the beginning of every swap before every swap run this code after every swap run this code at the moment of pool creation run this code before adding liquidity run this code before anyone removes liquidity you run this code and so you know the the hook for a fee might be like code that runs uh before every swap or after every swap um limit orders might be you know would also be code that runs you know during during the swap transaction so maybe another kind of interesting hook that we designed is uh there was this paper that uh you know Dan and Paradigm put out a while back uh called tum which stood for a Time weighted average Market maker um long kind of don't don't want to go way into the the complexity and in the weeds of it but essentially when you think about uh a usop pool and people who want to make very large orders uh you know very large orders if you're relative to the size of the pool you're going to get a lot of you know price impact and and you'll get a worse price and so usually when you have to make a very large order if you want to trade it over uniswap you know you would probably want to break that order up into many pieces uh and and you'd have to you know submit a step a transaction you know through you know spanned over multiple blocks and that kind of like reduces the sort of price impact of your trade and uh you know Tom is this idea of essentially creating long-form orders uh on top of amms that would basically split up into little pieces and could execute over time and you could have them happening in both directions and so it's sort of reducing the price impact of a trade and spreading it out over a long period of time uh so you could imagine like sell 1 million usdc over the next day or over the next hour or you know the next week um and this is a really interesting cool uh feature and to do it properly you can build it externally but to do it properly and have it really you know benefit from the liquidity within the protocol um then you you actually do need to have it you know run at specific points in you know you need to sort of guarantee that it's going to run uh before you know before swaps happen or before people added or remove liquidity to properly do the accounting and so you can build this entirely as a hook uh and we think this can be really powerful for you know one example is for like protocol treasury rebalancing um stuff like that uh you know or just generally large orders and the nice thing is that it you know it executes your order of a very long period of time but you only pay you know the gas costs uh at creation and and closing of the order those are two examples so the point is it expands from like you know customization of of pool parameters like the fee uh like how fees work um which which can be really interesting and meaningful and actually change the economics of a pool you could try to have a pool that favors passive liquidity providers more than active liquidity providers if that's what you want to do um uh but it also ranges to like entirely new you know order types like tum and limit orders um have a few other ones I'm very excited to talk about as well yeah I definitely want to unpack all every single one but I really just want to double down on the um emphasis that this new hook feature inside of V4 pools brings to the table with the uh with regards to developers so just going back to the the the fees hook example where uh right now uniswap V3 has you said four feet tiers I believe it started as three then you know swap governance and voted in a fourth and so these are four fee tiers at a uniswap V3 pool could be created under and the reason like you said the reason why only four is because we need to coalesce liquidity under shelling points right just pick four of these don't like tens too many one or two is not enough but we need to have convergence of liquidity upon specific pools in order to have any liquidity at all and you said that well we were interested in unitop Labs or uniswap in general was interested in making a more Dynamic uh version of fees that would be more flexible to incorporate wider ranges of fees based on certain parameters but you you all didn't want to create that because that was an opinion and you didn't want to make that as a part of a core V3 contract but now with hooks we could have someone or some group of people create that logic for what is a flexible and adaptive fee structure for most types of uniswap pools and that could become the new shelling point of the new standard and so I'm assuming like over time certain hooks certain apps uni apps uni widgets will be developed in public with many many people and one or a few will emerge as like the leading hooks for generalized fee tiers for Unison V4 pools or this is the leading most Incorporated most hooked in feature most hooked in hook for on-chain limit orders and this is now the the on-chain limit order hook because this is now no longer being developed internally to to the protocol this is now developed externally as a part of like just building on permissionless open source rails and so like a lot of this complexity of how to make a flexible adaptive uniswap V4 pool is being pushed to the margins and allowing the shelling points of what are good Hooks and what are good Unison features to be kind of determined by the free open source market is it my own track here yeah exactly I think you know uh We've definitely I've definitely trended in my own like thinking you know just seeing how it plays out towards just more expressiveness more flexibility over like super constrained selling points I think shelling points are really valuable but I think that the shelling point will happen over the best designs um no we'll mention that there's sort of this there are like a few other features of before that blend really nicely with hooks that I just want to quickly mention um that that help which is like uh so this is the other kind of kind of core feature is a bunch of architectural changes uh to the contract that we're calling Singleton and Flash accounting um which essentially are aimed at significantly reducing the cost of fragmentation across many pools and making it much more efficient to Route across many pools so we're you know we're entering a world of many more pools and cool designs and what we're trying to do is um you know say for cools within this unit swap but within the swap ecosystem uh can we you know significantly reduce the cost of fragmentation and make it easier to ride across more pools uh more efficiently uh so the the Singleton design essentially is saying it basically has all tools live in a single smart contract and Flash accounting is just a new way of doing some of the the logic that basically makes it easier to you know right now when you make a trade that executes across many pools it's basically like sending tokens between pools and it has like a very opinionated order of operations um and the core idea of flash it kind of kind of like the way flash loans allow you to like take whatever you want and then do everything you want and then as long as you've paid it back at the end uh use swap V4 actually lets you basically like do anything you want across any number of possible order you know transaction types within all unit swap pools as long as across all of it at the end it's like you know it's sort of reconciled and solvent and then only transfers net balances in and out of the pool um or actually you don't even have to transfer it in or out of the pool but that's that's another little feature that we can come back to um but but the general Point here is that like hooks introduce much more expressiveness uh many more different pool types and uh you know Singleton and Flash accounting basically just make it you know more efficient to Route across more pools at once and also I think that the one other thing that I'll note there is that you know uh today there's sort of a cost to fragmentation across amms that's sort of imposed on the space you can think about like the more amm pools exist in the more places there's like gas costs to constantly be our there's like sort of like you know ethereum only has so much capacity uh to some degree obviously it's like uh um and basically there's like you know a cost to constantly arbing across all the different amm pools and there's also a cost to splitting your order across more pools and so uh one of the nice sort of things about unified V4 was like as a as a platform is that if you build your you know custom amm logic uh within hooks instead of externally you actually get to benefit from this sort of like shared uh shared uh contract pool model which will mean that you know building your Innovations within your swap will actually lead to more efficient routing across everyone else building within uniswap and they sort of like a nice Network effect and and benefit to doing that okay I want to pull um two things you know out of this Hayden so that you know the first is when we talk about uniswap uh V4 we're talking about you know a specific set of features one is hooks which we're going to spend even more time on I think now there's a Singleton which you mentioned and uh flash accounting right I wanted to go back and and um talk about this design philosophy where where you're saying with uni swap V4 you guys are trending towards more expressivity which is very interesting because this is kind of counter to the reason you picked those you know four different uh three different features for uh uniswap uh V V3 pools so then really the idea was so that you don't lose um like liquidity right so there's not you know thousands of different uh pools out there and and you're kind of like spreading your liquidity too thin across all of those pools I think what you're saying is because there are some incentives or benefits through Singletons and through flash accounting that's sort of there's almost like a tax like a non-explicit protocol tax but like uh an efficiency loss type tax native to uniswap that will still collapse towards a small like more shared liquidity I guess what I'm trying to ask is why are you no longer concerned about like the thing that you were concerned about in uniswap uh uniswap V3 which is like well if we're creating the opportunity and the the white space for all of these different pools we just lose the network effect we lose all the liquidity and there will be no shelling point in a specific set of polls why is that no longer a concern is it because of Singleton flash accounting and kind of still the inherent efficiency that you that you gain here or like why the why the change in uh rationale here uh so I should quickly clarify there's not a tax there's actually a benefit basically if you build you know uh your sort of custom amm as a hook within the unisoft Singleton contract then it is much more efficient to Route it with other uni swap pools um than it is to route you know say between like uniswap and an external amm all right so you know generally most people are trading like right today when you trade across multiple pools there is sort of an inherent tax to trading across multiple pools and what we're doing with Singleton and slash accounting is essentially reducing that tax significantly when you're trading within the unit swap ecosystem so it's all carrot no stick is the weight yeah no no stick here um it's all carrots we're basically saying you know yeah you know if you build an entirely separate amm then there is going to be an Inc uh then a trade that sort of splits across you know uniswap and this external amm will have a higher Gap you know has like a higher gas cost similar to how it does today right it's not it's not there's no stick on that either um but if you build your custom amm within uniswap as a hook it actually is more efficient to route and that happens because of essentially this like you know all the pools are stored in the same contract and we have you know cool ways of doing some of the the accounting logic and even you know transient storage which is in the next ethereum hard Fork kind of plays a little bit of a role here where we're using transient storage to more efficiently you know update internal balances um and save gas there as well uh but no it's it's really purely a benefit in terms of like uh liquidity fragmentation more broadly I'd say that uh I still believe like shelling points will kind of will exist um and there's even like ways of helping encourage that through like interface and default and all of that uh but I think that we're also uh starting to say is that yeah yes shelling points will exist but also this Innovation is going to happen um let's make it let's have it happen as safely as possible let's have it happen you know within the uniform ecosystem let's you know let's let's speed up let's speed up the rate of amm innovation and uh allow shelling points to form around some of the best designs uh as opposed to just around like uniswap as a monolithic thing I'd also mentioned that like some of the network effects are really just like you know infrastructure that we yeah Us and other teams build around the protocol and I think that having them you know all having more stuff built in teams wealthy four like they'll still be sort of this network effective tooling and and Integrations and uh to some degree even like the like the security and safety of it um a cool thing is that like when you're building an entire custom amm that's a really complicated smart contract you kind of need to audit the entire thing from scratch and uh with hooks you know you need to audit the hook basically the you know it kind of like the same way the ethereum lets you build you know say smart contracts it doesn't prevent you from making unsafe smart contracts um you know it's similar I think of a similar thing to hooks where hooks make it out you know possible to build very safe Custom Pools uh that have very limited you know functionality um very you know a hook that changes how fees work is very different from an entire amm that changes how Futo uh work in terms of like your starting point um and and what you and how easy how easy it is to build how fast you can build it uh how easy it is to audit um Etc and so you know all krtia we're trying to make it you know a safe uh and easy to innovate and then the LA the the point uh being really just like we're also trying to you know we do expect there to be some additional fragmentation but we're all uh but we still expect uh showing points to happen and we still um and we basically taking uh the the cost of fragmentation is being significantly reduced not increased so there are some really strong parallels between unit swap V4 and the ethereum roadmap um I I I see the parallels here I call I'll call this like a hook-centric road map for uniswap whereas ethereum has this like roll-up Centric road map unisoft has now a hook Centric road map and I want to get to that conversation but I think we need to start there with the Singleton contracts uh the Singleton design unit swap V3 and V2 and V1 I believe all had this thing called a factory contract where uniswap pools uniswap exchanges were spun out individually and they were all separate contracts so if you made a new token and then you made a uniswap pool to correspond with that new token that is a brand new smart contract on ethereum that is the same contract as like The usdc Ether uniswap pool but it's still a separate contract and so a Singleton contract is something that's the opposite of that can you just unpack that a little bit more Hayden like what does it mean for everything to be under or one contract yeah so you know what it means is that we're duplicating the same code across a million different smart contracts and that has a cost to everyone and so uh yeah one one cool thing about Singleton design is it actually reduces current estimates have it have it reducing the gas cost of full deployment by about 99 wait what um yes it goes from like uh gas costs vary a lot but you know you can imagine some sometimes people pay when gas costs are high like north of a thousand dollars to deploy a pool just a gas cost and uh that same deployment would be something like ten dollars um again because you were just updating a pre-existing contract yeah most of the code isn't being replicated it's just like adding a little you know adding a little thing like you know making a little modification to an existing contract it's not deploying an entirely new smart contract uh so gas costs for deployments go down massively that's sort of like one of the advantages um there were designs that that actually did reduce the gas cost for V3 but in ways that slightly increased gas costs for swappers um you know that was sort of like this design a lot of people use where you like call out into like a library contract but um that that's sort of like one of the benefits of Singleton um the other benefit is that when you you can imagine like transactions that interact with multiple pools and have multiple interactions with multiple pools um a lot of what they're doing is that they're updating like the same you know uh like you can imagine like let's say I'm doing like a a multi-hop swap I'm going like e to die to usdc or something um that actually involves like you know routing Ethan to the ethi contract and dies sent from the die eat the eye contract to the die usdc contract compared to usdc and then usdc spent sent back to the user um when you have everything stored in the same contract those internal transfers don't actually need to happen right there sort of like ephemeral and uh ethereum already today has a method of basically if you are updating it so so one thing is that there's basically like less uh less transfers happening um under the hoods when you have like multi multi-step transactions or transactions about between many pools ethereum has like a this thing called a gas refund it's super technical into the under the hood stuff but might as well for for those who understand us mentioned quickly ethereum has a thing called a gas refund which basically means that if you are updating you know something and then the same thing multiple times is cheaper than uh then basically you know updating different things uh because you know there's like that's easier on on an ethereum node essentially um and we'll get out of the weeds in a second but um uh the refund has like a cap so basically there's like a limit to like if you update the same thing like a thousand times like the refund sort of runs out and then you basically don't actually get any of the refund um so there's this new proposal called uh transient storage which is slated for the next ethereum hard fork and that provides additional benefits where you can actually you know uh have save on gas for for things that are you know updating the same contract multiple times uh well beyond the sort of refund which was capped out at 20 of the of the sort of gas provided to the transaction um so there's like additional gas savings kind of like on the Forefront of the the next ethereum upgrade which is kind of exciting am I Mis remembering that was there some controversy about this particular uh ethereum upgrade at all or like uh you guys you guys refresh me on that I think that like there was a desire I think that it was like a very it's like a very obvious I don't think there's any controversy around like the proposal itself it's like technically very sound and like there's no real controversy found it um I think that there was like a strong push to to have it happen in the previous hard Fork uh which which didn't happen uh in perfect three thought it was like an obvious win for for developers there's many other projects that also want this and want to build on top of it and have come out in favor of it and but you know It ultimately didn't make it into the previous ethereum hard Fork because there was you know that was the the there's a lot of other things happening in that hard Fork um but it was sort of very non-controversially added to the most recent one because you know it's very far along and it's not competing with the merge and um so it's yeah you know it was kind of a little bit of like a day of drama on Twitter but there wasn't really like at this point it doesn't feel controversial at all so I want to see if I can get bankless listeners heads dropped around this pattern that I'm seeing with uniswap and this is again goes back to the whole like hook Centric road map for for uniswap um so a while ago a long time ago ethereum's long-term Vision came to be defined as like this roll-up Centric road map AKA like Roll-Ups are going to be treated as a primary concern for ethereum's design philosophy the the just the ethereum researchers came to the conclusion that Roll-Ups are like the ultimate form of expressive apps for ethereum in terms of scalability and so the idea was that ethereum would constrain the layer one push complexity to the edges using Roll-Ups and this became like the modular ethereum design philosophy the ethereum layer one does not need to be concerned with doing it all and that role can be pushed to the open source community building permissionlessly in the free market which is why we have so many Roll-Ups teams building different Roll-Ups scaling strategies polygon optimism arbitrum ZK sync uh you know I'll scroll Tycho all these crazy things and the only reason why all of these ethereum microcosms exist is because of the Primacy of the roll-up Centric mode map for ethereum I see that same pattern playing out with uniswap so I think I want to check this metaphor with you Hayden make sure that this is right but I I think unit spot V2 and V3 where we had this deployer contract this Factory contract that spit out new unit swap contracts that were all disconnected to each other is like the cross L1 Bridge version of layer ones whereas the Singleton contract is like the roll-up Centric roadmap for ethereum because everything is placed into the Singleton contract everything is under one platform there is a very constrained reductive base call it uniswap V4 pools and then there's hooks hence the hook Centric roadmap for uniswell these are my words I don't know if Hayden accept these words uh the hook-centric roadmap for uniswap places complexity back into the base of unisplot V4 via Hooks and hooks are freely developed in public they are highly generalized for all Public public pools to use or they can be pool or use case specific kind of like roll apps or app chains but we can have hooks that are just meant for one or a few pools or we can have hooks that are generalizable and so now we have modular ethereum and now we also have modular uniswap Hayden do you accept this metaphor would you throw any Flags I accept the metaphor you know I think that definitely like we are definitely going to like modular customizable unit Swap and I'd say that like it's not as like ethereum it's not too incomplete the way ethereum is um but it's much more expressive and it's you know if you have like a like a gradient of trying completeness it is more train complete than you just thought V2 it's more expressive and really you can and do a lot of things with hooks and we are definitely pushing complexity to the edges uh we're definitely um you know encouraging a world of other people to try like there's no clear single way the best way to scale ethereum and so ethereum is you know allowing other people to experiment with the best way to scale ethereum and you know I'd say that you know swap you know very similarly there's no single best pool design we're enabling a whole world of experimentation so definitely like the the metaphor lands for me um in that way for sure um I'll also mention just casually not don't open a whole can of worms with this but like technical unisoft is also on a roll of centric roadmap and that we all are because ethereum is on one um and so I think that that's definitely like an Avenue of a future exploration um but sort of like kind of parallel to V4 um Hayden while we're on uh Roll-Ups for a minute can you also describe uniswap's approach to all of the various Roll-Ups um I I know that's kind of orthogonal to our conversation today about uniswap V4 but will uniswap have a presence on all Roll-Ups or or how does that work yeah I think that you know like we're all on this we're all on this role of centric roadmap Journey uh in ethereum right now um and I think that we've been you know today it's really been about like uh supporting the the Roll-Ups you know on the protocol level it's you know there's been this whole process around governance and people are you know doing votes to deploy to different different chains um but uh you know within and within Labs products we're kind of like supporting chains as there are like you know ones that are have users and it's like almost like worth the time to do the work and it is a lot of work to support new chains in our in our products um but yeah so it's really a bit about like just making sure that unit swap is on all the chains that get traction and and have usage and unit swap V4 would be on all the chains which is yeah V4 similarly would be on all the chains okay in terms of like if there's a a future like world where there's like a unswop specific roll up or something like that I think that sort of like remains to be seen I think it's like a really interesting Avenue of exploration um you know the sort of whole like I'm personally excited by like some of the like off chain vision and all that stuff but um and you know as I mentioned we're kind of like all on this role of centric road map there's no like getting off it because ethereum's on it um sometimes I think that people almost don't even like internalize everything that that means but um yeah it's it's a it's a pretty cool interesting direction for ethereum uh I think that maybe what I what I was getting I think that there's like a lot like scaling execution is actually pretty hard and there's like it's gonna I think take I think it like kind of makes sense that ethereum pushed that to the edges but I think that sometimes people almost like underestimate how much that work there is to do on the roll-up side and how many like how big of an effort that is right it's kind of like in the long run maybe it's like more of an effort than like building ethereum itself um to like build the right role of San ethereum um no anyway yeah I completely agree I mean part of modular theory in the red Mac uh roll-up Centric um design roadmap was obviously uh focusing ethereum on what it does best the core and the consensus layer but also I mean some of these problems are complicated they're complex they're thorny and so nice to push them up to other teams rather than have ethereum research teams sort of do everything right I don't know similar to stretchy with hooks but yeah I think that like I think it like it both makes sense but like there are like implications to it right where like the more you push to other teams like the less like there's sort of like there are sometimes benefits of working on multiple layers of the stack it's something that we've learned a lot at uniswap is like or even like working like having a mobile wallet and having like a smart contract team and a protocol like having so working multiple layers of Stack we're like able to kind of like sort of innovate across the stack a little bit and like you know there are things like like even like it came up in this conversation where like EIP 1153 is like provides very significant benefits to uniswap uh V4 and that required like it you know it was sort of like already a proposal that happened many years no the initial proposal was like before the V1 launch so this idea has been around for a long time but like they're sort of like this like um sometimes there's like a if you don't have the right like layers of modularness or and like some like if you don't have enough expressiveness in each layer like then like you you sort of uh can run into like constraints yeah uh of the system in which you're you're building so like that's the risk of hooks it's a risk of ethereum's road road map uh but it's also like uh ultimately you know it kind of makes sense as well um it's definitely a trade-off though right it's like I was thinking of uh vitalik's most recent post where he talks about the three transitions by the way he talks about kind of everyone moving to roll ups that's going to be a massive transition for ethereum that everyone has to move to Smart contract Wallace and we have to somehow figure out how to get privacy working there is something nice about the monolithic Vision uh because you can control all layers of the stack and so like what gets what gets uh sacrificed or maybe trade-off is is the right word for this in a modular um kind of um structure is user experience sometimes it can be difficult to weave this all together whereas monolithic has other challenges but you have the opportunity to get kind of user experience down but let's get back to kind of the the hook Centric road map for uniswap who's going to build hooks who are the who are the devs who are the builders that actually like we know in the in the roll-up Community uh all of the teams building Roll-Ups and kind of the advantage to doing that they want to create their own kind of ecosystems build their own chains lots of reasons for doing this who are the builders behind hooks what will they look like what are they going to team up yeah there's so many possibilities and like we only we're kind of like constrained by like what we've already thought of uh but there's like so many other like we kind of expect maybe the coolest will be ones that we haven't dreamed up yet um so once we've already mentioned are things like you know so obviously we've built a few hooks uh almost to like prove the system um so right some of the ones we've already mentioned were like T WAM and limit orders and swap fees I think um you know we expect like probably one category of hook Builders like people who need you know basically people with you know projects with on-chain protocols that interface and interact with you it's basically the people who build on uniswap today but they can build on it in like a more meaningful way um so like any any like project that has unit swap as like a core component of their system we expect that they can build what they're building in like in like a more efficient or more meaning or more expressive or better way with hooks um and so so that's sort of one category I'd say that like people who want to expect like anyone who's like building an amm today uh I don't know maybe they'll continue building their own amm it sort of depends but definitely the type of people who would go out and build a new IMM might be more likely to say okay well rather than building a whole amm why don't I just like you know try it out as a hook um and you know so so liquidity providers I think you know uh D5 Builders uh is it accurate instead of starting your own layer one why not just build a layer roll up on ethereum it's the same conversation exactly is it is it is it accurate to say anybody who wants to use the verb swap you know in the early days of Bank list we used to talk about uh making all of kind of these money verbs uh basically you know real and and bankless uh verbs like you know lend borrow a verb that uniswap is dominated has been trade or swap anyone who is sort of doing swap functionality is started as part of their application whether it's a uh some sort of aggregator like a matcha for for example uh maybe they're they're dealing with swap anyone who's working with the swap verb might have something that they can build as a hook with uniswap so that kind of opens the door to basically any application that needs this basic trade swap type primitive is that correct yeah I think I I do like to think of like the two sides of the marketplace where it's definitely like swapping and also like creating liquidity in the first place forget about liquidity providers yes they're they're important lunch although sometimes you know not talked about as much as the swappers but uh creating liquidity anyone who's creating liquidity in any way like I'd say that like this just provides so much more flexibility in how you do it now it's very possible that like certain hooks will be much like a few hooks will rise up as like the most popular used hooks uh you know if I had to like take some guesses things like you know some of the ones I already talked about might be examples like um so certain books might be like the most used and maybe like most people interact with hooks just by like adopting a few common ones that like change in meaningful ways but then yeah like really anyone that creates liquidity uh might want to create liquidity in more expressive interesting ways um as well as like anyone building a protocol that needs swapping functionality um yeah I could give like a few more examples of hooks that we we've talked about and thought about or built examples of yeah go for it um to help spur some of this so um I guess you know one example is even like um this one is more theorized we don't have an implementation of it at the moment um is so at any given moment for even swap trade there's like you know you just swap V3 split the pools up into like discrete ticks and then like there's like liquidity exists between texts and it's almost like many unify pools for each uh split up into each tick um and uh you know we sort of theorized about like the idea of like vaults that stored out of Rage liquidity and lending protocols and it would sort of like pull them out and and um when as the trade got closer but that wasn't uh super easy to do in unison V3 because you don't sort of have a guarantee that you can pull liquidity out of the lending pool uh before the trade you know crosses a certain price whereas with unison V3 you actually can or before you actually can using a hook and so an example is just like increasing your yield where like all liquidity that's not stored in the current Tech could be stored in a lending protocol and earning you know whatever whatever it's earning and then as the price crosses out of the tick just in real time could pull the liquidity out of the Lending people um and and start trading into it and in that way you don't actually have to like uh there's sort of like the risk in in V3 if you do it externally that like you you don't pull the liquidity in time and and it sort of gets like you know uh rebalanced in a way you weren't expecting or something if you were to try to do something like that so like increasing your yield by by building a a thing that you know stores extra liquidity Landing pools but does have a guarantee that it will be executed at the time of this that it will be you know included in the contract at the time of the swap uh it's like one pretty interesting idea um we haven't built this but we know it's possible um and this is an interesting class of designs that might come up this might like you probably most of these will like use the the swap fee hook um but uh just like attempting to to internalize mvv better for liquidity providers you know there's sort of like a lot of uh liquidity provides a lot of like value is is kind of um like they're sort of yeah people always talk about Mev and how do we like kind of keep more of that for our swappers or for our LPS and I'd say that like there are definitely classes of hooks that can attempt to do that whether by like adjusting the the swap fee in real time or or proportional to the size of trade or whatever it is you can uh you can even do things like auctioning off like like basically allowing people to like um you could almost do like a hardware attacks or something for all fees in the pool and so basically it's like kind of like like again this is like sort of theoretical we haven't built this we haven't like proven it but um these are sort of like General places our brains have gone is like you could allow basically anyone to set the fees for a pool and they could pay liquidity providers for that right and then you can imagine in that way like uh you know the Mev is sort of internalized into some degree by like properly setting the fees uh and and uh paying paying it out to liquidity providers so those are like maybe two even like kind of more complex examples but um and then just like there's like so many different kind of uh ideas and designs in the amm space people are always talking about them we're always having them uh but today we like aren't it's never worth it to build it because it's like we can't that like we can't build the entire next version of the protocol around one of these ideas um they're just interesting ideas um I'll mention another category of hook that exists is actually um potential with withdrawal fees as a hook as well so fees take today fees are only taken on swapping um and before it's actually possible for hooks to take fees on adding and removing liquidity um which is and could like sort of redirect those back to LPS and so in that way you could kind of like for example like have like uh you know more the more active a liquidity provider is like maybe like like you could sort of like have some of those more of those fees go to passive liquidity providers and maybe passive liquidity providers would be more willing to provide in those pools um so they're like sort of like some kind of additional examples um I I think that there's like so many though you know any project that needs an oracle um probably will be tempting I think that like even V2 like V2 and V3 oracles they weren't just like opinionated there are also weaknesses of them because they they were they were like opinionated in that we you implemented them but they were kind of like trying to be very neutral in what they were because they were trying to serve all possible oracles but that's not very um you know maybe the best Oracle is is removing out loud or removing outliers and doing on-chain medians and all these other things um and so anyone that wants an oracle now you can actually build your Oracle into a pool and you sort of have a guarantee that that Oracle is like that that pool is like tracking it it it's sort of the difference between like a you know you could build an oracle external to a pool but that pool can only like read from the pool at moments where it is like asked to do so um versus when it's in a hook you have a guarantee that that Oracle can be updated at every swap or at every provider or every interaction with the pool until you sort of have a guarantee that that uh that Oracle can always be super up to date and so you know if you think of it as like any contract that needs to be updated uh with you know any specific type of interactions with a unisub pool can now be fully up to date and um and sort of uh kind of it doesn't need to rely on like being poked externally by people um which is which is like kind of interesting learning about crypto is hard until now introducing metamask learn an open educational platform about crypto web 3 self-custody wallet management and all the other topics needed to onboard people into this crazy world of crypto metamask learn is an interactive platform with each lesson offering a simulation for the task at hand giving you actual practical experience for navigating web 3. the purpose of metamask learn is to teach people the basics of self-custody and wallet Security in a safe environment and while metamask learn always takes the time to Define web 3 specific vocabulary it is still a jargon free experience for the crypto curious user friendly not scary metamask learn is available in 10 languages with more to be added soon and it's meant to cater to a a global web3 audience so are you tired of having to explain crypto Concepts to your friends go to learn.menimask.io and add metamask learn to your guides to get onboarded into the world of web3 hiring people worldwide paying them in crypto providing them access to benefits it all so complex but it doesn't have to be complying with labor laws payroll rules tax obligations and crypto regulations in every country that you employ someone is difficult time consuming manual and costly and it's drawing more and more attention from regulators and governments but there is good news toku is here toku is the first employment and compensation platform for the crypto industry that makes this easy toku helps you hire employees or contractors and pay them in Fiat or crypto legally compliantly and with all the taxes handled in over a hundred different jurisdictions so whether you're an early stage company with just a team of two or you're an Enterprise with 200 toku has a solution that meets your needs toku is already working with the leading companies in the space protocol labs hedera Bitcoin and many more so transform your employment and token payroll operations with toku you can reach out to toku at toku.combanklist or click the link in the show notes introducing ethx from stator ethx is a liquid staking token designed to maximize rewards all while securing ethereum with stator you can run in an ethereum node with just four eth an 85 lower Capital requirement versus the 32 eth required for solo stake with Staters four eth nodes you can get a 35 average higher yield since you charge fees to those who use your node to stake their ease by running a node with stator the ethx staking derivative token can get minted on your validators and can flow into the world of D5 which data is actively building Integrations and Partnerships into to increase the utility of eth X stator allows for both permissioned and permissionless nodes to join the network maximizing its potential scalability for ethics while preserving the values of decentralization and openness behind its liquid staking Toad go to statorlabs.com eth and sign up to get access to the stator staking protocol arbitrim 1 is pioneering the world of secure ethereum scalability and is continuing to accelerate the web 3 landscape hundreds of projects have r already deployed on arbitrum 1 producing flourishing defy and nft ecosystems with a recent addition of arbitrum Nova gaming and social dapps like Reddit are also now calling arbitrim home both arbitrim1 and Nova leverage the security and decentralization of ethereum and provide a builder experience that's intuitive familiar and fully evm compatible on arbitrum both Builders and users will experience faster transaction speeds with significantly lower gas fees with arboretum's recent migration to orbital Nitro it's also now 10 times faster than before visit arboretum.io where you can join the community dive into the developer docs Bridge your assets and start building your first app with arbitrum experience web 3 development the way it was meant to be secure fast cheap and friction free there's something that you said that I just want to double down on because it just gets me really really excited excited uh you said that you and other people at uniswap Labs I'm sure just anyone that you talk to about nerd stuff about uniswap uh like all of these ideas of what could be placed into a pool unit swap V3 would could didn't have a way of receiving those ideas and so every time like y'all are having your like serial futurist Daydreams about what a crazy unit swap for pool could be I'm just I'm just bullish on the fact that unit swap V4 can actually receive those ideas now because whereas unit swap V3 was constrained in its ability to accept expressivity unit swap V4 can now start to get like pretty crazy and pretty weird and so that makes me bullish well that's what's interesting exactly that's what's interesting about this Hayden even the the word choice that you're using you're calling these things hooks as opposed to like maybe Widgets or as opposed to like apps or something like that and I guess look you know I'm not a programmer I'm sure the the term hooks is used all in all sorts of other places the the there I'm familiar with it is uh you know in um CMS platforms like WordPress right which is like in WordPress is this kind of ecosystem where anybody can kind of create a hook in WordPress and like Hook is not like it's not a specific app it implies kind of openness it implies permissionlessness it implies anyone can develop it and it could uh it's broader than an app it could do something very small like Implement a captcha service on WordPress or it could uh it could do something entire very big like Implement an entire um you know feature set on top of Wordpress and so I I'm curious what other like where um maybe an analog to this in another developer ecosystem why did you use the term hook rather than app or rather than widget or or something else I I mean I think you you nailed it like beautifully said I I think it's like you know it's I mean part of it is it's like moments at which the contract like it's not it's sort of like kind of a moment where the contract can like call out to another like it's sort of like uh there's sort of like moments where you can like inject code in an arbitrary point and that folks just felt like a good kind of moment for that versus like a widget or an app sounds almost like marketing or like branding this is sort of more like you know a low level code base kind of feature um so that's part of it um I could mention even like something here quickly on like the history of how we came up with hooks I don't remember actually specifically who like I like it sort of has been an idea that's been in our brain for for a while um but it came out of this idea that we had had this was before V2 one of the features we were considering in V2 was a external contract that basically it had the right like sort of first back running rights to the to to every trade uh and what that what I mean by that is like you know when someone is making a trade that moves the price from away from from market price you know away from the market price there's sort of like a back running kind of opportunity um and you know giving back running rights to to if if you are sort of like auction off those back running rights uh then you can sort of uh give you know some of the The Profit back like you can basically reduce the kind of price impact of a trade um and that this is sort of a design space that is still very relevant today you hear the flashbots team talking about it you hear you know it's it's something that people talk about when they talk about like intense uh right it's like uh like how do we kind of reduce Mev uh and so we had this sort of I you know General concept of like what if at the very end of every uniswap V2 swap uh it arbitrarily called a specific contract in that specific contract had you know was able to if if you know with preset prices built in the contract would be able to kind of like trade back in the other direction and then like re-share some of those profits back to the swapper um and and then maybe like you sort of like auction off that that external contract now we call this like idea like Trader Dow or something and it it's sort of an idea in the back of our brains for like literally since uh before V2 launch um and you know it I I think that's sort of that like the like the idea of that feature where it's like at the end of every swap do this and then we we sort of ran into that pattern again with the oracles where it's like like at the beginning of every swap if it's the first swap of a transaction if it's the first swap of a block then update the Oracle and we start to realize that like over multiple points within the transactions life cycle where you like wanted to do arbitrary things sometimes um and so that's sort of like where hooks came from is like let's like it came out of this like idea of like oh there's a time in a transactions life cycle where it's useful to like immediately execute some other code and not allow any other code to execute before that code um and so that's sort of like where some of this like comes from uh historically and now those ideas like the trader Dow idea that can be implemented as a hook yeah yeah exactly and like maybe it was a good idea maybe it wasn't uh you know it's sort of like a you know 20. now we can find out in like 2019 yeah I think that like even if we were doing it today we'd probably do it very differently from how I just described it but like um yeah you know now we can find out now like anyone can run you know an experiment in amm designs much faster much more easy um yeah so super super exciting I'm just gonna put on my speculative cap here and I bet you there is a bunch of use cases for token minting and token issuances that um I'll probably not ask Kaden about and I'll just leave that to the imaginations of the listeners that there's probably a way to do a token issuance with this as an app on uniswap that is developed by the open source Community um we should as a hook as a hook yes right um I have a question about some of the bigger pools so it makes the you just swap V4 with you know specific hooks that do specific things sounds like from the individual developer standpoint awesome as an I can do cool new things that I was never able to do before but some of these bigger pools in uniswot V3 have a ton of liquidity in them like the dye ether pool The usdc Ether pool and if we are assuming that we can make a better V4 pool for these very large V3 pools we're gonna actually need to get that liquidity to migrate and it's gonna it's an open interesting question as to like how do we determine what who decides what the best usdc ether pool is on uniswap V4 and how do we even have like a shelling point of like hey you can swap V3 liquidity go to unisoft V4 it's better now how do you think we're going to get this to progress like how do you think do you think we are stuck inside of some some pools are stuck inside of Unison V3 forever how will we get migration to happen do you have any thoughts on this by the way I remember being really worried about this with V2 and I was like well how are they going to get all the liquidity to move from V2 to V3 well V2 to V3 was a a paradigm shift in liquidity expressivity and that to me that made sense because of of uh concentrated liquidity with this one I'm not I don't know I don't know yeah I mean for what is for it like the unisex pool the biggest unisox pool is still in V1 um and so yeah I think that like the the answer is like a combination of things it's like a really interesting complex topic but like um you know I'd say that like V1 you know V1 almost no one uses only it's mainly only used for unisex trading at this point uh which is which is pretty fun um V2 still actually gets a lot of usage and New Pools created um V3 obviously even more you should just especially by volume because we should tell people just just for the listener who's not familiar with how uniswap works is the contracts never die once you deploy V1 V2 V3 they live forever they're out there anyone can use them just uh like as the day they were first deployed they don't go away so almost like a new version of uniswap has to earn its place in the in the world earn its liquidity it has to earn its uh swap users has to earn the market doesn't it yeah so I'd say that like with V3 what's really interesting I've talked with before um I actually don't expect as fast of a migration as from V2 to V3 um or from V1 to V2 I think it will be you know probably a little bit slower migration but that like the long-term Network effects of the sort of gas improvements of pooling liquidity within a Singleton contract like basically like maybe the initial liquidity pools in V4 will really be like specific use cases that needle use you know a huge fluffy for hook but the more of those that start to get created the more liquidity that starts to get you know in this Singleton contract suddenly like you can create an identical pool like you could make the same trade-offs V3 data in V4 and you know you'll now have more efficient routing against other V4 pools and so I'd say that like over time the sort of like shelling point of the Singleton contract and the benefits of pooling liquidity will will win out and so I do expect like a slower migration relative to V2 um just because it's like more complicated there's more things happening there's like it's a bigger ecosystem V3 is like extremely efficient uh relative to V2 um there are a bunch of other improvements to use before that I haven't mentioned yet which might be a good now now might be a good time to mention some of them because I think that they get at uh some other kind of reasons to migrate um uh still kind of relating to like gas efficiency and and shelling points but um I said that like uh so maybe in no particular order um one one uh interesting so one we we support native pools again so V1 had native every every pair was every token was paired against native eth um so maybe a context for I guess thankless listeners who don't know there's rap teeth uh which is eth that is a you know represented as an erc20 token and then there's native eth which is like the the native token to the network um and transferring uh Native is about half the gas cost of transferring rap teeth uh but it doesn't you know it can't be used in certain Square contract patterns um they live in the name of like kind of like code Simplicity uh we moved to only wrap teeth pools uh because it allowed you to to treat uh Ethan wrap teeth it allowed you to treat eth as an ear T20 token and you didn't need like a whole separate code base for that um or uh and so but with use what before we were bringing back uh raptis or native East pools which do provide significant gas savings for transactions that are you know buying and selling eth um so that's one benefit um another benefit is so another kind of interesting feature that is kind of like it's like cute uh it's not like game changing but but interesting is um you sort of allow we actually allow we've kind of taken the flash accounting stuff I talked about right which is like oh like I kind of can do a whole bunch of things and I only transfer some amount of tokens and some of that out and everything that happens in the middle can sort of be reconciled um with uniformity for it we actually that was almost a lie because you actually don't even need to transfer tokens in or out sometimes um and what I mean by that is that um if you buy a token and your only intention is to sell it in the future there's no reason to actually transfer that token back to your wallet uh if you want you can actually just leave it in the so the same way that like pools are separated out by like internal um by like internal accounting you can actually leave your uh your like tokens you buy in the inside the uni swap Singleton contract uh and sell them later and if you do that then you actually don't need to pay the the gas cost of transferring them out of the Singleton contract there's still some cost of updating the like internal balances but it's it's lower so like there's sort of like a nice little benefit there where if you you know if you're buying a token only to sell it you can actually have additional gas savings there's a bunch of these features and actually when you add them up if you imagine like a native Eve pool and you remove the Oracle and you have like maybe you even like buy token and with eth and then you sell it later for eth um and you never take that out of the pool uh you could imagine that across all of that there's like really significant it's possible that you could you could have a contract that has no hooks you know removes the Oracle actually so it's actually less features than V3 um and using native Ethan you actually have like very significant gas savings that we don't have like actual I'm not going to say any numbers because we don't have any gas benchmarks and not all this is uh or maybe we have some but we're they're still kind of like the code base isn't even been frozen yet so we're not ready to like you know be hyping up gas numbers but the general point being like there's actually very significant gas savings to be had here uh for certain use cases and so that also you know could be a reason to move liquidity because lower gas for swappers means you know more trading volume uh means more fees for liquidity providers and so that could be another reason I think why this feature I think is unique even though it's small but it's big at the same time the idea of you can actually leave funds inside of the unit swap contract it really emulates um a centralized exchange but in defy with in with all the D5 values right and so in the same way I can send my usdc or my ether2 coinbase I can now send my ether and uscc to the uniswap contracts defy contracts and they can exist inside of the limbo state of uniswap and then if I'm a Trader I can do a bunch of Trades and then I can withdraw my crypto assets later and the cool thing about this is that it's defy there's no Central custodian it's all protocols it's all smart contracts there's no one I'm trusting with my funds except for the contracts themselves except now it's on chain and so this makes a this makes to me for Traders I would actually be primarily very very interested in this because of the gas savings like I'm sure one of the big reasons why people still host their money on centralized exchanges leaving it up to the trust of humans that run these exchanges is because of the ux and fees that are reduced in the centralized exchange world but if you are able just to leave your money inside of uniswap be charged much reduced gas fees and have those assets ready to trade on a moment's notice like the ux of a centralized exchange would give you this starts to make uniswap very competitive with centralized exchanges on a vector that it has never actually been able to compete before so it's a small thing but I'm wondering if it's actually like quite a quite a big thing I'm wondering your perspective on that it sort of the reason that I'm not making like a massive thing is because it's still like on a relative base like it's like relatively cheaper but it's not like it's not like centralized exchanges there's like no you know it's it's just like a spreadsheet right so it's like there's no gas cost to transactions except for depositing withdrawing here there are it's just we're trying to reduce them as much as humanly possible to you know we're trying to like reduce the the costs of using defy and using decentralized exchanges by by finding everyone got gas you know optimization we can and this is one of them and so I think like the net result of all of these changes is that it is possible to have you know we hope for very significant gas savings um you know all said and done uh but but I don't want to promise like centralized exchange level uh you know scaling because they're sort of like no gas costs at all there Hayden when you add all these things up all of the the features that we've talked about today and you know hooks being maybe kind of the bright shiny object and and one of the the most interesting things out of this conversation um how order of magnitude level how big is this change is this like the difference between V1 and V2 or V2 and V3 or V3 like like how how big is this compared to previous uniswap version releases and you guys have decided to call this four rather than you know a 3.5 or some kind of uh Point release um how big uh is this in the scheme of things you know it's I think that like kind of on its own with like just like if you just like if you ignore all the like the hooks that are going to be built right it's like you know it's only so much better right like all the other changes are like somewhat marginal but when you like imagine it's all like but like you know five years from now and everything that's been built on hooks it's you know uh my My Hope and expectation is that it is a V2 to V3 style a leap um uh more so than like a V1 to V2 although you know I think that each version of Youth off has been legendary and it's in its own right um and I I think that you know the reason that we we think this should be called V4 is because we think this is like a real you know it's like a massive step forward and and you know I I don't I don't know how to put multiples on it but like I'm I'm kind of feeling the 10x you know um but uh so so yeah extremely excited about you swap before I think it's like has just like so much potential and it's such a powerful you know uh powerful developer platform even for for you know Innovation and and building uh on top of liquidity there you know so I don't know extremely another 10x gets us to 15 trillion I might point out so uh that would be quite sizable well the I think the reason why this can be measured as a very big deal is it seems to be an update that allows uniswap pools to continue to update without needing another V5 and so we can have improvements to the uniswap protocol naturally or exclusively emergently without ever having to actually make a uniswap V5 because now this can come in Via hooks so we're done yeah we found the end of the road map then well that's what I said about a V3 and then we got four so I don't know if Hayden's ready to make that promise but it does seem to be like hey first we had um analog cars running on combustion engines and then we got electric cars that had over-the-air software updates and this kind of feels like a transition to that yeah for what it's worth V1 and V2 each lasted a year uh V3 lasted two years and so you know maybe this one lasts like three years right like it's um hard to say like I don't have like a you know a 10x well I say that like look we have ideas for for where things could continue to iterate in the future I think that like probably like that you know uh this is like a huge step forward in the next one um I think like future ones have to be more like if there are like future 10xas or whatever they're probably like more tightly coupled to like Layer Two kind of roll up like like the sort of like ethereum road map and like how you know blockchain scale in the future uh if that makes sense um but uh this feels like a really obvious uh huge win and Next Step uh that we're incredibly excited about is is very exciting and I think bankless listeners will uh we'll definitely be excited about this um and as we draw to a close Hayden I I want to ask you the question about kind of zooming out so we've been in Bear markets before I think uh uniswap very famously was was born in um one of the best worst the worst bear Market that ethereum has ever seen that is the 2018-19 bear Market when ethereum certainly was dead and everyone thought crypto was dead um what's going on with defy these days I mean is defy kind of has it peaked and it's just sort of steady incremental growth uh from here are there any big Innovations left just zoom out and uh tell me about the space because uniswap has been one of the forefather protocols I would say this entire defy movement and uh you've been a huge piece of that Hayden so what do you see right now what is the future for D5 yeah so I guess what one place I'd start is that to me it's less about like fancy new like shiny new things I think that like at times defy has sort of been like made about being about these like shiny shiny objects and to me it's really about like doing very simple things uh better and exposing like benefits to users and so you know like swapping right like we've like you just swap has kind of for our entire you know for the past five years right I've been like working on like how do we make swapping better swapping's like a relative like conceptually a relatively simple thing right I want to convert one token to another and I want to you know and that's sort of what we've been iterating on for five years straight and um there's definitely like cool interesting Finance no complex Financial uh Primitives but for me it's always about like doing the simple things better and you know keep it keeping kind of doing it better until it becomes you know actually better you know until like it can provide more tangible benefits like in the real world right like like how do we make it you know you know like to I think that at times like we can talk about like oh No One controls it and that's great it's like but we also need to make it like useful and usable and put it in people's hands um and and we're kind of like iterating our way to getting there and so I think that like it's really not about like the sexy things it's about like just like constant progress towards uh you know making it more you know making it cheaper making it easier to use like those are like the two like like cheaper easier to use like and just like constantly kind of pushing on that and and pushing on that until we like actually get to a system that like you know where like maybe like you swap is used to to you know let's say that I am someone in the US and I want to you know send money to you know that's like someone us wants to send money to their family in Mexico like you know ideally that should be built on D5 but D5 isn't there yet right people aren't using it yet for that and so people eventually have to build like applications on top of it that are better but like there's still a lot of like we're like in those super early days and I think that like people want it to be in the late days people want it to be like you know production use cases where like hundreds of millions of people are already using it um but we have to you know there's a lot of work to get there right we're like still learning how to scale blockchains we're still like learning how to make like you know amms have only been around for you know five-ish years like as a technology um they're just like very new and so we're just you know to me like the you know D5 is like a long game of like steadily improving uh until it becomes like useful uh to more people and I think it already is useful right there are already like initial early adopters in early use cases but um hey opinion I'm wondering if uh you think we'll get there though if if your confidence has wavered at all I remember there was a time where I you know I I know you you predicted that that uniswap and decentralized exchanges with Eclipse everything in tradfi that we've seen from a volume perspective be larger than s p and NASDAQ and all of these things combined do you do you still believe that's the case do you think we have a chance here yeah I mean look I wouldn't I wouldn't like spend every you know like spend five years working on this and I'm like not even it's like the only thing I want to work on um today so I'm like personally like still extremely optimistic about defy and where it's going I mean like for me it's like it's funny because people like look at like the last like you know if you look at the like last one year like maybe it's not like you know only in like a vacuum maybe like you know it's easy to like be negative but I think that like you know if you look at where we've come from you know even like a few years ago uh there's just been so much growth in you know there's been so much like uh you know exploration of the technology um you know there's more Usage Now even like post FTX you know decentralized exchange market share has gone up relative to centralized exchange like significantly um you know it was sort of recently at like all-time high of you know decentralized exchange versus centralized exchange volumes and so we're starting to see like even within crypto like more of a shift towards uh towards decentralization um I expect that to continue uh in terms of like tradpy and planning that like that's like a longer kind of a longer game uh and it's really about like uh I I guess to me like I think that there are like fundamental advantages of this technology and when we can you know package them up and expose them to people in like a tangible way I think that like they'll like you know sort of kind of by definition went out um but it does take like it's not gonna happen overnight and it's not gonna happen like you know in a few weeks right it's like it's gonna take some time but I do expect like kind of a steady like there are more people using it now than two years ago and there were way more and like you know orders many orders magnitude more than like even like two or three years ago right so like you know for personally to me like the long-term trajectory is is up and you know we're just like in the early days and and that's what it's sort of all about and so personal confidence has wavered I do think that like um maybe to touch on like a thing like something underneath that that was like I do think that like when you see like um scam like like when you see like things like FTX like are discouraging to new people in the space they are like a little bit like it's I think that like people in the space often like sort of see like you sort of like or maybe even like a better example or like it was kind of like very obviously shitty to a lot of people maybe and and um who are like kind of Die Hard early like you know fans of D5 um and so I think that like it can be like tiring to like have yourself represented by like like like people often like just like look at crypto as like a monolithic industry and I think it could be very hard sometimes on people in the space to sort of have like the loudest kind of worst voices in the room um sort of be the ones that people kind of like see us all as as represented like see I had like representative of our broader industry whereas I think that like the industry is is pretty multifaceted and there's like people working on all sorts of things across the entire space and like there's like so many incredibly smart talented people um and sometimes they're like getting less attention than people who spend you know hundreds of millions of dollars on you know Stadium sponsorships um but like they're they're real and they're happening and um so I think that like you know I I always try to encourage like Nuance in these discussions like it's not like I I I totally like sympathize with people who like look at crypto I'm like wow it seems like a scammy industry because like you see like these like very high profile you know scams that have happened um but you know to me like the fundamental on like it's all about like that like fundamental underlying progress towards like better technology and a better you know Financial system and to me like that is still like progressing and improving and kind of like on the right trajectory the trajectory of course is defy eating Trad fire defy eating the world and that's certainly what uh you are building and the swap team is is kind of building with this next release and we'll know we're close we're NASDAQ and s p and all the logic exchanges of the world start building hooks on top of a uniswap V4 Hayden it's been a pleasure to have you on Bank list thank you so much for joining us thank you so much for having me it's been a pleasure Hayden as we get to uh action steps here uh I know you've got a blog post uh white paper code base we'll include links to that in uh the show notes there are any other big action items that that folks can take to kind of uh get involved and um you know start doing things maybe even starting to to build hooks is it too early for that um it's not like I mean it's too early if you want a guarantee that that there will be no changes right so like uh you know again the code base is not Frozen has not been audited it's not been finalized and so if you want if you are like I just can't wait to get my hands and I just want to experiment with it conceptually then like go for it if you um want like a kind of more like finished platform to build on then like maybe wait a little bit uh maybe wait a few months um one thing I'll I'll add is that like if you think that you have what it takes to you know get some code into the you know core unit spot V4 code base we have contributor guidelines in the GitHub um I don't think that like it's you know it's obviously still like a pretty complex code base and and um isn't necessarily for like super beginners to to you know to do but like there are obviously like the space has so many incredibly smart talented you know uh smart contract engineers and so if you if you have a gas optimization if you have you know a feature request or a Improvement uh create an issue uh work on an issue um you know by all means read the read the contribution guide open invitation there and of course we'll also include a uh our previous episode with Hayden in the show notes as well David you have an action item too yeah the uh actually launch date of uniswap V4 I believe correct me if I'm wrong hidden depends on uh an EIP being included so perhaps there are some action items for the ethereum devs to get included is that correct or is there or is there a different uh uh launch date for V4 I think that like the the benefits of this sort of Singleton and Flash accounting that we think is is really uh part of our vision for where this goes uh does you know get like those benefits increase significantly uh once you know once this next ethereum hard Fork happens um if it yeah so I mean it's possible to launch a version without it or before it or only on Layer Two is it something like that but my personal guess is that like this will happen post Cancun hard Fork uh no that would be my sort of personal thought on like the best timing um I don't know if there's any action items there it's sort of already there like it's kind of already slated for instance they're going as fast as they can okay David it's gonna happen what's worth you know we did we did I just want another reason to wait for the Cancun yeah there you go we did we did uh we did do some contribution to the to 11 53. um and you know definitely like uh you know support for it and like solidity stuff like that also will will be helpful but there you go we got some things uh for Action items for everyone and I guess the main thing is during the bear Market the builders keep building and unit swap is certainly building so is ethereum so is D5 hidden it's been a pleasure to have you on Bank list thanks so much thank you for having me risks and disclaimers bankless Nation you gotta let you know none of this has been Financial advice not trading advice not swapping advice not hooking advice uh crypto is risky perhaps buildings would you put in yes but we are headed west this is the frontier it's not for everyone but we're glad you're with us on the bankless journey thanks a lot all right [Music] 