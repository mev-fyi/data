thanks for having me this is very uh cozy this is nice I definitely don't have to shout you know it's good there we go thank you so my name is Max Resnick I am the head of research at special mechanisms Group which is a Mev research company this is some work that I did a while ago actually about six months ago and at the time it wasn't a reality yet what we're talking about but then uniswap X came out and so immediately it became a lot more relevant so thanks very much to them uh for this so let me just talk a little bit about the parts of unit swap acts that are relevant uh a user kind of submits a trade that they want to do they say I want to trade you know I want to buy some eth okay and then the initial mark on The Price is set by an auction and whoever wins that auction whoever gives them the best price gets an exclusive right to fill that intent since we're here at the intent Hacker House they get an exclusive right to fill it for two blocks n equals two right now who knows what what that parameter will be um there's some other stuff that I claim doesn't really matter that much which is the majority of the rest of the white paper but for our purposes we're really focused on this first step which is set the mark and then the person who wins the auction gets an exclusive right to fill it for two blocks okay so I want to preface this by saying that this is like a sub tweet from the future of Alex's tweet today which is that execution is not one-dimensional um I think in Trad five because everything happens so fast we usually think of execution as about price but if you get executed at a price today versus a price in five days it's not the same so execution is about price it's also about the time you execute and it's really about the price at the time you execute not when you submit the order so what are we talking about uh let me just set the stage like it's kind of a more General version of what I just talked about with uniswellbacks but somebody comes in with an order we auction off the right to the order and then there's two ways we can make the person who wins it pay for the order either they pay if and only if they execute which is actually pretty nice and easy on chain because you can just put the payment when they execute on chain or this is a little bit harder to do but has some Better Properties you can do an upfront payment which is you pay for the order if and only if you win it so I'm maybe old-fashioned but I think if you like buy something that you should pay for it not when you use it uh if you buy a vacuum cleaner you don't pay for it when you plug it in the first time you pay for it at the store where do you buy it so this is kind of the big breakdown and the big tension that I'm going to talk about today is what happens when your auction is contingent fee base and what happens when it's upfront payment based uh obviously like I said continue fees are actually much easier in practice so Engineers always advocate for them but you can't let your engineers dominate the researchers have to come in sometimes and so there's some convenience uh and I think that's probably why uniswap X ended up with this continued fee design because you can make the payment happen on chain but as we'll see that has some issues with regards to execution both on the time Dimension and on the execution quality dimension so here's a simple model it's going to be we're going to ignore the N equals two part we're going to say n equals one so there's a single transaction T it's offered at auction it's a limit sell order that means it's selling say one unit of each at a certain strike price the strike price is K which may be a bit confusing we call the reference price s usually in options um so because the the orders are some a sell order the right to execute it is actually an option to buy because it's taking the other side and so if you execute it you get uh the price the external price which is s minus K which is the price of the limit order and I have a graph of what that looks like so this is just a standard options 101 graph I'm going to do a little option Z tour because we kind of need it for the rest of the talk but this is kind of the value of the option down here in this region below the strike price it's not worth it to execute so the option's worth zero because it is an option it's not an obligation up here when the price is 60 if a strike is 50 you get 60 minus 50 so that's just the line uh you know K minus or S minus k so the thing about options is that they're a bet on volatility so here I have three different probability distributions of where the price is going to go and of course three different prices for the exactly the same option which anybody who knows option three will know but uh sometimes it's a bit niche but you can see this one is kind of more spread out so there's more volatility uh the expected value of this option is higher that one is much tighter the expected value is lower and then this is a really big point that I want everybody to take away from if you take away from anything from this talk it's uh well this and don't use contingent fees but continued fees change the strike of the option not how much you pay for the option so in some this Dimension that's how much you're paying for the option this Dimension is a strike so you can see if I have a so I have two types of options here in the red that's an option at strike 50 with a price of ten dollars in the blue that's an option with strike 50 but a conditional execution fee of ten dollars and it looks like an option at strike 60 with a price of zero so don't give away free options don't use contingent fees and oh one more thing on that slide before we just want you to notice that because the strike is now 60 you don't execute unless the price is over 60. so when we care about execution we care about execution probability as well so if you start changing the strike a lot you're going to lose out on this whole region where the price could be in this range and doesn't execute it okay so I'm gonna do two models one is going to be the upfront payment auction one of them is going to be the continued fee auction they're going to work exactly like you expect you're going to have bid or submit bids the highest bidder is going to win and in The Upfront payment auction they're going to pay when they win because they pay up front and in the last stage because this is an option the winning bidder is going to observe the external price S1 and decide whether to execute the transaction or not and so whoever wins and pays a bit B their valuation is going to look like this in The Upfront payment game and now in the contingency game we're very similar the only difference is I've changed where they're paying they're paying if they execute and so now down here this thing which used to be a minus B is a zero so if you just flip back and forth once you can see that there's very little changing other than when the when it's paid and it's changing this little term down here okay so let's start by saying uh what the equilibrium is in the simple case of The Upfront payment gain how much are you willing to pay for an option well you're willing to pay the expected value of the option uh Alex is going to Heckle me after for this but in the paper I use this perfectly competitive auction assumption and uh so the neslobin critique is that auctions aren't perfectly competitive the pie repost Pi molest pie is my co-author is that it only takes two people to run an auction but uh in this case we're gonna we're gonna idealize the world in which is a perfectly competitive auction and that means there's zero profit to be taken here and so the pro the price that the auction is going to clear at is the value of the option which is this um now that that's pretty simple that's kind of how we want it to clear right this is the equilibrium in the contingency game well let's start with the payoff for winning before you had a payoff of S1 minus K of U1 now we have this extra B term so this is exactly what I showed earlier in the options photo we're Shifting the strike and that's this time you're Shifting the strike um so now the more you bid the less you want to execute which side am I which side this one yeah yeah so now we're gonna apply the zero profit condition again critiques aside and the first line here is the profit is zero zero profit condition so the zero profit condition holds then you must never want to execute the option with the adjusted strike price so you don't ever want to execute which is bad for execution and that must mean that the the price that you bid is so high that this holds right it's so high that the highest possible price that it could end up at is not high enough to make you want to execute so this is a bit of a degenerate game in some sense there's so much unraveling that you really never want to execute in this example and obviously I chose the model that way but summarizing what we've learned in The Upfront payment game where you don't have continued fees the option the kind of auction clears for the value of the option and we don't have any issues everything works as expected in the contingency game we have a ton of unraveling and so we have the bid coming up way high the order is not executing and there's no Revenue because you only get Revenue when it executes right it's contingent on execution so that model is a bit degenerate because there was too much unraveling so let's uh introduce a mixture parameter so we're going to mix the two the reason I do this is because a lot of people like to do reputation systems including uniswap and so there is still a penalty for not executing but the penalty is maybe not exactly the right amount and so that's what the mixture looks like so you still have some penalty as a function of your bid but it's not exactly the whole bid and so we're going to see what this looks like uh so this is like some math salad up here but uh if you if you're working with less Pi then this ends up making sense somehow but this uh is I mean I couldn't simplify it anymore because there's no analytic solution in general but I just use a computer program to solve this so I use a bracketing zero finder to solve this and I get B Star which we're going to use later on so what's the probability of execution just the probability that uh uh the price is high enough that you want to execute and uh these are kind of all the things we care about these these next three slides are like the things that we care about probability of execution auction revenue and Alex's favorite uh execution quality so this is going to be our equation for auction revenue and don't worry I have pictures later so we don't have to kind of do this math out and the effective spread which is the execution quality at the time that it executes uh so I have pictures so we don't have to go through all this but uh this is my summary of of what the pictures are about to show you which is the closer you are to an upfront payment auction meaning the closer alpha is to one um the more often you execute the more auction Revenue you get and the better your effective spread is for users so here's a example of just this plotted with kind of the volatility being this uniform zero one so the price ends up being between zero and one the strike is 0.5 you can see bids are coming down which is what we'd expect because remember bids are being too high over here was was why there was unraveling probability of execution is coming up as we said in the theorem effective spread is coming down which is good and auction revenue is going up good of a few more so maybe you're not convinced by the uniform distribution here's uh a bunch of other PDFs not uniform all with the same pattern and of course there's a proof in the paper if you are still not convinced by this okay so let me just talk a little bit about reputation systems because I think a lot of the answer to this critique is hey we'll just have a reputation system and that'll make it so they don't want to play this kind of game and it doesn't unravel so like I said mixture model is kind of a good model of this but you still saw you had some unraveling if we get it wrong and in fact if you if you make your reputation system penalized too much then you kind of have the other problem which is that it can make you want to bid too little and that can also hurt Revenue so you really want to get your reputation almost exactly right so that the incentives look like an upfront payment game in which case just do the upper and payment game don't like fool around with this reputation system don't have permission stuff don't have to do a bunch of calibration just do that for a payment game okay um another extension that you might want to add is hey maybe like there's no PBS auction in the block or maybe uh somebody gets your order and they execute it regardless of whether you want it right well I claim that with uh the probability of involuntary execution and probability of involuntary failure together lesson one so you still have some Choice basically is what that means then uh you still have a very similar model with it just a different mixture parameter Alpha just set it according to the parameters and it kind of works out and you have all the same results obviously it's going to be different Alpha so it's going to be a different degree of unraveling but you have a lot of the same results uh I just want to thank flashbots funded this uh with a research Grant and then I talked a lot with quintus and milash about the results and I also want to thank you and swap for making my research relevant by releasing an LFA that did not follow my guidelines thank you so much um I'm trying to do little uh options here research but I think that it's uh one thing that we sort of work has to be careful of particular application with units walk right is it's pretty difficult for them to implement an upfront payment how exactly would it look because the other party has the last look as well so if you submitted something to uniswell somebody wins the bid now they have to pay according to this mechanism but the person who initially submitted the swap always has the option to front run the filler and just revoke perfectly to privileges or something right so in this game you had a situation where there is a probability of failure but here the probability of failure is actually linked to the price if I observe that the price moved against me I I can cancel and revoke and so there is a fixed cost for me of doing so or maybe it's not fixed because it will go to the Builder eventually right yes the Builder will see that I want to cancel and then the filler is now racing against me if it's still because they already paid for um the right to fill and so I think that then we basically end up in the game um of MVD between the filler and the client I don't expect that to be to happen very often to be honest but it might and so I think uh it's uh it would be interesting to have a now that unit swap made your research relevant you push it a little bit further in the direction of sort of looking at what they're doing actually right now what they can do and see if you can push the research a little bit further and make predictions sort of that are useful for the specific yeah uh this is like an interesting point I think it also is an interesting point to bring up that half of blocks are built by bitters and Lena swap auction so yeah yeah so they have a little bit of extra power in terms of that censorship game kind of like race um it's I also think a lot of the point of this is how do we provide good execution to retail users and so the I'm not trading against Alex Smith and necessarily I'm trading against uh you know random uniswap user who probably isn't doesn't care enough to cancel their order or doesn't have the monitoring available to check the binance price moved against them and now I'm going to cancel so in some ways there's an asymmetric sophistication there's asymmetric structural Advantage for the people living in the auction building 50 of the blocks which was also you know something that can sometimes be used to your advantage when censorship concerns go against you okay oh yeah um yeah I came in sort of late so I thought but um you mentioned how like reputations [Applause] typically I think they're used to like avoid gas well the the way it would work is you have a reputation that uh gets penalized if you don't execute and so it kind of looks more like the mixture game uh so I think reputations can be helpful in solving this problem and solving some of the unraveling and I think on uniswell there's like there's not a live uh like reputation system right now but there's kind of an implicit thing like don't do bad stuff to our users or you're going to get kicked off the white list um as far as like yeah that's kind of how I'm thinking of reputation system and I think as well how the uni swap team is thinking of reputation system is like in terms of actually solving this problem like putting in reputation penalties for not executing user orders because the price moved against you so like I guess I I give the zero profit condition because that's what it would be in a competitive auction it's not a competitive auction um in a lot of cases like we actually have some some work coming out about this about what the competition looks like in sex sex Arbitrage um there's there's quite a few players uh who are pretty sophisticated not all of them have Builders which is a big part of this um I think our goal isn't to make the profit go to zero I think our goal is is to avoid unraveling that actually takes away from the sum total of value created by the system and like like I showed in my kind of stylized model if you have unraveling you can have a system that just doesn't work at all in that you're just executing orders like way too uh rarely and you're executing them at prices that users don't want so nobody you're kind of getting rid of the individual rationality in the whole system that nobody even wants to participate anymore so yeah I mean I separately I think that validators are making quite a bit of money in but that's not necessarily related to this discussion yeah any more questions yeah and then we will break into a very small break for about 15 minutes and if it wants to discuss with Max just come to him and the next speaker is Dan from Fresh Balls thank you 